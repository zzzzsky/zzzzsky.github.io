{"meta":{"title":"zsky's Blog","subtitle":"","description":"æŸ211ç ”ä¸€åœ¨è¯»|CTF_REé€‰æ‰‹|tcl","author":"zsky","url":"https://zzzzsky.github.io","root":"/"},"pages":[{"title":"è®°å½•æœ¬fwçš„å­¦ä¹ ","date":"2021-11-18T14:37:07.000Z","updated":"2021-11-29T12:15:58.760Z","comments":true,"path":"about/index.html","permalink":"https://zzzzsky.github.io/about/index.html","excerpt":"","text":""},{"title":"categories","date":"2021-11-18T14:36:52.000Z","updated":"2021-11-29T12:15:03.610Z","comments":true,"path":"categories/index.html","permalink":"https://zzzzsky.github.io/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2021-11-18T14:36:30.000Z","updated":"2021-11-29T12:15:43.104Z","comments":true,"path":"tags/index.html","permalink":"https://zzzzsky.github.io/tags/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2021-11-18T14:37:07.000Z","updated":"2021-11-29T12:15:24.996Z","comments":true,"path":"link/index.html","permalink":"https://zzzzsky.github.io/link/index.html","excerpt":"","text":""}],"posts":[{"title":"VNCTF2022_RE_å¤ç›˜","slug":"VNCTF2022_RE_WP","date":"2022-02-23T09:03:00.000Z","updated":"2022-02-23T09:05:54.827Z","comments":true,"path":"2022/02/23/VNCTF2022_RE_WP/","link":"","permalink":"https://zzzzsky.github.io/2022/02/23/VNCTF2022_RE_WP/","excerpt":"","text":"VNCTF2022_RE_å¤ç›˜1.BabyMazeé¢˜ç›®ç»™å‡ºä¸€ä¸ª BabyMaze.pyc æ–‡ä»¶ï¼Œå°è¯•ç”¨uncompyle6åç¼–è¯‘ï¼Œä½†æ˜¯å¤±è´¥ ï¼Œäºæ˜¯ç”¨è„šæœ¬åæ±‡ç¼– 1234567891011121314151617181920212223242526# å®‰è£…ç¯å¢ƒimport disimport marshalimport sysheader_sizes = [ # (size, first version this applies to) # pyc files were introduced in 0.9.2 way, way back in June 1991. (8, (0, 9, 2)), # 2 bytes magic number, \\r\\n, 4 bytes UNIX timestamp (12, (3, 6)), # added 4 bytes file size # bytes 4-8 are flags, meaning of 9-16 depends on what flags are set # bit 0 not set: 9-12 timestamp, 13-16 file size # bit 0 set: 9-16 file hash (SipHash-2-4, k0 = 4 bytes of the file, k1 = 0) (16, (3, 7)), # inserted 4 bytes bit flag field at 4-8 # future version may add more bytes still, at which point we can extend # this table. It is correct for Python versions up to 3.9]header_size = next(s for s, v in reversed( header_sizes) if sys.version_info &gt;= v)with open(&#x27;BabyMaze.pyc&#x27;, &quot;rb&quot;) as f: metadata = f.read(header_size) # first header_size bytes are metadata code = marshal.load(f) # rest is a marshalled code objecta = dis.dis(code)print(len(code.co_code)) 1234567891011121314151617181920212223242526272829303132331 0 JUMP_ABSOLUTE 4 &gt;&gt; 2 JUMP_ABSOLUTE 6 &gt;&gt; 4 JUMP_ABSOLUTE 2 &gt;&gt; 6 LOAD_CONST 0 (1) 8 LOAD_CONST 0 (1) 10 LOAD_CONST 0 (1) 12 LOAD_CONST 0 (1) 14 LOAD_CONST 0 (1) 16 LOAD_CONST 0 (1) 18 LOAD_CONST 0 (1) 20 LOAD_CONST 0 (1) 22 LOAD_CONST 0 (1) 24 LOAD_CONST 0 (1) 26 LOAD_CONST 0 (1) 28 LOAD_CONST 0 (1) 30 LOAD_CONST 0 (1) 32 LOAD_CONST 0 (1) 34 LOAD_CONST 0 (1) 36 LOAD_CONST 0 (1) 38 LOAD_CONST 0 (1) 40 LOAD_CONST 0 (1) 42 LOAD_CONST 0 (1) 44 LOAD_CONST 0 (1) 46 LOAD_CONST 0 (1) 48 LOAD_CONST 0 (1) 50 LOAD_CONST 0 (1) .......... 42 LOAD_CONST 5 (&quot;Sorry, we won&#x27;t acknowledge the existence of your squad.&quot;) 44 CALL_FUNCTION 1 46 POP_TOP &gt;&gt; 48 LOAD_CONST 0 (None) 50 RETURN_VALUE 2030(0X7EE) å¯ä»¥å‘ç°å¼€å¤´æ˜¯3ä¸ªæŒ‡ä»¤çš„è·³è½¬ï¼Œæ˜¯è¿™ä¸ªåœ°æ–¹å¹²æ‰°äº†uncompyle6ï¼Œäºæ˜¯æ‰“å¼€opcode.hï¼Œæ‰¾å¯¹åº”çš„æœºå™¨ç  æ˜¯113ï¼ˆ0X71) å°†å…¶åˆ é™¤ï¼Œå¹¶ä¸”å°† 7EE æ”¹ä¸º 7E8,ç„¶åé‡æ–°åç¼–è¯‘ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647# uncompyle6 version 3.7.4# Python bytecode 3.8 (3413)# Decompiled from: Python 3.8.5 (tags/v3.8.5:580fbb0, Jul 20 2020, 15:57:54) [MSC v.1924 64 bit (AMD64)]# Embedded file name: .\\BabyMaze.py# Compiled at: 2022-02-08 15:12:27# Size of source mod 2**32: 3707 bytes_map = [ [ 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1], [1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1], [1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1], [1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1], [1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], [1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1], [1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1], [1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1], [1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1], [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1], [1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1], [1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], [1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1], [1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1], [1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1], [1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1], [1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1], [1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1], [1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1], [1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1], [1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1], [1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1], [1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1], [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1], [1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 7, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]]def maze(): x = 1 y = 1 step = input() for i in range(len(step)): if step[i] == &#x27;w&#x27;: x -= 1 else: if step[i] == &#x27;s&#x27;: x += 1 else: if step[i] == &#x27;a&#x27;: y -= 1 else: if step[i] == &#x27;d&#x27;: y += 1 else: return False if _map[x][y] == 1: return False if x == 29 and y == 29: return Truedef main(): print(&#x27;Welcome To VNCTF2022!!!&#x27;) print(&#x27;Hello Mr. X, this time your mission is to get out of this maze this time.(FIND THAT 7!)&#x27;) print(&#x27;you are still doing the mission alone, this tape will self-destruct in five seconds.&#x27;) if maze(): print(&#x27;Congratulation! flag: VNCTF&#123;md5(your input)&#125;&#x27;) else: print(&quot;Sorry, we won&#x27;t acknowledge the existence of your squad.&quot;)if __name__ == &#x27;__main__&#x27;: main()# okay decompiling BabyMaze.pyc å‘ç°æ˜¯31 * 31çš„è¿·å®« ç¨ä½œæ•´ç†ï¼ŒDFSè§£å¯†å³å¯, è§£å¯†è„šæœ¬å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141# é¢˜ç›®ï¼šç»™å®šå¤§å°ä¸ºn*mçš„çŸ©é˜µï¼Œæ±‚Såˆ°Gçš„æœ€çŸ­è·¯å¾„å¹¶è¾“å‡º# è¾“å…¥ï¼š# 10 10# #S######.## ......#..## .#.##.##.## .#........# ##.##.##### ....#....## .#######.## ....#.....# .####.###.# ....#...G## è¾“å‡ºï¼š# è¿·å®«è·¯å¾„import queueimport hashlibMAX_VALUE = float(&#x27;inf&#x27;)class Point: def __init__(self, x=0, y=0): self.x = x self.y = ydef bfs(maze, begin, end): path = [] # ä¿å­˜ç»è¿‡çš„æ¯ä¸€ä¸ªç‚¹ n, m = len(maze), len(maze[0]) dist = [[MAX_VALUE for _ in range(m)] for _ in range(n)] pre = [[None for _ in range(m)] for _ in range(n)] # å½“å‰ç‚¹çš„ä¸Šä¸€ä¸ªç‚¹,ç”¨äºè¾“å‡ºè·¯å¾„è½¨è¿¹ nx = [[1, 0], [-1, 0], [0, -1], [0, 1]] sx, sy = begin.x, begin.y gx, gy = end.x, end.y dist[sx][sy] = 0 q = queue.Queue() q.put(begin) while q: point = q.get() if point.x == gx and point.y == gy: break for i in range(4): dx, dy = point.x + nx[i][0], point.y + nx[i][1] if 0 &lt;= dx &lt; n and 0 &lt;= dy &lt; m and maze[dx][dy] != &#x27;#&#x27; and dist[dx][dy] == MAX_VALUE: dist[dx][dy] = dist[point.x][point.y] + 1 pre[dx][dy] = point q.put(Point(dx, dy)) stack = [] curr = end while True: stack.append(curr) if curr.x == begin.x and curr.y == begin.y: break prev = pre[curr.x][curr.y] curr = prev while stack: curr = stack.pop() # print(&#x27;(%d, %d)&#x27; % (curr.x, curr.y)) path.append((curr.x, curr.y)) return pathdef get_path(path): # å°†è·¯å¾„çš„ç‚¹æ‰“å°ä¸ºè·¯å¾„ sss = &quot;&quot; for i in range(1, len(path)): x = path[i-1] # å‰é¢çš„ y = path[i] # åé¢çš„ if x[0] == y[0]: # æ¨ªåæ ‡ç›¸åŒï¼Œå·¦å³ç§»åŠ¨ï¼Œå³aæˆ–d if x[1] &gt; y[1]: sss += &quot;a&quot; else: sss += &quot;d&quot; else: # çºµåæ ‡ç›¸åŒ if x[0] &gt; y[0]: sss += &quot;w&quot; else: sss += &quot;s&quot; # print(sss) return sssif __name__ == &#x27;__main__&#x27;: n, m = map(int, input().split()) maze = [[&#x27;&#x27; for _ in range(m)] for _ in range(n)] begin = Point() end = Point() for i in range(n): s = input() maze[i] = list(s) if &#x27;S&#x27; in s: begin.x = i begin.y = s.index(&#x27;S&#x27;) if &#x27;G&#x27; in s: end.x = i end.y = s.index(&#x27;G&#x27;) _path = bfs(maze, begin, end) path = get_path(_path) print(path) print(hashlib.md5(path.encode()).hexdigest())# 31 31# ################################ #S#.................#.........## #.#.#########.#####.#.#######.## #.#...#.......#...#...#.#...#.## #.#####.#########.#####.#.#.#.## #...#...#.............#...#...## ###.#.###.#############.######## #...#.#...#.........#...#...#.## #.###.#.###.#######.#.###.#.#.## #.....#.#...#...#.#.#...#.#...## #######.#.###.#.#.#.###.#.###.## #.......#.....#...#.#...#.#...## #.###############.#.#.###.#.#### #.......#.......#.#...#...#...## #.#####.#.#.#.###.#####.######## #.#...#.#.#.#.#...#...........## #.#.#.#.#.#.###.###.#####.###.## #.#.#.#.#.#...#...#.#...#.#...## #.#.###.#.###.###.#.#.#.###.#### #...#...#.#.....#.#.#.#...#...## #.###.#.#.#.#####.#.#.###.#.#.## #.#...#.#.#.......#.#.#.#.#.#.## #.#.###.#.###########.#.#.#.#.## #.#...#.#.#.........#.#.#.#.#.## #.###.#.#.#####.#.#.#.#.#.#.#.## #...#.#.#.....#.#.#...#...#.#.## #####.#######.###.#######.###.## #.....#.....#...#.......#.....## #.#####.###.###.#######.#####.## #.........#.............#....G## ################################ ssssddssaassddddwwwwddwwddddddwwddddddssddwwddddddddssssaawwaassaassaassddssaassaawwwwwwaaaaaaaassaassddddwwddssddssssaassddssssaaaaaawwddwwaawwwwaassssssssssssddddssddssddddddddwwaaaaaawwwwddssddwwwwwwwwddssddssssssssddddss# 801f190737434100e7d2790bd5b0732e å…³äºpythonå­—èŠ‚ç çš„åæ±‡ç¼–ï¼Œå¯ä»¥çœ‹è¿™ä¸ªæ–‡ç« å­¦ä¹  https://song-10.gitee.io/2020/04/20/Reverse-2020-04-20-python-byte/ 2.cm1æ˜¯ä¸ªAPKæ–‡ä»¶ï¼Œæ‹–å…¥JEBè¿›è¡Œåˆ†æ å‘ç°å…³é”®checkå‡½æ•°æ”¾åœ¨äº†è§£å¯†åçš„oooæ–‡ä»¶ä¸­ï¼Œè¿›å…¥copyFileså‡½æ•°è§‚å¯Ÿå¦‚ä½•è§£å¯†çš„ æ˜¯ä»¥1024ä¸º1ç»„ï¼Œå¼‚æˆ–vn2022ï¼Œå†™è„šæœ¬è§£å¯† 1234567with open(&quot;ooo&quot;, &quot;rb&quot;) as f: content = list(f.read())key = b&quot;vn2022&quot;for i in range(len(content)): content[i] ^= key[(i % 1024) % 6]with open(&quot;oooo&quot;, &quot;wb&quot;) as f: f.write(bytes(content)) ç„¶åç”¨jadxæ‰“å¼€opooï¼Œæ‰¾åˆ°hcheck æ˜¯xxteaåŠ å¯†ï¼Œå†™è„šæœ¬è§£å¯†å³å¯ 123In [18]: a = b&quot;H4pPY_VNCTF!!OvO&quot;In [19]: struct.unpack(&quot;&lt;IIII&quot;, a)Out[19]: (1349530696, 1314283353, 558257219, 1333153569) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#include &lt;stdio.h&gt;void encrypt(unsigned int * v, int n, unsigned int * key) &#123; unsigned int rounds = (52 / n) + 6; unsigned int sum = 0, y = 0; unsigned int z = v[n - 1]; unsigned int p; while (rounds &gt; 0) &#123; sum -= 1640531527; unsigned int e = (sum &gt;&gt; 2) &amp; 3; for (p = 0; p &lt; n - 1; p++) &#123; y = v[p + 1]; v[p] += ((((z &gt;&gt; 5) ^ (y &lt;&lt; 2)) + ((y &gt;&gt; 3) ^ (z &lt;&lt; 4))) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z))); z = v[p]; &#125; y = v[0]; v[n - 1] += ((((z &gt;&gt; 5) ^ (y &lt;&lt; 2)) + ((y &gt;&gt; 3) ^ (z &lt;&lt; 4))) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z))); z = v[n - 1]; rounds--; &#125;&#125;void decrypt(unsigned int* v, int n, unsigned int* key)&#123; unsigned int rounds = (52 / n) + 6; unsigned int sum =0 - (1640531527 * rounds), z = 0; unsigned int p; unsigned int y = v[0]; while (rounds &gt; 0) &#123; unsigned int e = (sum &gt;&gt; 2) &amp; 3; for (p = n - 1; p &gt; 0; p--) &#123; z = v[p - 1]; v[p] -= ((((z &gt;&gt; 5) ^ (y &lt;&lt; 2)) + ((y &gt;&gt; 3) ^ (z &lt;&lt; 4))) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z))); y = v[p]; &#125; z = v[n - 1]; v[0] -= ((((z &gt;&gt; 5) ^ (y &lt;&lt; 2)) + ((y &gt;&gt; 3) ^ (z &lt;&lt; 4))) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z))); y = v[0]; sum += 1640531527; rounds--; &#125;&#125;int main() &#123; char c[] = &#123; 68, 39, -92, 108, -82, -18, 72, -55, 74, -56, 38, 11, 60, 84, 97, -40, 87, 71, 99, -82, 120, 104, 47, -71, -58, -57, 0, 33, 42, 38, -44, -39, -60, 113, -2, 92, -75, 118, -77, 50, -121, 43, 32, -106 &#125;; unsigned int key[] = &#123; 1349530696, 1314283353, 558257219, 1333153569 &#125;; decrypt((unsigned int *)c, 11, key); return 0;&#125;//VNCTF&#123;93ee7688-f216-42cb-a5c2-191ff4e412ba&#125; 3.cmç‹—æ‹¿åˆ°é¢˜ç›®ï¼Œå‘ç°æ˜¯ç”¨goè¯­è¨€å®ç°çš„VMï¼Œç›´æ¥ç”¨IDA7.6æ‰“å¼€ æ ¹æ®main.(_ptr_MzVm).init å’Œ main.(_ptr_MzVm).run 2ä¸ªå‡½æ•°ï¼Œæ‰¾åˆ°VMçš„å¤§ä½“ç»“æ„ 123456789101112131415161718192021struct func&#123; void *call; vm *vmm;&#125;struct vm&#123; DWORD REG[21]; DWORD stack[1000]; DWORD _eip; DWORD _esp; DWORD _ebp; QWORD * data; //æŒ‡å‘OPCODE func * function[100]; char is_exit;&#125;;struct params&#123; DWORD parm1; DWORD parm2;&#125; æ·»åŠ ç»“æ„ä½“åˆ°IDAä¸­ï¼Œå‘ç°ç¬é—´å‡½æ•°å˜çš„éå¸¸çš„æ¸…æ™° æ…¢æ…¢åˆ†ææ¯ä¸ªfuncçš„åŠŸèƒ½ï¼Œç„¶åæŠŠOPCODEæå–å‡ºæ¥ï¼Œå†™è„šæœ¬æ‰“å°ä¼ªä»£ç  123456789101112131415161718192021222324252627282930313233a = [0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000057, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000065, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000006C, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000063, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000006F, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000006D, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000065, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000020, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000074, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000006F, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000020, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000056, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000004E, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000043, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000054, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000046, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000032, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000030, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000032, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000032, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000021, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000000A, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000069, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000006E, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000070, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000075, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000074, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000020, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000066, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000006C, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000061, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000067, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000003A, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000000A, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000013, 0x00000049, 0x00000001, 0x00000003, 0x00000000, 0x00000001, 0x00000001, 0x0000002B, 0x00000001, 0x00000002, 0x00000001, 0x00000061, 0x00000000, 0x00000000, 0x00000005, 0x00000000, 0x00000000, 0x00000008, 0x00000001, 0x00000002, 0x0000000E, 0x00000001, 0x00000003, 0x00000001, 0x00000000, 0x00000000, 0x00000005, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000006, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000006, 0x00000000, 0x00000002, 0x00000000, 0x00000006, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000006, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000006, 0x00000000, 0x00000002, 0x00000000, 0x00000006, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000006, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000006, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000007, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000007, 0x00000000, 0x00000002, 0x00000000, 0x00000007, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000007, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000007, 0x00000000, 0x00000002, 0x00000000, 0x00000007, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000007, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000007, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000008, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000008, 0x00000000, 0x00000002, 0x00000000, 0x00000008, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000008, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000008, 0x00000000, 0x00000002, 0x00000000, 0x00000008, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000008, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000008, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000009, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000009, 0x00000000, 0x00000002, 0x00000000, 0x00000009, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000009, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000009, 0x00000000, 0x00000002, 0x00000000, 0x00000009, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000009, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000009, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000A, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000A, 0x00000000, 0x00000002, 0x00000000, 0x0000000A, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000A, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000A, 0x00000000, 0x00000002, 0x00000000, 0x0000000A, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000A, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000A, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000B, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000B, 0x00000000, 0x00000002, 0x00000000, 0x0000000B, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000B, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000B, 0x00000000, 0x00000002, 0x00000000, 0x0000000B, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000B, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000B, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000C, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000C, 0x00000000, 0x00000002, 0x00000000, 0x0000000C, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000C, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000C, 0x00000000, 0x00000002, 0x00000000, 0x0000000C, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000C, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000C, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000D, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000D, 0x00000000, 0x00000002, 0x00000000, 0x0000000D, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000D, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000D, 0x00000000, 0x00000002, 0x00000000, 0x0000000D, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000D, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000D, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000E, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000E, 0x00000000, 0x00000002, 0x00000000, 0x0000000E, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000E, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000E, 0x00000000, 0x00000002, 0x00000000, 0x0000000E, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000E, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000E, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000F, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000F, 0x00000000, 0x00000002, 0x00000000, 0x0000000F, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000F, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000F, 0x00000000, 0x00000002, 0x00000000, 0x0000000F, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x0000000F, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x0000000F, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000001, 0x00000005, 0x00000100, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000010, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000010, 0x00000000, 0x00000002, 0x00000000, 0x00000010, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000010, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000010, 0x00000000, 0x00000002, 0x00000000, 0x00000010, 0x0000000A, 0x00000000, 0x00000005, 0x00000002, 0x00000010, 0x00000000, 0x00000006, 0x00000000, 0x00000000, 0x00000007, 0x00000010, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000005, 0x00000006, 0x00000000, 0x00000005, 0x00000007, 0x00000000, 0x00000005, 0x00000008, 0x00000000, 0x00000005, 0x00000009, 0x00000000, 0x00000005, 0x0000000A, 0x00000000, 0x00000005, 0x0000000B, 0x00000000, 0x00000005, 0x0000000C, 0x00000000, 0x00000005, 0x0000000D, 0x00000000, 0x00000005, 0x0000000E, 0x00000000, 0x00000005, 0x0000000F, 0x00000000, 0x00000005, 0x00000010, 0x00000000, 0x00000006, 0x00000001, 0x00000000, 0x00000006, 0x00000002, 0x00000000, 0x00000001, 0x00000014, 0x0000011C, 0x00000001, 0x00000000, 0x00000154, 0x0000000C, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0xE8D1D5DF, 0x00000001, 0x00000013, 0x00000183, 0x00000001, 0x00000014, 0x00000153, 0x0000000E, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0xF5E3C114, 0x0000000E, 0x00000002, 0x00000000, 0x00000006, 0x00000001, 0x00000000, 0x00000006, 0x00000002, 0x00000000, 0x00000001, 0x00000014, 0x00000127, 0x00000001, 0x00000000, 0x00000154, 0x0000000C, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x228EC216, 0x00000001, 0x00000013, 0x00000183, 0x00000001, 0x00000014, 0x00000153, 0x0000000E, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x89D45A61, 0x0000000E, 0x00000002, 0x00000000, 0x00000006, 0x00000001, 0x00000000, 0x00000006, 0x00000002, 0x00000000, 0x00000001, 0x00000014, 0x00000132, 0x00000001, 0x00000000, 0x00000154, 0x0000000C, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x655B8F69, 0x00000001, 0x00000013, 0x00000183, 0x00000001, 0x00000014, 0x00000153, 0x0000000E, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x2484A07A, 0x0000000E, 0x00000002, 0x00000000, 0x00000006, 0x00000001, 0x00000000, 0x00000006, 0x00000002, 0x00000000, 0x00000001, 0x00000014, 0x0000013D, 0x00000001, 0x00000000, 0x00000154, 0x0000000C, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0xD9E5E7F8, 0x00000001, 0x00000013, 0x00000183, 0x00000001, 0x00000014, 0x00000153, 0x0000000E, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x3A441532, 0x0000000E, 0x00000002, 0x00000000, 0x00000006, 0x00000001, 0x00000000, 0x00000006, 0x00000002, 0x00000000, 0x00000001, 0x00000014, 0x00000148, 0x00000001, 0x00000000, 0x00000154, 0x0000000C, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x91AB7E88, 0x00000001, 0x00000013, 0x00000183, 0x00000001, 0x00000014, 0x00000153, 0x0000000E, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x69FC64BC, 0x0000000E, 0x00000002, 0x00000000, 0x00000006, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x007D3765, 0x0000000E, 0x00000001, 0x00000000, 0x00000001, 0x00000000, 0x00000189, 0x0000000C, 0x00000000, 0x00000000, 0x00000063, 0x00000000, 0x00000000, 0x00000001, 0x00000003, 0x9E3779B9, 0x00000001, 0x00000004, 0x00095C4C, 0x00000001, 0x00000005, 0x0000871D, 0x00000001, 0x00000006, 0x0001A7B7, 0x00000001, 0x00000007, 0x0012C7C7, 0x00000001, 0x00000008, 0x00000000, 0x00000001, 0x00000011, 0x00000010, 0x00000001, 0x00000012, 0x00000020, 0x00000001, 0x00000013, 0x00000160, 0x00000001, 0x0000000A, 0x00000000, 0x00000001, 0x0000000B, 0x00000020, 0x00000001, 0x0000000C, 0x00000001, 0x00000007, 0x00000008, 0x00000003, 0x00000002, 0x00000000, 0x00000002, 0x0000000A, 0x00000000, 0x00000011, 0x00000007, 0x00000000, 0x00000004, 0x00000002, 0x0000000E, 0x00000000, 0x00000002, 0x00000000, 0x00000002, 0x00000007, 0x00000000, 0x00000008, 0x00000002, 0x0000000F, 0x00000000, 0x00000002, 0x00000000, 0x00000002, 0x00000009, 0x00000000, 0x00000012, 0x00000007, 0x00000000, 0x00000005, 0x00000002, 0x00000010, 0x00000000, 0x00000002, 0x00000000, 0x0000000E, 0x0000000B, 0x00000000, 0x0000000F, 0x0000000B, 0x00000000, 0x00000010, 0x00000007, 0x00000001, 0x00000000, 0x00000002, 0x00000000, 0x00000001, 0x0000000A, 0x00000000, 0x00000011, 0x00000007, 0x00000000, 0x00000006, 0x00000002, 0x0000000E, 0x00000000, 0x00000002, 0x00000000, 0x00000001, 0x00000007, 0x00000000, 0x00000008, 0x00000002, 0x0000000F, 0x00000000, 0x00000002, 0x00000000, 0x00000001, 0x00000009, 0x00000000, 0x00000012, 0x00000007, 0x00000000, 0x00000007, 0x00000002, 0x00000010, 0x00000000, 0x00000002, 0x00000000, 0x0000000E, 0x0000000B, 0x00000000, 0x0000000F, 0x0000000B, 0x00000000, 0x00000010, 0x00000007, 0x00000002, 0x00000000, 0x00000008, 0x0000000B, 0x0000000C, 0x0000000E, 0x0000000B, 0x0000000A, 0x0000000C, 0x00000014, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000006E, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x0000006F, 0x00000062, 0x00000000, 0x00000000, 0x0000000C, 0x00000014, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000079, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000065, 0x00000062, 0x00000000, 0x00000000, 0x00000001, 0x00000000, 0x00000073, 0x00000062, 0x00000000, 0x00000000, 0x0000000C, 0x00000014, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000]# print(len(a))# for i in range(0, len(a), 3):# print(a[i], a[i+1], a[i+2])asmmm_map = &#123; 0: &quot;nop&quot;, 1: &quot;VM-&gt;REG[&#123;0&#125;] = &#123;1&#125;&quot;, 2: &quot;VM-&gt;REG[&#123;0&#125;] = VM-&gt;REG[&#123;1&#125;]&quot;, # æŒ‡å®šä½ç½®çš„æ•°æ®ä¼ ç»™æŒ‡å®šçš„å¯„å­˜å™¨ 3: &quot;v3 = (VM-&gt;stack_top - &#123;1&#125;) VM-&gt;REG[&#123;0&#125;] = VM-&gt;stack[v3];&quot;, 4: &quot;result = (VM-&gt;stack_top - &#123;0&#125;) VM-&gt;stack[result] = VM-&gt;REG[&#123;1&#125;]&quot;, 5: &quot;push REG[&#123;0&#125;]&quot;, 6: &quot;pop REG[&#123;0&#125;]&quot;, 7: &quot;VM-&gt;REG[&#123;0&#125;] += VM-&gt;REG[&#123;1&#125;]&quot;, 8: &quot;VM-&gt;REG[&#123;0&#125;] -= VM-&gt;REG[&#123;1&#125;]&quot;, 9: &quot;VM-&gt;REG[&#123;0&#125;] /= VM-&gt;REG[&#123;1&#125;]&quot;, 10: &quot;VM-&gt;REG[&#123;0&#125;] *= VM-&gt;REG[&#123;1&#125;];&quot;, 11: &quot;VM-&gt;REG[&#123;0&#125;] ^= VM-&gt;REG[&#123;1&#125;]&quot;, 12: &quot;VM-&gt;_eip = 3 * VM-&gt;REG[&#123;0&#125;]&quot;, 13: &quot;CMP VM-&gt;REG[&#123;1&#125;], VM-&gt;REG[&#123;0&#125; if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]&quot;, 14: &quot;CMP VM-&gt;REG[&#123;1&#125;], VM-&gt;REG[&#123;0&#125;] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]&quot;, 15: &quot;VM-&gt;REG[&#123;1&#125;] &lt; VM-&gt;REG[&#123;0&#125;] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]&quot;, 16: &quot;VM-&gt;REG[&#123;1&#125;] &gt; VM-&gt;REG[&#123;0&#125;] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]&quot;, 97: &quot;getchar&quot;, 98: &quot;putchar&quot;, 99: &quot;vm quit&quot;&#125;for i in range(0, len(a), 3): print(asmmm_map[a[i]].format(a[i+1], a[i+2])) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402VM-&gt;REG[0] = 87 putcharVM-&gt;REG[0] = 101putcharVM-&gt;REG[0] = 108putcharVM-&gt;REG[0] = 99 putcharVM-&gt;REG[0] = 111putcharVM-&gt;REG[0] = 109putcharVM-&gt;REG[0] = 101putcharVM-&gt;REG[0] = 32 putcharVM-&gt;REG[0] = 116putcharVM-&gt;REG[0] = 111putcharVM-&gt;REG[0] = 32putcharVM-&gt;REG[0] = 86putcharVM-&gt;REG[0] = 78putcharVM-&gt;REG[0] = 67putcharVM-&gt;REG[0] = 84putcharVM-&gt;REG[0] = 70putcharVM-&gt;REG[0] = 50putcharVM-&gt;REG[0] = 48putcharVM-&gt;REG[0] = 50putcharVM-&gt;REG[0] = 50putcharVM-&gt;REG[0] = 33putcharVM-&gt;REG[0] = 10putcharVM-&gt;REG[0] = 105putcharVM-&gt;REG[0] = 110putcharVM-&gt;REG[0] = 112putcharVM-&gt;REG[0] = 117putcharVM-&gt;REG[0] = 116putcharVM-&gt;REG[0] = 32putcharVM-&gt;REG[0] = 102putcharVM-&gt;REG[0] = 108putcharVM-&gt;REG[0] = 97putcharVM-&gt;REG[0] = 103putcharVM-&gt;REG[0] = 58putcharVM-&gt;REG[0] = 10putcharVM-&gt;REG[19] = 73VM-&gt;REG[3] = 0VM-&gt;REG[1] = 43VM-&gt;REG[2] = 1getcharpush REG[0]VM-&gt;REG[1] -= VM-&gt;REG[2]CMP VM-&gt;REG[3], VM-&gt;REG[1] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19] //è¾“å…¥flagï¼Œé•¿åº¦æ˜¯43VM-&gt;REG[0] = 0push REG[0]nopnoppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[6] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[6] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[6]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[6] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[6] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[6]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[6] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[6] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[7] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[7] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[7]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[7] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[7] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[7]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[7] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[7] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[8] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[8] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[8]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[8] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[8] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[8]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[8] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[8] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[9] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[9] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[9]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[9] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[9] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[9]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[9] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[9] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[10] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[10] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[10]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[10] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[10] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[10]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[10] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[10] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[11] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[11] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[11]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[11] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[11] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[11]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[11] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[11] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[12] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[12] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[12]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[12] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[12] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[12]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[12] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[12] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[13] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[13] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[13]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[13] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[13] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[13]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[13] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[13] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[14] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[14] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[14]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[14] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[14] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[14]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[14] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[14] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[15] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[15] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[15]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[15] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[15] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[15]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[15] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[15] += VM-&gt;REG[0]noppop REG[0]VM-&gt;REG[5] = 256VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[16] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[16] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[16]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[16] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[16] += VM-&gt;REG[0]VM-&gt;REG[0] = VM-&gt;REG[16]VM-&gt;REG[0] *= VM-&gt;REG[5];VM-&gt;REG[16] = VM-&gt;REG[0]pop REG[0]VM-&gt;REG[16] += VM-&gt;REG[0]noppush REG[6]push REG[7]push REG[8]push REG[9]push REG[10]push REG[11]push REG[12]push REG[13]push REG[14]push REG[15]push REG[16]pop REG[1]pop REG[2]VM-&gt;REG[20] = 284VM-&gt;REG[0] = 340VM-&gt;_eip = 3 * VM-&gt;REG[0]VM-&gt;REG[0] = 3906065887VM-&gt;REG[19] = 387VM-&gt;REG[20] = 339CMP VM-&gt;REG[0], VM-&gt;REG[1] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]VM-&gt;REG[0] = 4125344020CMP VM-&gt;REG[0], VM-&gt;REG[2] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]pop REG[1]pop REG[2]VM-&gt;REG[20] = 295VM-&gt;REG[0] = 340VM-&gt;_eip = 3 * VM-&gt;REG[0]VM-&gt;REG[0] = 579781142VM-&gt;REG[19] = 387VM-&gt;REG[20] = 339CMP VM-&gt;REG[0], VM-&gt;REG[1] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]VM-&gt;REG[0] = 2312395361CMP VM-&gt;REG[0], VM-&gt;REG[2] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]pop REG[1]pop REG[2]VM-&gt;REG[20] = 306VM-&gt;REG[0] = 340VM-&gt;_eip = 3 * VM-&gt;REG[0]VM-&gt;REG[0] = 1700499305VM-&gt;REG[19] = 387VM-&gt;REG[20] = 339CMP VM-&gt;REG[0], VM-&gt;REG[1] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]VM-&gt;REG[0] = 612671610CMP VM-&gt;REG[0], VM-&gt;REG[2] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]pop REG[1]pop REG[2]VM-&gt;REG[20] = 317VM-&gt;REG[0] = 340VM-&gt;_eip = 3 * VM-&gt;REG[0]VM-&gt;REG[0] = 3655723000VM-&gt;REG[19] = 387VM-&gt;REG[20] = 339CMP VM-&gt;REG[0], VM-&gt;REG[1] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]VM-&gt;REG[0] = 977540402CMP VM-&gt;REG[0], VM-&gt;REG[2] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]pop REG[1]pop REG[2]VM-&gt;REG[20] = 328VM-&gt;REG[0] = 340VM-&gt;_eip = 3 * VM-&gt;REG[0]VM-&gt;REG[0] = 2443935368VM-&gt;REG[19] = 387VM-&gt;REG[20] = 339CMP VM-&gt;REG[0], VM-&gt;REG[1] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]VM-&gt;REG[0] = 1778148540CMP VM-&gt;REG[0], VM-&gt;REG[2] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]pop REG[1]VM-&gt;REG[0] = 8206181CMP VM-&gt;REG[0], VM-&gt;REG[1] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]VM-&gt;REG[0] = 393VM-&gt;_eip = 3 * VM-&gt;REG[0]vm quitVM-&gt;REG[3] = 2654435769VM-&gt;REG[4] = 613452VM-&gt;REG[5] = 34589VM-&gt;REG[6] = 108471VM-&gt;REG[7] = 1230791VM-&gt;REG[8] = 0VM-&gt;REG[17] = 16VM-&gt;REG[18] = 32VM-&gt;REG[19] = 352VM-&gt;REG[10] = 0VM-&gt;REG[11] = 32VM-&gt;REG[12] = 1VM-&gt;REG[8] += VM-&gt;REG[3] sum += 2654435769VM-&gt;REG[0] = VM-&gt;REG[2] v1 VM-&gt;REG[0] *= VM-&gt;REG[17]; v1 &lt;&lt; 4VM-&gt;REG[0] += VM-&gt;REG[4] (v1 &lt;&lt; 4) + 613452VM-&gt;REG[14] = VM-&gt;REG[0] VM-&gt;REG[14] = (v1 &lt;&lt; 4) + 613452VM-&gt;REG[0] = VM-&gt;REG[2] VM-&gt;REG[0] += VM-&gt;REG[8] v1 + sumVM-&gt;REG[15] = VM-&gt;REG[0] VM-&gt;REG[15] = (v1 + sum)VM-&gt;REG[0] = VM-&gt;REG[2] VM-&gt;REG[0] /= VM-&gt;REG[18] v1 &gt;&gt; 5VM-&gt;REG[0] += VM-&gt;REG[5] (v1 &gt;&gt; 5) + 34589VM-&gt;REG[16] = VM-&gt;REG[0] VM-&gt;REG[16] = (v1 &gt;&gt; 5) + 34589VM-&gt;REG[0] = VM-&gt;REG[14]VM-&gt;REG[0] ^= VM-&gt;REG[15]VM-&gt;REG[0] ^= VM-&gt;REG[16]VM-&gt;REG[1] += VM-&gt;REG[0] v0 += ((v1 &lt;&lt; 4) + 613452) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + 34589)VM-&gt;REG[0] = VM-&gt;REG[1]VM-&gt;REG[0] *= VM-&gt;REG[17]; v0 &lt;&lt; 4VM-&gt;REG[0] += VM-&gt;REG[6] v0 &lt;&lt; 4 + 108471VM-&gt;REG[14] = VM-&gt;REG[0] VM-&gt;REG[14] = (v0 &lt;&lt; 4 + 108471)VM-&gt;REG[0] = VM-&gt;REG[1] VM-&gt;REG[0] += VM-&gt;REG[8] v0 + sumVM-&gt;REG[15] = VM-&gt;REG[0] VM-&gt;REG[15] = (v0 + sum)VM-&gt;REG[0] = VM-&gt;REG[1]VM-&gt;REG[0] /= VM-&gt;REG[18] v0 &gt;&gt; 5VM-&gt;REG[0] += VM-&gt;REG[7] ï¼ˆv0 &gt;&gt; 5) + 1230791VM-&gt;REG[16] = VM-&gt;REG[0] VM-&gt;REG[16] = (v0 &gt;&gt; 5) + 1230791VM-&gt;REG[0] = VM-&gt;REG[14]VM-&gt;REG[0] ^= VM-&gt;REG[15]VM-&gt;REG[0] ^= VM-&gt;REG[16] VM-&gt;REG[2] += VM-&gt;REG[0] v1 += ((v0 &lt;&lt; 4) + 108471) ^ (v0 + sum) ^ (v0 &gt;&gt; 5) + 1230791VM-&gt;REG[11] -= VM-&gt;REG[12]CMP VM-&gt;REG[10], VM-&gt;REG[11] if yes: VM-&gt;_eip = 3 * VM-&gt;REG[19]VM-&gt;_eip = 3 * VM-&gt;REG[20]nopVM-&gt;REG[0] = 110 # NOputcharVM-&gt;REG[0] = 111putcharVM-&gt;_eip = 3 * VM-&gt;REG[20]nopVM-&gt;REG[0] = 121 # YESputcharVM-&gt;REG[0] = 101putcharVM-&gt;REG[0] = 115putcharVM-&gt;_eip = 3 * VM-&gt;REG[20]nopnop ä¸€ç‚¹ç‚¹åˆ†æï¼Œå‘ç°æ˜¯teaåŠ å¯†ï¼Œæå–å‡ºå¯†æ–‡å’Œkeyï¼Œè§£å¯†å³å¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;//åŠ å¯†å‡½æ•°void encrypt(uint32_t *v, uint32_t *k)&#123; uint32_t v0 = v[0], v1 = v[1], sum = 0, i; /* set up */ uint32_t delta = 0x9e3779b9; /* a key schedule constant */ uint32_t k0 = k[0], k1 = k[1], k2 = k[2], k3 = k[3]; /* cache key */ for (i = 0; i &lt; 32; i++) &#123; /* basic cycle start */ sum += delta; v0 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k1); v1 += ((v0 &lt;&lt; 4) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k3); &#125; /* end cycle */ v[0] = v0; v[1] = v1;&#125;//è§£å¯†å‡½æ•°void decrypt(uint32_t *v, uint32_t *k)&#123; uint32_t v0 = v[0], v1 = v[1], sum = 0xC6EF3720, i; /* set up */ uint32_t delta = 0x9e3779b9; /* a key schedule constant */ uint32_t k0 = k[0], k1 = k[1], k2 = k[2], k3 = k[3]; /* cache key */ for (i = 0; i &lt; 32; i++) &#123; /* basic cycle start */ v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k3); v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k1); sum -= delta; &#125; /* end cycle */ v[0] = v0; v[1] = v1;&#125;int main()&#123; uint32_t key[] = &#123;613452, 34589, 108471, 1230791&#125;; uint32_t v[12] = &#123; 3906065887, 4125344020, 579781142, 2312395361, 1700499305, 612671610, 3655723000, 977540402, 2443935368, 1778148540, 8206181, 0&#125;; for (int i = 0; i &lt; 5; i++) &#123; decrypt(&amp;v[2 * i], key); &#125; printf(&quot;%s&quot;, (char *)v); return 0;&#125;// VNCTF&#123;ecd63ae5-8945-4ac4-b5a5-34fc3ade81e7&#125; 4.æ—¶ç©ºé£è¡ŒIDAæ‰“å¼€ï¼Œå‘ç°æµç¨‹éå¸¸çš„æ¸…æ™°ï¼Œå°±æ˜¯æ—¶é—´çš„é—®é¢˜ã€‚ã€‚ã€‚ å…ˆåˆ¤æ–­è¾“å…¥çš„æ—¥æœŸ å†™è„šæœ¬ç›´æ¥é€†å³å¯ 12345678910111213141516171819202122232425262728293031323334353637from z3 import *from Crypto.Util.number import *def __ROL4__(a1, num): return (a1 &lt;&lt; num) &amp; 0XFFFFFFFF | (a1 &gt;&gt; (32-num)) &amp; 0xFFFFFFFFdef __ROR4__(a1, num): return (a1 &gt;&gt; num) &amp; 0XFFFFFFFF | (a1 &lt;&lt; (32-num)) &amp; 0xFFFFFFFFdef sub_401A3B(a1): return (a1 ^ __ROL4__(a1, 13) ^ __ROR4__(a1, 9)) &amp; 0XFFFFFFFFCK = [0x00070E15, 0x1C232A31, 0x383F464D, 0x545B6269, 0x70777E85, 0x8C939AA1, 0xA8AFB6BD, 0xC4CBD2D9, 0xE0E7EEF5, 0xFC030A11, 0x181F262D, 0x343B4249, 0x50575E65, 0x6C737A81, 0x888F969D, 0xA4ABB2B9, 0xC0C7CED5, 0xDCE3EAF1, 0xF8FF060D, 0x141B2229, 0x30373E45, 0x4C535A61, 0x686F767D, 0x848B9299, 0xA0A7AEB5, 0xBCC3CAD1, 0xD8DFE6ED, 0xF4FB0209, 0x10171E25, 0x2C333A41, 0x484F565D, 0x646B7279]dword_404040 = [0xFD07C452, 0xEC90A488, 0x68D33CD1, 0x96F64587]FK = [0xA3B1BAC6, 0x56AA3350, 0x677D9197, 0xB27022DC]v5 = [0] * 32 + dword_404040j = 32for i in range(32): # å¾—åˆ°å‰é¢32ä¸ªæ•° v5[j-1] = sub_401A3B(v5[j] ^ v5[j+1] ^ v5[j+2] ^ CK[j-1]) ^ v5[j+3] j = j - 1c = v5[:4]c = [c[i] ^ FK[i] for i in range(4)]data = b&quot;&quot;for i in range(4): data += long_to_bytes(c[i])print(data)# 0211205 ç„¶åå†å¾€ä¸‹ï¼Œç”¨Z3è§£ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990from z3 import *from Crypto.Util.number import *flag = [BitVec(&quot;flag1_%d&quot; % i, 32) for i in range(66)]# len = 24dword_404080 = [0x00000025, 0x00000015, 0x000000DF, 0x000000A2, 0x000000C0, 0x00000093, 0x000000AD, 0x00000014, 0x00000046, 0x000000C5, 0x0000000F, 0x0000002E, 0x0000009A, 0x000000EB, 0x00000030, 0x000000F8, 0x00000020, 0x000000E9, 0x000000CB, 0x00000088, 0x000000C6, 0x000000BE, 0x0000008D, 0x000000E3]dword_4050C0 = [0x01000000, 0x02000000, 0x04000000, 0x08000000, 0x10000000, 0x20000000, 0x40000000, 0x80000000, 0x1B000000, 0x36000000]def HIBYTE(a1): return (a1 &gt;&gt; 24) &amp; 0XFFdef BYTE2(a1): return (a1 &gt;&gt; 16) &amp; 0XFFdef BYTE1(a1): return (a1 &gt;&gt; 8) &amp; 0XFFdef BYTE(a1): return a1 &amp; 0XFFdef sub_401FFB(a1, a2): v3 = [0] * 7 # sub_401EFB v3[0] = HIBYTE(a1) v3[1] = BYTE2(a1) v3[2] = BYTE1(a1) v3[3] = BYTE(a1) # sub_401F67 tmp = [0] * 6 for i in range(4): tmp[i] = v3[i] v4 = 1 for i in range(4): v3[i] = tmp[v4] v4 = v4 + 1 v4 = v4 % 4 # sub_401EA7 v4 = (v3[3] &amp; 0XFFFFFFFF) | ((v3[2] &lt;&lt; 8) &amp; 0XFFFFFFFF) | ( (v3[1] &lt;&lt; 16) &amp; 0XFFFFFFFF) | ((v3[0] &lt;&lt; 24) &amp; 0XFFFFFFFF) return (v4 ^ dword_4050C0[a2]) &amp; 0XFFFFFFFF# flag = [0X31323334, 0X35363738, 0X39303132,# 0x33343536, 0x37383930, 0x31323334] + [0] * 60v5 = 6v3 = 0while v5 &lt;= 65: if v5 % 6: flag[v5] = flag[v5 - 6] ^ flag[v5 - 1] else: v2 = flag[v5 - 6] flag[v5] = v2 ^ sub_401FFB(flag[v5 - 1], v3) v3 = v3 + 1 v5 = v5 + 1v4 = [0] * 24for i in range(6): v4[4 * i] = BYTE(flag[i + 60]) v4[4 * i + 1] = BYTE1(flag[i + 60]) v4[4 * i + 2] = BYTE2(flag[i + 60]) v4[4 * i + 3] = HIBYTE(flag[i + 60])for i in range(1, 24, 1): v4[i - 1] ^= (v4[i - 1] % 18 + v4[i] + 5) ^ 0x41s = Solver()for i in range(24): s.add(v4[i] == dword_404080[i])s.add(flag[0] == 1447969620) # VNCTassert s.check() == satprint(&quot;SUCCESS&quot;)m = s.model()real_flag = b&quot;&quot;for i in range(6): real_flag += long_to_bytes(m[flag[i]].as_long())print(real_flag)# VNCTF&#123;TimeFlightMachine&#125; å»æ‰ç©ºå­—ç¬¦ä¸ºflagï¼š VNCTF{TimeFl20211205ightMachine}","categories":[{"name":"CTF","slug":"CTF","permalink":"https://zzzzsky.github.io/categories/CTF/"}],"tags":[{"name":"vm","slug":"vm","permalink":"https://zzzzsky.github.io/tags/vm/"}]},{"title":"networkx è§£å†³CTF_REå›¾æœ€çŸ­è·¯å¾„é—®é¢˜","slug":"networkxè§£å†³CTF_REå›¾é—®é¢˜","date":"2021-12-09T07:38:00.000Z","updated":"2021-12-09T07:40:22.708Z","comments":true,"path":"2021/12/09/networkxè§£å†³CTF_REå›¾é—®é¢˜/","link":"","permalink":"https://zzzzsky.github.io/2021/12/09/networkx%E8%A7%A3%E5%86%B3CTF_RE%E5%9B%BE%E9%97%AE%E9%A2%98/","excerpt":"","text":"networkx è§£å†³CTF_REå›¾æœ€çŸ­è·¯å¾„é—®é¢˜å‰è¨€æœ€è¿‘å¤ç°äº†äº†ä¸‹ä»Šå¹´L3HCTFçš„IDAAAAAé¢˜ï¼Œç„¶åé€šè¿‡æ­¤é¢˜åˆè”æƒ³åˆ°äº†ä¹‹å‰åšçš„ä¸€é“ç‰¹æ®Šçš„è¿·å®«é¢˜invisible_maze-fix,å‘ç°é€šè¿‡pythonçš„networkxè§£å†³æ­¤ç±»é—®é¢˜ç›¸å½“çš„æ–¹ä¾¿ï¼Œå› æ­¤è®°å½•ä¸‹è§£é¢˜è¿‡ç¨‹ï¼Œæ–¹ä¾¿ä»¥åæŸ¥è¯¢ã€‚ 2é“é¢˜ç›®é™„ä»¶ğŸ‘‡ é“¾æ¥ï¼šhttps://pan.baidu.com/s/1reVYGScanSCs5H4ykl60vwæå–ç ï¼škvhl invisible_mazeå¸¸è§„çš„è¿·å®«é¢˜ç›®åœ¨CTFé€†å‘é¢˜ç›®ä¸­ï¼Œå¸¸è§„çš„è¿·å®«é¢˜ç›®ä¸€èˆ¬æ˜¯ç¨‹åºç»™ä½ ä¸€ä¸ªéå¸¸é•¿çš„å­—ç¬¦ä¸²ï¼Œç„¶åè‡ªå·±æ•´ç†å¯ä»¥å¾—åˆ°æ•´ä¸ªè¿·å®«çš„å…¨è²Œï¼Œæ¯”å¦‚ä¸‹å›¾è¿™ç§ è¿™ç§èƒ½å¾ˆå®¹æ˜“çš„å¾—åˆ°æ•´ä¸ªè¿·å®«çš„è·¯å¾„ï¼Œå¯æ˜¯è¿™ä¸ªinvisible_mazeè¿™ä¸ªé¢˜æ‰å¯ä»¥è¯´æ˜¯æ˜¯çœŸæ­£çš„è¿·å®«é¢˜ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä»ä¸Šå¸è§†è§’ç»™ä½ è·¯å¾„çš„å…¨è²Œï¼Œè€Œæ˜¯æŠŠä½ æ”¾åˆ°äº†ä¸ªè¿·å®«ä¸­ï¼Œæ¯èµ°ä¸€æ­¥ï¼Œå®ƒå‘Šè¯‰ä½ ï¼Œä¸Šä¸‹å·¦å³åˆ†åˆ«å»å“ª æœ¬é¢˜é¢˜è§£åˆ†æIDAæ‰“å¼€ç¨‹åºåˆ†æ è¿›å…¥sub_401050å‡½æ•°ï¼Œ ç¨‹åºå‘Šè¯‰ä½ ä¸Šä¸‹å·¦å³èµ°çš„è¯æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œå¾ˆæ˜æ˜¾ï¼Œåªæœ‰è¿›å…¥å¦ä¸€ä¸ªå‡½æ•°è·¯æ‰æ˜¯é€šçš„ ç›´æ¥æŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œäº¤å‰å¼•ç”¨æ¥åˆ°æˆåŠŸçš„åœ°æ–¹ å¯ä»¥å‘ç°åªæœ‰è¿›å…¥åˆ°sub_41F1E0,ç„¶åå†æŒ‰sæ‰ä¼šæˆåŠŸï¼Œè€Œæ•´ä¸ªè¿·å®«çš„è·¯å¾„æ˜¯éå¸¸å¤æ‚çš„ è§‚å¯Ÿå‡½æ•°çª—å£ï¼Œå‘ç°ä»sub_401050 åˆ° sub_41F270 å…¨æ˜¯è¿™æ ·çš„ç»“æ„ï¼Œæˆ‘ä»¬æ‰‹åŠ¨çš„å»ç”»å‡ºæ•´ä¸ªè¿·å®«æ˜¾ç„¶æ˜¯ä¸ç°å®çš„ï¼Œæ¯ä¸ªå‡½æ•°å…¶å®å°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åä¸¤ä¸ªèŠ‚ç‚¹å°±æ„æˆäº†ä¸€æ¡è¾¹ï¼Œæ¯”å¦‚ï¼šsub_401050å°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œsub_401050 ---&gt; sub_4010E0å°±æ˜¯ä¸€æ¡è¾¹ã€‚ æ¯ä¸ªå‡½æ•°çš„ç»“æ„åŸºæœ¬å·®ä¸å¤šï¼Œè€ƒè™‘æ‰“ç®—ç”¨IDAPythonæ‰“å°å‡ºæ¯ä¸ªèŠ‚ç‚¹ï¼Œä»¥åŠå®ƒå¯¹åº”çš„adswå¯¹åº”çš„å››ä¸ªå€¼ï¼Œå¦‚æœæ˜¯è¿›å…¥å¦å¤–ä¸€ä¸ªå‡½æ•°çš„è¯ï¼Œé‚£ä¹ˆæœ¬å‡½æ•°å’Œè¿›å…¥çš„é‚£ä¸ªå‡½æ•°å°±æ„é€ æˆäº†ä¸€æ¡è¾¹ï¼Œæœ€åå°†èŠ‚ç‚¹å’Œè¾¹ä¼ å…¥pythonçš„networkxåº“å°±èƒ½æ„é€ å‡ºæ•´ä¸ªè¿·å®«å›¾ï¼Œç›´æ¥è°ƒç”¨å‡½æ•°å°±èƒ½æ±‚æœ€çŸ­è·¯å¾„äº†ã€‚ å‘ç°å‡½æ•°åªæœ‰ä¸‹é¢2ç§æƒ…å†µ å½“ç»è¿‡caseè¡¨è·³è½¬åï¼Œå¦‚æœç¬¬ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤æ˜¯push xxxï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯ä¸é€šçš„ï¼ˆé™¤äº†æˆåŠŸçš„é‚£ä¸ªä½ç½®ï¼‰ï¼Œå¦‚æœæ˜¯call sub_xxxçš„è¯ï¼Œé‚£ä¹ˆæœ¬æ¡æ±‡ç¼–æŒ‡ä»¤å°±å¯ä»¥æ‰¾åˆ°ä¸‹ä¸€ä¸ªå‡½æ•°ï¼ˆèŠ‚ç‚¹ï¼‰ï¼Œå¦‚æœæ˜¯pop esiçš„è¯ï¼Œä¸‹ä¸€æ¡jmp xxxå°±æ˜¯è¿›å…¥çš„ä¸‹ä¸€ä¸ªå‡½æ•°ï¼ˆèŠ‚ç‚¹ï¼‰ ç¼–å†™IDAPythonè„šæœ¬å†™IDAPythonè„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738def get_edges_from_func(func_addr): func_end_addr = idc.find_func_end(func_addr) # æ‰¾åˆ°æ­¤å‡½æ•°æœ«å°¾åœ°å€ addr = func_addr while addr &lt; func_end_addr: addr = idc.next_head(addr) # å¾—åˆ°ä¸‹ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤çš„åœ°å€ if idc.print_insn_mnem(addr) == &#x27;movzx&#x27;: # å¾—åˆ°æœ¬æ¡æ±‡ç¼–æŒ‡ä»¤çš„æ“ä½œæŒ‡ä»¤ index_table_addr = get_operand_value(addr ,1) # å¾—åˆ°adswå¯¹åº”çš„ç´¢å¼•è¡¨ï¼Œå¯¹åº”ä¸Š2å›¾çš„0x4010C0 å’Œ 0x41E384 addr = idc.next_head(addr) # æ¥åˆ°Jmp ds:xxxx[eax * 4]çš„ä½ç½® switch_table_addr = get_operand_value(addr ,0) # å¾—åˆ°caseè¡¨çš„åœ°å€ break value = get_bytes(index_table_addr, 23) index_adws = [value[0], value[3], value[18], value[22]] # è·å–adswå¯¹åº”çš„4ä¸ªæ•° # print(index_adws) edges = [] for i in index_adws: # éå† tmp = get_wide_dword(switch_table_addr + i * 4) if idc.print_insn_mnem(tmp) == &#x27;push&#x27;: edges.append(None) elif idc.print_insn_mnem(tmp) == &#x27;call&#x27;: edges.append(get_operand_value(tmp ,0)) # å¾—åˆ°callçš„é‚£ä¸ªå‡½æ•°çš„åœ°å€ elif idc.print_insn_mnem(tmp) == &#x27;pop&#x27;: tmp = idc.next_head(tmp) # æ¥åˆ°jmp sub_xxxçš„åœ°å€ edges.append(get_operand_value(tmp ,0)) # print(edges) return edgesfunc_list = list(Functions(0x401050, 0x41F271)) # åˆ—å‡ºæ­¤èŒƒå›´æ‰€æœ‰çš„å‡½æ•°all_edges = []for i in func_list: edges = get_edges_from_func(i) all_edges.append(edges)print(all_edges)print(&quot;len(func_list): %d&quot; % len(func_list))print(&quot;len(all_edges): %d&quot; % len(all_edges))print(func_list) è¾“å…¥ç»“æœ 1234[[None, 4198624, None, None], [4198480, None, 4198784, None], [None, None, 4207712, 4198624], [None, 4199104, 4211312, None], [4198944, 4199264, None, None], [4199104, 4199424, None, None], [4199264, 4199584, None, None], [4199424, 4199744, None, None], [4199584, 4199904, 4211472, None], [4199744, 4200064, None, None], [4199904, 4200224, None, None], [4200064, 4200384, None, None], [4200224, 4200544, None, None], [4200384, 4200688, None, None], [4200544, 4200848, None, None], [4200688, 4201008, None, None], [4200848, 4201168, None, None], [4201008, 4201312, None, None], [4201168, 4201456, None, None], [4201312, 4201616, None, None], [4201456, 4201776, None, None], [4201616, 4201936, None, None], [4201776, 4202096, None, None], [4201936, 4202240, None, None], [4202096, 4202384, None, None], [4202240, 4202544, None, None], [4202384, 4202704, None, None], [4202544, 4202848, None, None], [4202704, 4203008, None, None], [4202848, 4203168, None, None], [4203008, 4203328, None, None], [4203168, 4203488, None, None], [4203328, 4203648, None, None], [4203488, 4203808, None, None], [4203648, 4203968, None, None], [4203808, 4204128, None, None], [4203968, 4204272, None, None], [4204128, 4204432, None, None], [4204272, 4204592, None, None], [4204432, 4204752, None, None], [4204592, 4204912, None, None], [4204752, 4205056, None, None], [4204912, 4205216, None, None], [4205056, 4205376, None, None], [4205216, 4205536, None, None], [4205376, None, 4211632, None], [None, 4205824, 4211792, None], [4205680, 4205984, None, None], [4205824, 4206144, None, None], [4205984, 4206304, None, None], [4206144, 4206448, None, None], [4206304, 4206608, None, None], [4206448, 4206768, None, None], [4206608, 4206928, None, None], [4206768, 4207088, None, None], [4206928, 4207232, None, None], [4207088, 4207392, None, None], [4207232, 4207552, None, None], [4207392, None, 4211952, None], [None, 4207872, None, 4198784], [4207712, 4208032, None, None], [4207872, 4208192, None, None], [4208032, 4208352, None, None], [4208192, 4208496, None, None], [4208352, 4208656, None, None], [4208496, 4208816, None, None], [4208656, 4208960, None, None], [4208816, 4209120, 4212112, None], [4208960, 4209280, None, None], [4209120, 4209440, None, None], [4209280, 4209600, None, None], [4209440, 4209760, None, None], [4209600, 4209904, None, None], [4209760, 4210064, None, None], [4209904, 4210224, None, None], [4210064, 4210368, None, None], [4210224, 4210528, None, None], [4210368, 4210688, 4212272, None], [4210528, 4210832, None, None], [4210688, 4210992, None, None], [4210832, 4211152, None, None], [4210992, 4211312, None, None], [4211152, None, None, 4198944], [None, None, 4212432, 4199744], [None, None, 4216832, 4205536], [None, None, 4216992, 4205680], [None, None, 4217136, 4207552], [None, None, 4218240, 4208960], [None, None, 4218400, 4210528], [None, None, 4218560, 4211472], [None, 4212752, 4218720, None], [4212592, 4212912, None, None], [4212752, 4213072, None, None], [4212912, 4213232, None, None], [4213072, 4213392, None, None], [4213232, 4213552, None, None], [4213392, 4213696, None, None], [4213552, 4213856, None, None], [4213696, 4214016, None, None], [4213856, 4214176, None, None], [4214016, 4214320, None, None], [4214176, 4214480, None, None], [4214320, 4214640, None, None], [4214480, 4214800, None, None], [4214640, 4214960, None, None], [4214800, 4215120, None, None], [4214960, 4215280, None, None], [4215120, 4215440, None, None], [4215280, 4215584, None, None], [4215440, 4215744, None, None], [4215584, 4215904, None, None], [4215744, 4216064, None, None], [4215904, 4216208, None, None], [4216064, 4216352, None, None], [4216208, 4216512, None, None], [4216352, 4216672, None, None], [4216512, None, 4218880, None], [None, None, 4219040, 4211632], [None, None, 4219200, 4211792], [None, None, 4219360, 4211952], [None, 4217440, 4219520, None], [4217296, 4217600, None, None], [4217440, 4217760, None, None], [4217600, 4217920, None, None], [4217760, 4218080, None, None], [4217920, None, 4219680, None], [None, None, 4219840, 4212112], [None, None, 4219984, 4212272], [None, None, 4220144, 4212432], [None, None, 4220304, 4212592], [None, None, 4220464, 4216672], [None, None, 4220608, 4216832], [None, None, 4220768, 4216992], [None, None, 4222032, 4217136], [None, None, 4222192, 4217296], [None, None, 4222352, 4218080], [None, None, 4222496, 4218240], [None, None, 4222640, 4218400], [None, None, 4223248, 4218560], [None, None, 4223856, 4218720], [None, None, 4225584, 4218880], [None, None, 4225744, 4219040], [None, 4220928, None, 4219200], [4220768, 4221088, None, None], [4220928, 4221232, None, None], [4221088, 4221392, None, None], [4221232, 4221552, None, None], [4221392, 4221712, None, None], [4221552, 4221872, None, None], [4221712, None, 4225888, None], [None, None, 4226048, 4219360], [None, None, 4226208, 4219520], [None, None, 4226688, 4219680], [None, None, 4227008, 4219840], [None, None, 4227168, 4219984], [None, 4222928, None, None], [4222800, 4223088, None, None], [4222928, 4223248, None, None], [4223088, 4223408, None, 4220144], [4223248, 4223568, None, None], [4223408, 4223712, None, None], [4223568, None, None, None], [None, None, 4227328, 4220304], [None, 4224176, 4227488, None], [4224016, 4224336, None, None], [4224176, 4224496, None, None], [4224336, 4224656, None, None], [4224496, 4224816, None, None], [4224656, 4224976, None, None], [4224816, 4225120, None, None], [4224976, 4225264, None, None], [4225120, 4225424, None, None], [4225264, None, 4227648, None], [None, None, 4227808, 4220464], [None, None, 4227968, 4220608], [None, None, 4228112, 4221872], [None, None, 4228272, 4222032], [None, None, 4228576, 4222192], [None, 4226528, 4228736, None], [4226368, 4226688, None, None], [4226528, None, None, 4222352], [None, 4227008, 4228896, None], [4226848, None, None, 4222496], [None, None, 4229056, 4222640], [None, None, 4229680, 4223856], [None, None, 4229840, 4224016], [None, None, 4230928, 4225424], [None, None, 4231088, 4225584], [None, None, 4231248, 4225744], [None, None, 4232208, 4225888], [None, 4228416, None, 4226048], [4228272, None, 4232368, None], [None, None, 4232672, 4226208], [None, None, 4232832, 4226368], [None, None, 4232992, 4226848], [None, None, 4233152, 4227168], [None, 4229376, 4233312, None], [4229216, 4229520, None, None], [4229376, 4229680, None, None], [4229520, None, None, 4227328], [None, 4229984, None, 4227488], [4229840, 4230144, None, None], [4229984, 4230288, None, None], [4230144, 4230448, None, None], [4230288, 4230608, None, None], [4230448, 4230768, None, None], [4230608, None, 4233472, None], [None, None, 4233616, 4227648], [None, None, 4233776, 4227808], [None, None, 4233920, 4227968], [None, 4231568, 4234080, None], [4231408, 4231728, None, None], [4231568, 4231888, None, None], [4231728, 4232048, None, None], [4231888, None, 4234240, None], [None, None, 4234400, 4228112], [None, 4232528, None, 4228416], [4232368, None, 4234560, None], [None, None, 4234880, 4228576], [None, None, 4235328, 4228736], [None, None, 4235792, 4228896], [None, None, 4236576, 4229056], [None, None, 4236736, 4229216], [None, None, 4238784, 4230768], [None, None, 4238944, 4230928], [None, None, 4239104, 4231088], [None, None, 4239264, 4231248], [None, None, 4239424, 4231408], [None, None, 4239584, 4232048], [None, None, 4239744, 4232208], [None, 4234720, None, 4232528], [4234560, None, 4239904, None], [None, 4235040, None, 4232672], [4234880, 4235200, None, None], [4235040, 4235328, None, None], [4235200, None, 4240064, 4232832], [None, 4235632, 4240368, None], [4235488, 4235792, None, None], [4235632, 4235952, None, 4232992], [4235792, 4236112, None, None], [4235952, 4236272, None, None], [4236112, 4236432, None, None], [4236272, None, None, None], [None, None, 4240528, 4233152], [None, 4236896, None, 4233312], [4236736, 4237056, None, None], [4236896, 4237216, None, None], [4237056, 4237376, None, None], [4237216, 4237520, None, None], [4237376, 4237664, None, None], [4237520, 4237824, None, None], [4237664, 4237984, None, None], [4237824, 4238144, None, None], [4237984, 4238304, None, None], [4238144, 4238464, None, None], [4238304, 4238624, None, None], [4238464, 4238784, None, None], [4238624, None, None, 4233472], [None, None, 4240688, 4233616], [None, None, 4240848, 4233776], [None, None, 4241008, 4233920], [None, None, 4241168, 4234080], [None, None, 4241312, 4234240], [None, None, 4241456, 4234400], [None, None, 4241616, 4234720], [None, 4240224, None, 4235328], [4240064, 4240368, None, None], [4240224, None, None, 4235488], [None, None, 4241776, 4236576], [None, None, 4246640, 4238944], [None, None, 4246800, 4239104], [None, None, 4246960, 4239264], [None, None, 4247120, 4239424], [None, None, 4247280, 4239584], [None, None, 4247440, 4239744], [None, None, 4247904, 4239904], [None, 4241936, None, 4240528], [4241776, 4242096, None, None], [4241936, 4242256, None, None], [4242096, 4242416, None, None], [4242256, 4242576, None, None], [4242416, 4242736, None, None], [4242576, 4242896, None, None], [4242736, 4243040, None, None], [4242896, 4243200, None, None], [4243040, 4243360, None, None], [4243200, 4243504, None, None], [4243360, 4243664, None, None], [4243504, 4243824, None, None], [4243664, 4243984, None, None], [4243824, 4244144, None, None], [4243984, 4244288, None, None], [4244144, 4244448, None, None], [4244288, 4244608, None, None], [4244448, 4244768, None, None], [4244608, 4244928, None, None], [4244768, 4245072, None, None], [4244928, 4245232, None, None], [4245072, 4245392, None, None], [4245232, 4245536, None, None], [4245392, 4245696, None, None], [4245536, 4245840, None, None], [4245696, 4246000, None, None], [4245840, 4246160, None, None], [4246000, 4246320, None, None], [4246160, 4246480, None, None], [4246320, 4246640, None, None], [4246480, None, None, 4240688], [None, None, 4248064, 4240848], [None, None, 4248224, 4241008], [None, None, 4248384, 4241168], [None, None, 4248544, 4241312], [None, None, 4248704, 4241456], [None, None, 4248864, None], [None, 4247904, 4249184, None], [4247744, None, None, 4241616], [None, None, 4257312, 4246800], [None, None, 4257472, 4246960], [None, None, 4257632, 4247120], [None, None, 4257760, 4247280], [None, None, 4257920, 4247440], [None, 4249024, 4258080, 4247600], [4248864, 4249184, None, None], [4249024, None, None, 4247744], [None, 4249504, 4258240, None], [4249344, 4249664, None, None], [4249504, 4249824, None, None], [4249664, 4249984, None, None], [4249824, 4250144, None, None], [4249984, 4250304, None, None], [4250144, 4250464, None, None], [4250304, 4250624, None, None], [4250464, 4250784, None, None], [4250624, 4250944, None, None], [4250784, 4251088, None, None], [4250944, 4251248, None, None], [4251088, 4251408, None, None], [4251248, 4251568, None, None], [4251408, 4251712, None, None], [4251568, 4251872, None, None], [4251712, 4252032, None, None], [4251872, 4252192, None, None], [4252032, 4252336, None, None], [4252192, 4252496, None, None], [4252336, 4252656, None, None], [4252496, 4252816, None, None], [4252656, 4252976, None, None], [4252816, 4253136, None, None], [4252976, 4253296, None, None], [4253136, 4253456, None, None], [4253296, 4253616, None, None], [4253456, 4253776, None, None], [4253616, 4253936, None, None], [4253776, 4254096, None, None], [4253936, 4254240, None, None], [4254096, 4254400, None, None], [4254240, 4254544, None, None], [4254400, 4254704, None, None], [4254544, 4254848, None, None], [4254704, 4255008, None, None], [4254848, 4255152, None, None], [4255008, 4255312, None, None], [4255152, 4255472, None, None], [4255312, 4255616, None, None], [4255472, 4255776, None, None], [4255616, 4255936, None, None], [4255776, 4256080, None, None], [4255936, 4256240, None, None], [4256080, 4256400, None, None], [4256240, 4256560, None, None], [4256400, 4256704, None, None], [4256560, 4256848, None, None], [4256704, 4257008, None, None], [4256848, 4257152, None, None], [4257008, None, 4258400, None], [None, None, 4258544, 4248064], [None, None, 4258704, 4248224], [None, None, None, 4248384], [None, None, 4258864, 4248544], [None, None, 4259024, 4248704], [None, None, 4259184, 4248864], [None, None, 4259344, 4249344], [None, None, 4263760, 4257152], [None, None, 4263920, 4257312], [None, None, 4264080, 4257472], [None, None, 4265200, 4257760], [None, None, 4265344, 4257920], [None, None, 4265504, 4258080], [None, None, 4265648, 4258240], [None, 4259648, 4265792, None], [4259488, 4259808, None, None], [4259648, 4259968, None, None], [4259808, 4260128, None, None], [4259968, None, 4265952, None], [None, 4260448, 4266112, None], [4260288, 4260592, None, None], [4260448, 4260752, None, None], [4260592, 4260912, None, None], [4260752, 4261072, None, None], [4260912, 4261232, None, None], [4261072, 4261392, None, None], [4261232, 4261552, None, None], [4261392, 4261712, None, None], [4261552, 4261872, None, None], [4261712, 4262032, None, None], [4261872, 4262176, None, None], [4262032, 4262320, None, None], [4262176, 4262480, None, None], [4262320, 4262640, None, None], [4262480, 4262800, None, None], [4262640, 4262960, None, None], [4262800, 4263120, None, None], [4262960, 4263280, None, None], [4263120, 4263440, None, None], [4263280, 4263600, None, None], [4263440, None, 4266272, None], [None, None, 4268496, 4258400], [None, None, 4268656, 4258544], [None, 4264240, None, 4258704], [4264080, 4264400, None, None], [4264240, 4264560, None, None], [4264400, 4264720, None, None], [4264560, 4264880, None, None], [4264720, 4265040, None, None], [4264880, 4265200, None, None], [4265040, None, None, 4258864], [None, None, 4268816, 4259024], [None, None, 4268976, 4259184], [None, None, 4269136, 4259344], [None, None, 4269296, 4259488], [None, None, 4269456, 4260128], [None, None, 4269616, 4260288], [None, 4266432, None, 4263600], [4266272, 4266592, None, None], [4266432, 4266752, None, None], [4266592, 4266912, None, None], [4266752, 4267072, None, None], [4266912, 4267232, None, None], [4267072, 4267392, None, None], [4267232, 4267552, None, None], [4267392, 4267712, None, None], [4267552, 4267872, None, None], [4267712, 4268032, None, None], [4267872, 4268192, None, None], [4268032, 4268352, None, None], [4268192, 4268496, None, None], [4268352, None, None, 4263760], [None, None, 4269760, 4263920], [None, None, 4272288, 4265344], [None, None, 4272448, 4265504], [None, None, 4272608, 4265648], [None, None, 4273392, 4265792], [None, None, 4273552, 4265952], [None, None, 4273696, 4266112], [None, 4269920, None, 4268656], [4269760, 4270080, None, None], [4269920, 4270240, None, None], [4270080, 4270400, None, None], [4270240, 4270560, None, None], [4270400, 4270720, None, None], [4270560, 4270880, None, None], [4270720, 4271040, None, None], [4270880, 4271184, None, None], [4271040, 4271328, None, None], [4271184, 4271488, None, None], [4271328, 4271648, None, None], [4271488, 4271808, None, None], [4271648, 4271968, None, None], [4271808, 4272128, None, None], [4271968, 4272288, None, None], [4272128, None, None, 4268816], [None, None, 4274480, 4268976], [None, 4272768, None, 4269136], [4272608, 4272928, None, None], [4272768, 4273088, None, None], [4272928, 4273248, None, None], [4273088, 4273392, None, None], [4273248, None, None, 4269296], [None, None, 4274640, 4269456], [None, None, 4274800, 4269616], [None, 4274000, 4277808, None], [4273840, 4274160, None, None], [4274000, 4274320, None, None], [4274160, None, 4277968, None], [None, None, 4284896, 4272448], [None, None, 4286496, 4273552], [None, 4274960, None, 4273696], [4274800, 4275120, None, None], [4274960, 4275280, None, None], [4275120, 4275440, None, None], [4275280, 4275584, None, None], [4275440, 4275744, None, None], [4275584, 4275904, None, None], [4275744, 4276064, None, None], [4275904, 4276208, None, None], [4276064, 4276368, None, None], [4276208, 4276528, None, None], [4276368, 4276688, None, None], [4276528, 4276848, None, None], [4276688, 4277008, None, None], [4276848, 4277168, None, None], [4277008, 4277328, None, None], [4277168, 4277488, None, None], [4277328, 4277648, None, None], [4277488, 4277808, None, None], [4277648, None, None, 4273840], [None, 4278128, None, 4274320], [4277968, 4278288, None, None], [4278128, 4278448, None, None], [4278288, 4278608, None, None], [4278448, 4278768, None, None], [4278608, 4278928, None, None], [4278768, 4279072, None, None], [4278928, 4279216, None, None], [4279072, 4279376, None, None], [4279216, 4279536, None, None], [4279376, 4279696, None, None], [4279536, 4279840, None, None], [4279696, 4280000, None, None], [4279840, 4280160, None, None], [4280000, 4280304, None, None], [4280160, 4280464, None, None], [4280304, 4280624, None, None], [4280464, 4280784, None, None], [4280624, 4280944, None, None], [4280784, 4281088, None, None], [4280944, 4281248, None, None], [4281088, 4281408, None, None], [4281248, 4281568, None, None], [4281408, 4281728, None, None], [4281568, 4281888, None, None], [4281728, 4282048, None, None], [4281888, 4282208, None, None], [4282048, 4282352, None, None], [4282208, 4282512, None, None], [4282352, 4282656, None, None], [4282512, 4282816, None, None], [4282656, 4282976, None, None], [4282816, 4283136, None, None], [4282976, 4283296, None, None], [4283136, 4283456, None, None], [4283296, 4283616, None, None], [4283456, 4283776, None, None], [4283616, 4283936, None, None], [4283776, 4284096, None, None], [4283936, 4284256, None, None], [4284096, 4284416, None, None], [4284256, 4284576, None, None], [4284416, 4284736, None, None], [4284576, 4284896, None, None], [4284736, None, None, 4274480], [None, 4285216, 4286656, None], [4285056, 4285376, None, None], [4285216, 4285536, None, None], [4285376, 4285696, None, None], [4285536, 4285856, None, None], [4285696, 4286016, None, None], [4285856, 4286176, None, None], [4286016, 4286336, None, None], [4286176, 4286496, None, None], [4286336, None, None, 4274640], [None, None, 4296976, 4285056], [None, 4286976, 4297136, None], [4286816, 4287120, None, None], [4286976, 4287264, None, None], [4287120, 4287424, None, None], [4287264, 4287584, None, None], [4287424, 4287744, None, None], [4287584, 4287904, None, None], [4287744, 4288064, None, None], [4287904, 4288224, None, None], [4288064, 4288384, None, None], [4288224, 4288528, None, None], [4288384, 4288688, None, None], [4288528, 4288848, None, None], [4288688, 4288992, None, None], [4288848, 4289152, None, None], [4288992, 4289312, None, None], [4289152, 4289472, None, None], [4289312, 4289632, None, None], [4289472, 4289792, None, None], [4289632, 4289952, None, None], [4289792, 4290112, None, None], [4289952, 4290272, None, None], [4290112, 4290432, None, None], [4290272, 4290592, None, None], [4290432, 4290752, None, None], [4290592, 4290912, None, None], [4290752, 4291072, None, None], [4290912, 4291232, None, None], [4291072, 4291376, None, None], [4291232, 4291536, None, None], [4291376, 4291696, None, None], [4291536, 4291856, None, None], [4291696, 4292000, None, None], [4291856, 4292144, None, None], [4292000, 4292288, None, None], [4292144, 4292448, None, None], [4292288, 4292608, None, None], [4292448, 4292768, None, None], [4292608, 4292928, None, None], [4292768, 4293088, None, None], [4292928, 4293248, None, None], [4293088, 4293392, None, None], [4293248, 4293552, None, None], [4293392, 4293696, None, None], [4293552, 4293856, None, None], [4293696, 4294016, None, None], [4293856, 4294160, None, None], [4294016, 4294320, None, None], [4294160, 4294480, 4297296, None], [4294320, 4294640, None, None], [4294480, 4294800, None, None], [4294640, 4294944, None, None], [4294800, 4295088, None, None], [4294944, 4295232, None, None], [4295088, 4295392, None, None], [4295232, 4295552, None, None], [4295392, 4295696, None, None], [4295552, 4295856, None, None], [4295696, 4296016, None, None], [4295856, 4296176, None, None], [4296016, 4296336, None, None], [4296176, 4296496, None, None], [4296336, 4296656, None, None], [4296496, 4296816, None, None], [4296656, None, 4297424, None], [None, None, 4297584, 4286656], [None, None, 4297744, 4286816], [None, None, 4297904, 4294320], [None, None, 4299472, 4296816], [None, None, 4300720, 4296976], [None, None, 4302288, 4297136], [None, None, 4308576, 4297296], [None, 4298224, 4308720, None], [4298064, 4298384, None, None], [4298224, 4298528, None, None], [4298384, 4298688, None, None], [4298528, 4298848, None, None], [4298688, 4299008, None, None], [4298848, 4299168, None, None], [4299008, 4299312, None, None], [4299168, 4299472, None, None], [4299312, 4299632, None, 4297424], [4299472, 4299792, None, None], [4299632, 4299936, None, None], [4299792, 4300096, None, None], [4299936, 4300256, None, None], [4300096, 4300416, None, None], [4300256, 4300576, None, None], [4300416, None, None, None], [None, 4300864, None, 4297584], [4300720, 4301024, None, None], [4300864, 4301184, None, None], [4301024, 4301344, None, None], [4301184, 4301504, None, None], [4301344, 4301648, None, None], [4301504, 4301808, None, None], [4301648, 4301968, None, None], [4301808, 4302128, None, None], [4301968, 4302288, None, None], [4302128, 4302448, None, 4297744], [4302288, 4302608, None, None], [4302448, 4302768, None, None], [4302608, 4302912, None, None], [4302768, 4303072, None, None], [4302912, 4303232, None, None], [4303072, 4303392, None, None], [4303232, 4303552, None, None], [4303392, 4303712, None, None], [4303552, 4303872, None, None], [4303712, 4304032, None, None], [4303872, 4304192, None, None], [4304032, 4304352, None, None], [4304192, 4304496, None, None], [4304352, 4304656, None, None], [4304496, 4304816, None, None], [4304656, 4304976, None, None], [4304816, 4305136, None, None], [4304976, 4305296, None, None], [4305136, 4305456, None, None], [4305296, 4305616, None, None], [4305456, 4305776, None, None], [4305616, 4305936, None, None], [4305776, 4306096, None, None], [4305936, 4306256, None, None], [4306096, 4306400, None, None], [4306256, 4306560, None, None], [4306400, 4306720, None, None], [4306560, 4306880, None, None], [4306720, 4307024, None, None], [4306880, 4307184, None, None], [4307024, 4307344, None, None], [4307184, 4307504, None, None], [4307344, 4307664, None, None], [4307504, 4307808, None, None], [4307664, 4307968, None, None], [4307808, 4308128, None, None], [4307968, 4308288, None, None], [4308128, 4308448, None, None], [4308288, None, None, None], [None, None, 4308880, 4297904], [None, None, 4309040, 4298064], [None, None, 4311264, 4308576], [None, None, 4311888, 4308720], [None, 4309360, 4312336, None], [4309200, 4309520, 4312496, None], [4309360, None, 4312624, None], [None, None, 4313872, None], [None, 4309984, 4315312, None], [4309824, None, 4315472, None], [None, 4310304, 4316112, None], [4310144, 4310464, 4316272, None], [4310304, 4310624, 4316432, None], [4310464, 4310784, 4316592, None], [4310624, 4310944, 4316736, None], [4310784, 4311104, 4316896, None], [4310944, None, 4317024, None], [None, 4311424, 4317664, 4308880], [4311264, 4311584, 4317824, None], [4311424, 4311744, 4317984, None], [4311584, None, 4318112, None], [None, None, 4318752, 4309040], [None, 4312176, None, None], [4312048, 4312336, 4318896, None], [4312176, 4312496, None, 4309200], [4312336, 4312624, None, 4309360], [4312496, 4312784, None, 4309520], [4312624, 4312928, None, None], [4312784, 4313088, None, None], [4312928, 4313248, None, None], [4313088, 4313408, None, None], [4313248, 4313568, None, None], [4313408, 4313712, None, None], [4313568, 4313872, 4319056, None], [4313712, 4314032, None, 4309680], [4313872, 4314192, 4319200, None], [4314032, 4314352, None, None], [4314192, 4314512, None, None], [4314352, 4314672, None, None], [4314512, 4314832, None, None], [4314672, 4314992, None, None], [4314832, 4315152, None, None], [4314992, 4315312, 4319328, None], [4315152, 4315472, None, 4309824], [4315312, 4315632, None, 4309984], [4315472, 4315792, 4319472, None], [4315632, 4315952, None, None], [4315792, 4316112, None, None], [4315952, 4316272, None, 4310144], [4316112, 4316432, None, 4310304], [4316272, 4316592, None, 4310464], [4316432, 4316736, 4319616, 4310624], [4316592, 4316896, None, 4310784], [4316736, 4317024, None, 4310944], [4316896, 4317184, None, 4311104], [4317024, 4317344, None, None], [4317184, 4317504, None, None], [4317344, 4317664, 4319760, None], [4317504, 4317824, None, 4311264], [4317664, 4317984, None, 4311424], [4317824, 4318112, None, 4311584], [4317984, 4318272, None, 4311744], [4318112, 4318432, None, None], [4318272, 4318592, None, None], [4318432, 4318752, None, None], [4318592, None, None, 4311888], [None, None, 4319920, 4312176], [None, None, None, 4313712], [None, None, None, 4314032], [None, None, None, 4315152], [None, None, None, 4315632], [None, None, 4320080, 4316592], [None, None, 4320240, 4317504], [None, None, 4321472, 4318896], [None, None, 4321600, 4319616], [None, 4320400, 4321760, 4319760], [4320240, 4320560, None, None], [4320400, 4320720, None, None], [4320560, 4320880, None, None], [4320720, 4321024, None, None], [4320880, 4321184, None, None], [4321024, 4321344, None, None], [4321184, None, None, None], [None, None, None, 4319920], [None, None, 4321904, 4320080], [None, None, None, 4320240], [None, None, None, 4321600]]len(func_list): 788len(all_edges): 788[4198480, 4198624, 4198784, 4198944, 4199104, 4199264, 4199424, 4199584, 4199744, 4199904, 4200064, 4200224, 4200384, 4200544, 4200688, 4200848, 4201008, 4201168, 4201312, 4201456, 4201616, 4201776, 4201936, 4202096, 4202240, 4202384, 4202544, 4202704, 4202848, 4203008, 4203168, 4203328, 4203488, 4203648, 4203808, 4203968, 4204128, 4204272, 4204432, 4204592, 4204752, 4204912, 4205056, 4205216, 4205376, 4205536, 4205680, 4205824, 4205984, 4206144, 4206304, 4206448, 4206608, 4206768, 4206928, 4207088, 4207232, 4207392, 4207552, 4207712, 4207872, 4208032, 4208192, 4208352, 4208496, 4208656, 4208816, 4208960, 4209120, 4209280, 4209440, 4209600, 4209760, 4209904, 4210064, 4210224, 4210368, 4210528, 4210688, 4210832, 4210992, 4211152, 4211312, 4211472, 4211632, 4211792, 4211952, 4212112, 4212272, 4212432, 4212592, 4212752, 4212912, 4213072, 4213232, 4213392, 4213552, 4213696, 4213856, 4214016, 4214176, 4214320, 4214480, 4214640, 4214800, 4214960, 4215120, 4215280, 4215440, 4215584, 4215744, 4215904, 4216064, 4216208, 4216352, 4216512, 4216672, 4216832, 4216992, 4217136, 4217296, 4217440, 4217600, 4217760, 4217920, 4218080, 4218240, 4218400, 4218560, 4218720, 4218880, 4219040, 4219200, 4219360, 4219520, 4219680, 4219840, 4219984, 4220144, 4220304, 4220464, 4220608, 4220768, 4220928, 4221088, 4221232, 4221392, 4221552, 4221712, 4221872, 4222032, 4222192, 4222352, 4222496, 4222640, 4222800, 4222928, 4223088, 4223248, 4223408, 4223568, 4223712, 4223856, 4224016, 4224176, 4224336, 4224496, 4224656, 4224816, 4224976, 4225120, 4225264, 4225424, 4225584, 4225744, 4225888, 4226048, 4226208, 4226368, 4226528, 4226688, 4226848, 4227008, 4227168, 4227328, 4227488, 4227648, 4227808, 4227968, 4228112, 4228272, 4228416, 4228576, 4228736, 4228896, 4229056, 4229216, 4229376, 4229520, 4229680, 4229840, 4229984, 4230144, 4230288, 4230448, 4230608, 4230768, 4230928, 4231088, 4231248, 4231408, 4231568, 4231728, 4231888, 4232048, 4232208, 4232368, 4232528, 4232672, 4232832, 4232992, 4233152, 4233312, 4233472, 4233616, 4233776, 4233920, 4234080, 4234240, 4234400, 4234560, 4234720, 4234880, 4235040, 4235200, 4235328, 4235488, 4235632, 4235792, 4235952, 4236112, 4236272, 4236432, 4236576, 4236736, 4236896, 4237056, 4237216, 4237376, 4237520, 4237664, 4237824, 4237984, 4238144, 4238304, 4238464, 4238624, 4238784, 4238944, 4239104, 4239264, 4239424, 4239584, 4239744, 4239904, 4240064, 4240224, 4240368, 4240528, 4240688, 4240848, 4241008, 4241168, 4241312, 4241456, 4241616, 4241776, 4241936, 4242096, 4242256, 4242416, 4242576, 4242736, 4242896, 4243040, 4243200, 4243360, 4243504, 4243664, 4243824, 4243984, 4244144, 4244288, 4244448, 4244608, 4244768, 4244928, 4245072, 4245232, 4245392, 4245536, 4245696, 4245840, 4246000, 4246160, 4246320, 4246480, 4246640, 4246800, 4246960, 4247120, 4247280, 4247440, 4247600, 4247744, 4247904, 4248064, 4248224, 4248384, 4248544, 4248704, 4248864, 4249024, 4249184, 4249344, 4249504, 4249664, 4249824, 4249984, 4250144, 4250304, 4250464, 4250624, 4250784, 4250944, 4251088, 4251248, 4251408, 4251568, 4251712, 4251872, 4252032, 4252192, 4252336, 4252496, 4252656, 4252816, 4252976, 4253136, 4253296, 4253456, 4253616, 4253776, 4253936, 4254096, 4254240, 4254400, 4254544, 4254704, 4254848, 4255008, 4255152, 4255312, 4255472, 4255616, 4255776, 4255936, 4256080, 4256240, 4256400, 4256560, 4256704, 4256848, 4257008, 4257152, 4257312, 4257472, 4257632, 4257760, 4257920, 4258080, 4258240, 4258400, 4258544, 4258704, 4258864, 4259024, 4259184, 4259344, 4259488, 4259648, 4259808, 4259968, 4260128, 4260288, 4260448, 4260592, 4260752, 4260912, 4261072, 4261232, 4261392, 4261552, 4261712, 4261872, 4262032, 4262176, 4262320, 4262480, 4262640, 4262800, 4262960, 4263120, 4263280, 4263440, 4263600, 4263760, 4263920, 4264080, 4264240, 4264400, 4264560, 4264720, 4264880, 4265040, 4265200, 4265344, 4265504, 4265648, 4265792, 4265952, 4266112, 4266272, 4266432, 4266592, 4266752, 4266912, 4267072, 4267232, 4267392, 4267552, 4267712, 4267872, 4268032, 4268192, 4268352, 4268496, 4268656, 4268816, 4268976, 4269136, 4269296, 4269456, 4269616, 4269760, 4269920, 4270080, 4270240, 4270400, 4270560, 4270720, 4270880, 4271040, 4271184, 4271328, 4271488, 4271648, 4271808, 4271968, 4272128, 4272288, 4272448, 4272608, 4272768, 4272928, 4273088, 4273248, 4273392, 4273552, 4273696, 4273840, 4274000, 4274160, 4274320, 4274480, 4274640, 4274800, 4274960, 4275120, 4275280, 4275440, 4275584, 4275744, 4275904, 4276064, 4276208, 4276368, 4276528, 4276688, 4276848, 4277008, 4277168, 4277328, 4277488, 4277648, 4277808, 4277968, 4278128, 4278288, 4278448, 4278608, 4278768, 4278928, 4279072, 4279216, 4279376, 4279536, 4279696, 4279840, 4280000, 4280160, 4280304, 4280464, 4280624, 4280784, 4280944, 4281088, 4281248, 4281408, 4281568, 4281728, 4281888, 4282048, 4282208, 4282352, 4282512, 4282656, 4282816, 4282976, 4283136, 4283296, 4283456, 4283616, 4283776, 4283936, 4284096, 4284256, 4284416, 4284576, 4284736, 4284896, 4285056, 4285216, 4285376, 4285536, 4285696, 4285856, 4286016, 4286176, 4286336, 4286496, 4286656, 4286816, 4286976, 4287120, 4287264, 4287424, 4287584, 4287744, 4287904, 4288064, 4288224, 4288384, 4288528, 4288688, 4288848, 4288992, 4289152, 4289312, 4289472, 4289632, 4289792, 4289952, 4290112, 4290272, 4290432, 4290592, 4290752, 4290912, 4291072, 4291232, 4291376, 4291536, 4291696, 4291856, 4292000, 4292144, 4292288, 4292448, 4292608, 4292768, 4292928, 4293088, 4293248, 4293392, 4293552, 4293696, 4293856, 4294016, 4294160, 4294320, 4294480, 4294640, 4294800, 4294944, 4295088, 4295232, 4295392, 4295552, 4295696, 4295856, 4296016, 4296176, 4296336, 4296496, 4296656, 4296816, 4296976, 4297136, 4297296, 4297424, 4297584, 4297744, 4297904, 4298064, 4298224, 4298384, 4298528, 4298688, 4298848, 4299008, 4299168, 4299312, 4299472, 4299632, 4299792, 4299936, 4300096, 4300256, 4300416, 4300576, 4300720, 4300864, 4301024, 4301184, 4301344, 4301504, 4301648, 4301808, 4301968, 4302128, 4302288, 4302448, 4302608, 4302768, 4302912, 4303072, 4303232, 4303392, 4303552, 4303712, 4303872, 4304032, 4304192, 4304352, 4304496, 4304656, 4304816, 4304976, 4305136, 4305296, 4305456, 4305616, 4305776, 4305936, 4306096, 4306256, 4306400, 4306560, 4306720, 4306880, 4307024, 4307184, 4307344, 4307504, 4307664, 4307808, 4307968, 4308128, 4308288, 4308448, 4308576, 4308720, 4308880, 4309040, 4309200, 4309360, 4309520, 4309680, 4309824, 4309984, 4310144, 4310304, 4310464, 4310624, 4310784, 4310944, 4311104, 4311264, 4311424, 4311584, 4311744, 4311888, 4312048, 4312176, 4312336, 4312496, 4312624, 4312784, 4312928, 4313088, 4313248, 4313408, 4313568, 4313712, 4313872, 4314032, 4314192, 4314352, 4314512, 4314672, 4314832, 4314992, 4315152, 4315312, 4315472, 4315632, 4315792, 4315952, 4316112, 4316272, 4316432, 4316592, 4316736, 4316896, 4317024, 4317184, 4317344, 4317504, 4317664, 4317824, 4317984, 4318112, 4318272, 4318432, 4318592, 4318752, 4318896, 4319056, 4319200, 4319328, 4319472, 4319616, 4319760, 4319920, 4320080, 4320240, 4320400, 4320560, 4320720, 4320880, 4321024, 4321184, 4321344, 4321472, 4321600, 4321760, 4321904] å¯¹äºIDAPythonç®€å•å‡½æ•°çš„å­¦ä¹ ï¼Œå¯ä»¥å‚è€ƒ https://zzzzsky.com/2021/12/08/LearnIDAPython/ è‡³æ­¤ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œä»¥åŠæ¯ä¸ªèŠ‚ç‚¹å¯¹åº”çš„adswå¯¹åº”çš„4ä¸ªå€¼ï¼Œå¦‚æœä¸ºNoneè¯´æ˜ä¸é€šï¼Œå¦‚æœä¸ä¸ºNoneï¼Œè¯´æ˜æ˜¯è¿›å…¥çš„å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥æ„é€ ä¸€æ¡è¾¹ networkxæ±‚æœ€çŸ­è·¯å¾„å†™pythonè„šæœ¬ 123456789101112131415161718192021222324252627282930313233343536373839404142434445import networkx as nximport hashliball_edges = [[None, 4198624, None, None], [4198480, None, 4198784, None], [None, None, 4207712, 4198624], [None, 4199104, 4211312, None], [4198944, 4199264, None, None], [4199104, 4199424, None, None], [4199264, 4199584, None, None], [4199424, 4199744, None, None], [4199584, 4199904, 4211472, None], [4199744, 4200064, None, None], [4199904, 4200224, None, None], [4200064, 4200384, None, None], [4200224, 4200544, None, None], [4200384, 4200688, None, None], [4200544, 4200848, None, None], [4200688, 4201008, None, None], [4200848, 4201168, None, None], [4201008, 4201312, None, None], [4201168, 4201456, None, None], [4201312, 4201616, None, None], [4201456, 4201776, None, None], [4201616, 4201936, None, None], [4201776, 4202096, None, None], [4201936, 4202240, None, None], [4202096, 4202384, None, None], [4202240, 4202544, None, None], [4202384, 4202704, None, None], [4202544, 4202848, None, None], [4202704, 4203008, None, None], [4202848, 4203168, None, None], [4203008, 4203328, None, None], [4203168, 4203488, None, None], [4203328, 4203648, None, None], [4203488, 4203808, None, None], [4203648, 4203968, None, None], [4203808, 4204128, None, None], [4203968, 4204272, None, None], [4204128, 4204432, None, None], [4204272, 4204592, None, None], [4204432, 4204752, None, None], [4204592, 4204912, None, None], [4204752, 4205056, None, None], [4204912, 4205216, None, None], [4205056, 4205376, None, None], [4205216, 4205536, None, None], [4205376, None, 4211632, None], [None, 4205824, 4211792, None], [4205680, 4205984, None, None], [4205824, 4206144, None, None], [4205984, 4206304, None, None], [4206144, 4206448, None, None], [4206304, 4206608, None, None], [4206448, 4206768, None, None], [4206608, 4206928, None, None], [4206768, 4207088, None, None], [4206928, 4207232, None, None], [4207088, 4207392, None, None], [4207232, 4207552, None, None], [4207392, None, 4211952, None], [None, 4207872, None, 4198784], [4207712, 4208032, None, None], [4207872, 4208192, None, None], [4208032, 4208352, None, None], [4208192, 4208496, None, None], [4208352, 4208656, None, None], [4208496, 4208816, None, None], [4208656, 4208960, None, None], [4208816, 4209120, 4212112, None], [4208960, 4209280, None, None], [4209120, 4209440, None, None], [4209280, 4209600, None, None], [4209440, 4209760, None, None], [4209600, 4209904, None, None], [4209760, 4210064, None, None], [4209904, 4210224, None, None], [4210064, 4210368, None, None], [4210224, 4210528, None, None], [4210368, 4210688, 4212272, None], [4210528, 4210832, None, None], [4210688, 4210992, None, None], [4210832, 4211152, None, None], [4210992, 4211312, None, None], [4211152, None, None, 4198944], [None, None, 4212432, 4199744], [None, None, 4216832, 4205536], [None, None, 4216992, 4205680], [None, None, 4217136, 4207552], [None, None, 4218240, 4208960], [None, None, 4218400, 4210528], [None, None, 4218560, 4211472], [None, 4212752, 4218720, None], [4212592, 4212912, None, None], [4212752, 4213072, None, None], [4212912, 4213232, None, None], [4213072, 4213392, None, None], [4213232, 4213552, None, None], [4213392, 4213696, None, None], [4213552, 4213856, None, None], [4213696, 4214016, None, None], [4213856, 4214176, None, None], [4214016, 4214320, None, None], [4214176, 4214480, None, None], [4214320, 4214640, None, None], [4214480, 4214800, None, None], [4214640, 4214960, None, None], [4214800, 4215120, None, None], [4214960, 4215280, None, None], [4215120, 4215440, None, None], [4215280, 4215584, None, None], [4215440, 4215744, None, None], [4215584, 4215904, None, None], [4215744, 4216064, None, None], [4215904, 4216208, None, None], [4216064, 4216352, None, None], [4216208, 4216512, None, None], [4216352, 4216672, None, None], [4216512, None, 4218880, None], [None, None, 4219040, 4211632], [None, None, 4219200, 4211792], [None, None, 4219360, 4211952], [None, 4217440, 4219520, None], [4217296, 4217600, None, None], [4217440, 4217760, None, None], [4217600, 4217920, None, None], [4217760, 4218080, None, None], [4217920, None, 4219680, None], [None, None, 4219840, 4212112], [None, None, 4219984, 4212272], [None, None, 4220144, 4212432], [None, None, 4220304, 4212592], [None, None, 4220464, 4216672], [None, None, 4220608, 4216832], [None, None, 4220768, 4216992], [None, None, 4222032, 4217136], [None, None, 4222192, 4217296], [None, None, 4222352, 4218080], [None, None, 4222496, 4218240], [None, None, 4222640, 4218400], [None, None, 4223248, 4218560], [None, None, 4223856, 4218720], [None, None, 4225584, 4218880], [None, None, 4225744, 4219040], [None, 4220928, None, 4219200], [4220768, 4221088, None, None], [4220928, 4221232, None, None], [4221088, 4221392, None, None], [4221232, 4221552, None, None], [4221392, 4221712, None, None], [4221552, 4221872, None, None], [4221712, None, 4225888, None], [None, None, 4226048, 4219360], [None, None, 4226208, 4219520], [None, None, 4226688, 4219680], [None, None, 4227008, 4219840], [None, None, 4227168, 4219984], [None, 4222928, None, None], [4222800, 4223088, None, None], [4222928, 4223248, None, None], [4223088, 4223408, None, 4220144], [4223248, 4223568, None, None], [4223408, 4223712, None, None], [4223568, None, None, None], [None, None, 4227328, 4220304], [None, 4224176, 4227488, None], [4224016, 4224336, None, None], [4224176, 4224496, None, None], [4224336, 4224656, None, None], [4224496, 4224816, None, None], [4224656, 4224976, None, None], [4224816, 4225120, None, None], [4224976, 4225264, None, None], [4225120, 4225424, None, None], [4225264, None, 4227648, None], [None, None, 4227808, 4220464], [None, None, 4227968, 4220608], [None, None, 4228112, 4221872], [None, None, 4228272, 4222032], [None, None, 4228576, 4222192], [None, 4226528, 4228736, None], [4226368, 4226688, None, None], [4226528, None, None, 4222352], [None, 4227008, 4228896, None], [4226848, None, None, 4222496], [None, None, 4229056, 4222640], [None, None, 4229680, 4223856], [None, None, 4229840, 4224016], [None, None, 4230928, 4225424], [None, None, 4231088, 4225584], [None, None, 4231248, 4225744], [None, None, 4232208, 4225888], [None, 4228416, None, 4226048], [4228272, None, 4232368, None], [None, None, 4232672, 4226208], [None, None, 4232832, 4226368], [None, None, 4232992, 4226848], [None, None, 4233152, 4227168], [None, 4229376, 4233312, None], [4229216, 4229520, None, None], [4229376, 4229680, None, None], [4229520, None, None, 4227328], [None, 4229984, None, 4227488], [4229840, 4230144, None, None], [4229984, 4230288, None, None], [4230144, 4230448, None, None], [4230288, 4230608, None, None], [4230448, 4230768, None, None], [4230608, None, 4233472, None], [None, None, 4233616, 4227648], [None, None, 4233776, 4227808], [None, None, 4233920, 4227968], [None, 4231568, 4234080, None], [4231408, 4231728, None, None], [4231568, 4231888, None, None], [4231728, 4232048, None, None], [4231888, None, 4234240, None], [None, None, 4234400, 4228112], [None, 4232528, None, 4228416], [4232368, None, 4234560, None], [None, None, 4234880, 4228576], [None, None, 4235328, 4228736], [None, None, 4235792, 4228896], [None, None, 4236576, 4229056], [None, None, 4236736, 4229216], [None, None, 4238784, 4230768], [None, None, 4238944, 4230928], [None, None, 4239104, 4231088], [None, None, 4239264, 4231248], [None, None, 4239424, 4231408], [None, None, 4239584, 4232048], [None, None, 4239744, 4232208], [None, 4234720, None, 4232528], [4234560, None, 4239904, None], [None, 4235040, None, 4232672], [4234880, 4235200, None, None], [4235040, 4235328, None, None], [4235200, None, 4240064, 4232832], [None, 4235632, 4240368, None], [4235488, 4235792, None, None], [4235632, 4235952, None, 4232992], [4235792, 4236112, None, None], [4235952, 4236272, None, None], [4236112, 4236432, None, None], [4236272, None, None, None], [None, None, 4240528, 4233152], [None, 4236896, None, 4233312], [4236736, 4237056, None, None], [4236896, 4237216, None, None], [4237056, 4237376, None, None], [4237216, 4237520, None, None], [4237376, 4237664, None, None], [4237520, 4237824, None, None], [4237664, 4237984, None, None], [4237824, 4238144, None, None], [4237984, 4238304, None, None], [4238144, 4238464, None, None], [4238304, 4238624, None, None], [4238464, 4238784, None, None], [4238624, None, None, 4233472], [None, None, 4240688, 4233616], [None, None, 4240848, 4233776], [None, None, 4241008, 4233920], [None, None, 4241168, 4234080], [None, None, 4241312, 4234240], [None, None, 4241456, 4234400], [None, None, 4241616, 4234720], [None, 4240224, None, 4235328], [4240064, 4240368, None, None], [4240224, None, None, 4235488], [None, None, 4241776, 4236576], [None, None, 4246640, 4238944], [None, None, 4246800, 4239104], [None, None, 4246960, 4239264], [None, None, 4247120, 4239424], [None, None, 4247280, 4239584], [None, None, 4247440, 4239744], [None, None, 4247904, 4239904], [None, 4241936, None, 4240528], [4241776, 4242096, None, None], [4241936, 4242256, None, None], [4242096, 4242416, None, None], [4242256, 4242576, None, None], [4242416, 4242736, None, None], [4242576, 4242896, None, None], [4242736, 4243040, None, None], [4242896, 4243200, None, None], [4243040, 4243360, None, None], [4243200, 4243504, None, None], [4243360, 4243664, None, None], [4243504, 4243824, None, None], [4243664, 4243984, None, None], [4243824, 4244144, None, None], [4243984, 4244288, None, None], [4244144, 4244448, None, None], [4244288, 4244608, None, None], [4244448, 4244768, None, None], [4244608, 4244928, None, None], [4244768, 4245072, None, None], [4244928, 4245232, None, None], [4245072, 4245392, None, None], [4245232, 4245536, None, None], [4245392, 4245696, None, None], [4245536, 4245840, None, None], [4245696, 4246000, None, None], [4245840, 4246160, None, None], [4246000, 4246320, None, None], [4246160, 4246480, None, None], [4246320, 4246640, None, None], [4246480, None, None, 4240688], [None, None, 4248064, 4240848], [None, None, 4248224, 4241008], [None, None, 4248384, 4241168], [None, None, 4248544, 4241312], [None, None, 4248704, 4241456], [None, None, 4248864, None], [None, 4247904, 4249184, None], [4247744, None, None, 4241616], [None, None, 4257312, 4246800], [None, None, 4257472, 4246960], [None, None, 4257632, 4247120], [None, None, 4257760, 4247280], [None, None, 4257920, 4247440], [None, 4249024, 4258080, 4247600], [4248864, 4249184, None, None], [4249024, None, None, 4247744], [None, 4249504, 4258240, None], [4249344, 4249664, None, None], [4249504, 4249824, None, None], [4249664, 4249984, None, None], [4249824, 4250144, None, None], [4249984, 4250304, None, None], [4250144, 4250464, None, None], [4250304, 4250624, None, None], [4250464, 4250784, None, None], [4250624, 4250944, None, None], [4250784, 4251088, None, None], [4250944, 4251248, None, None], [4251088, 4251408, None, None], [4251248, 4251568, None, None], [4251408, 4251712, None, None], [4251568, 4251872, None, None], [4251712, 4252032, None, None], [4251872, 4252192, None, None], [4252032, 4252336, None, None], [4252192, 4252496, None, None], [4252336, 4252656, None, None], [4252496, 4252816, None, None], [4252656, 4252976, None, None], [4252816, 4253136, None, None], [4252976, 4253296, None, None], [4253136, 4253456, None, None], [4253296, 4253616, None, None], [4253456, 4253776, None, None], [4253616, 4253936, None, None], [4253776, 4254096, None, None], [4253936, 4254240, None, None], [4254096, 4254400, None, None], [4254240, 4254544, None, None], [4254400, 4254704, None, None], [4254544, 4254848, None, None], [4254704, 4255008, None, None], [4254848, 4255152, None, None], [4255008, 4255312, None, None], [4255152, 4255472, None, None], [4255312, 4255616, None, None], [4255472, 4255776, None, None], [4255616, 4255936, None, None], [4255776, 4256080, None, None], [4255936, 4256240, None, None], [4256080, 4256400, None, None], [4256240, 4256560, None, None], [4256400, 4256704, None, None], [4256560, 4256848, None, None], [4256704, 4257008, None, None], [4256848, 4257152, None, None], [4257008, None, 4258400, None], [None, None, 4258544, 4248064], [None, None, 4258704, 4248224], [None, None, None, 4248384], [None, None, 4258864, 4248544], [None, None, 4259024, 4248704], [None, None, 4259184, 4248864], [None, None, 4259344, 4249344], [None, None, 4263760, 4257152], [None, None, 4263920, 4257312], [None, None, 4264080, 4257472], [None, None, 4265200, 4257760], [None, None, 4265344, 4257920], [None, None, 4265504, 4258080], [None, None, 4265648, 4258240], [None, 4259648, 4265792, None], [4259488, 4259808, None, None], [4259648, 4259968, None, None], [4259808, 4260128, None, None], [4259968, None, 4265952, None], [None, 4260448, 4266112, None], [4260288, 4260592, None, None], [4260448, 4260752, None, None], [4260592, 4260912, None, None], [4260752, 4261072, None, None], [4260912, 4261232, None, None], [4261072, 4261392, None, None], [4261232, 4261552, None, None], [4261392, 4261712, None, None], [4261552, 4261872, None, None], [4261712, 4262032, None, None], [4261872, 4262176, None, None], [4262032, 4262320, None, None], [4262176, 4262480, None, None], [4262320, 4262640, None, None], [4262480, 4262800, None, None], [4262640, 4262960, None, None], [4262800, 4263120, None, None], [4262960, 4263280, None, None], [4263120, 4263440, None, None], [4263280, 4263600, None, None], [4263440, None, 4266272, None], [None, None, 4268496, 4258400], [None, None, 4268656, 4258544], [None, 4264240, None, 4258704], [4264080, 4264400, None, None], [4264240, 4264560, None, None], [4264400, 4264720, None, None], [4264560, 4264880, None, None], [4264720, 4265040, None, None], [4264880, 4265200, None, None], [4265040, None, None, 4258864], [None, None, 4268816, 4259024], [None, None, 4268976, 4259184], [None, None, 4269136, 4259344], [None, None, 4269296, 4259488], [None, None, 4269456, 4260128], [None, None, 4269616, 4260288], [None, 4266432, None, 4263600], [4266272, 4266592, None, None], [4266432, 4266752, None, None], [4266592, 4266912, None, None], [4266752, 4267072, None, None], [4266912, 4267232, None, None], [4267072, 4267392, None, None], [4267232, 4267552, None, None], [4267392, 4267712, None, None], [4267552, 4267872, None, None], [4267712, 4268032, None, None], [4267872, 4268192, None, None], [4268032, 4268352, None, None], [4268192, 4268496, None, None], [4268352, None, None, 4263760], [None, None, 4269760, 4263920], [None, None, 4272288, 4265344], [None, None, 4272448, 4265504], [None, None, 4272608, 4265648], [None, None, 4273392, 4265792], [None, None, 4273552, 4265952], [None, None, 4273696, 4266112], [None, 4269920, None, 4268656], [4269760, 4270080, None, None], [4269920, 4270240, None, None], [4270080, 4270400, None, None], [4270240, 4270560, None, None], [4270400, 4270720, None, None], [4270560, 4270880, None, None], [4270720, 4271040, None, None], [4270880, 4271184, None, None], [4271040, 4271328, None, None], [4271184, 4271488, None, None], [4271328, 4271648, None, None], [4271488, 4271808, None, None], [4271648, 4271968, None, None], [4271808, 4272128, None, None], [4271968, 4272288, None, None], [4272128, None, None, 4268816], [None, None, 4274480, 4268976], [None, 4272768, None, 4269136], [4272608, 4272928, None, None], [4272768, 4273088, None, None], [4272928, 4273248, None, None], [4273088, 4273392, None, None], [4273248, None, None, 4269296], [None, None, 4274640, 4269456], [None, None, 4274800, 4269616], [None, 4274000, 4277808, None], [4273840, 4274160, None, None], [4274000, 4274320, None, None], [4274160, None, 4277968, None], [None, None, 4284896, 4272448], [None, None, 4286496, 4273552], [None, 4274960, None, 4273696], [4274800, 4275120, None, None], [4274960, 4275280, None, None], [4275120, 4275440, None, None], [4275280, 4275584, None, None], [4275440, 4275744, None, None], [4275584, 4275904, None, None], [4275744, 4276064, None, None], [4275904, 4276208, None, None], [4276064, 4276368, None, None], [4276208, 4276528, None, None], [4276368, 4276688, None, None], [4276528, 4276848, None, None], [4276688, 4277008, None, None], [4276848, 4277168, None, None], [4277008, 4277328, None, None], [4277168, 4277488, None, None], [4277328, 4277648, None, None], [4277488, 4277808, None, None], [4277648, None, None, 4273840], [None, 4278128, None, 4274320], [4277968, 4278288, None, None], [4278128, 4278448, None, None], [4278288, 4278608, None, None], [4278448, 4278768, None, None], [4278608, 4278928, None, None], [4278768, 4279072, None, None], [4278928, 4279216, None, None], [4279072, 4279376, None, None], [4279216, 4279536, None, None], [4279376, 4279696, None, None], [4279536, 4279840, None, None], [4279696, 4280000, None, None], [4279840, 4280160, None, None], [4280000, 4280304, None, None], [4280160, 4280464, None, None], [4280304, 4280624, None, None], [4280464, 4280784, None, None], [4280624, 4280944, None, None], [4280784, 4281088, None, None], [4280944, 4281248, None, None], [4281088, 4281408, None, None], [4281248, 4281568, None, None], [4281408, 4281728, None, None], [4281568, 4281888, None, None], [4281728, 4282048, None, None], [4281888, 4282208, None, None], [4282048, 4282352, None, None], [4282208, 4282512, None, None], [4282352, 4282656, None, None], [4282512, 4282816, None, None], [4282656, 4282976, None, None], [4282816, 4283136, None, None], [4282976, 4283296, None, None], [4283136, 4283456, None, None], [4283296, 4283616, None, None], [4283456, 4283776, None, None], [4283616, 4283936, None, None], [4283776, 4284096, None, None], [4283936, 4284256, None, None], [4284096, 4284416, None, None], [4284256, 4284576, None, None], [4284416, 4284736, None, None], [4284576, 4284896, None, None], [4284736, None, None, 4274480], [None, 4285216, 4286656, None], [4285056, 4285376, None, None], [4285216, 4285536, None, None], [4285376, 4285696, None, None], [4285536, 4285856, None, None], [4285696, 4286016, None, None], [4285856, 4286176, None, None], [4286016, 4286336, None, None], [4286176, 4286496, None, None], [4286336, None, None, 4274640], [None, None, 4296976, 4285056], [None, 4286976, 4297136, None], [4286816, 4287120, None, None], [4286976, 4287264, None, None], [4287120, 4287424, None, None], [4287264, 4287584, None, None], [4287424, 4287744, None, None], [4287584, 4287904, None, None], [4287744, 4288064, None, None], [4287904, 4288224, None, None], [4288064, 4288384, None, None], [4288224, 4288528, None, None], [4288384, 4288688, None, None], [4288528, 4288848, None, None], [4288688, 4288992, None, None], [4288848, 4289152, None, None], [4288992, 4289312, None, None], [4289152, 4289472, None, None], [4289312, 4289632, None, None], [4289472, 4289792, None, None], [4289632, 4289952, None, None], [4289792, 4290112, None, None], [4289952, 4290272, None, None], [4290112, 4290432, None, None], [4290272, 4290592, None, None], [4290432, 4290752, None, None], [4290592, 4290912, None, None], [4290752, 4291072, None, None], [4290912, 4291232, None, None], [4291072, 4291376, None, None], [4291232, 4291536, None, None], [4291376, 4291696, None, None], [4291536, 4291856, None, None], [4291696, 4292000, None, None], [4291856, 4292144, None, None], [4292000, 4292288, None, None], [4292144, 4292448, None, None], [4292288, 4292608, None, None], [4292448, 4292768, None, None], [4292608, 4292928, None, None], [4292768, 4293088, None, None], [4292928, 4293248, None, None], [4293088, 4293392, None, None], [4293248, 4293552, None, None], [4293392, 4293696, None, None], [4293552, 4293856, None, None], [4293696, 4294016, None, None], [4293856, 4294160, None, None], [4294016, 4294320, None, None], [4294160, 4294480, 4297296, None], [4294320, 4294640, None, None], [4294480, 4294800, None, None], [4294640, 4294944, None, None], [4294800, 4295088, None, None], [4294944, 4295232, None, None], [4295088, 4295392, None, None], [4295232, 4295552, None, None], [4295392, 4295696, None, None], [4295552, 4295856, None, None], [4295696, 4296016, None, None], [4295856, 4296176, None, None], [4296016, 4296336, None, None], [4296176, 4296496, None, None], [4296336, 4296656, None, None], [4296496, 4296816, None, None], [4296656, None, 4297424, None], [None, None, 4297584, 4286656], [None, None, 4297744, 4286816], [None, None, 4297904, 4294320], [None, None, 4299472, 4296816], [None, None, 4300720, 4296976], [None, None, 4302288, 4297136], [None, None, 4308576, 4297296], [None, 4298224, 4308720, None], [4298064, 4298384, None, None], [4298224, 4298528, None, None], [4298384, 4298688, None, None], [4298528, 4298848, None, None], [4298688, 4299008, None, None], [4298848, 4299168, None, None], [4299008, 4299312, None, None], [4299168, 4299472, None, None], [4299312, 4299632, None, 4297424], [4299472, 4299792, None, None], [4299632, 4299936, None, None], [4299792, 4300096, None, None], [4299936, 4300256, None, None], [4300096, 4300416, None, None], [4300256, 4300576, None, None], [4300416, None, None, None], [None, 4300864, None, 4297584], [4300720, 4301024, None, None], [4300864, 4301184, None, None], [4301024, 4301344, None, None], [4301184, 4301504, None, None], [4301344, 4301648, None, None], [4301504, 4301808, None, None], [4301648, 4301968, None, None], [4301808, 4302128, None, None], [4301968, 4302288, None, None], [4302128, 4302448, None, 4297744], [4302288, 4302608, None, None], [4302448, 4302768, None, None], [4302608, 4302912, None, None], [4302768, 4303072, None, None], [4302912, 4303232, None, None], [4303072, 4303392, None, None], [4303232, 4303552, None, None], [4303392, 4303712, None, None], [4303552, 4303872, None, None], [4303712, 4304032, None, None], [4303872, 4304192, None, None], [4304032, 4304352, None, None], [4304192, 4304496, None, None], [4304352, 4304656, None, None], [4304496, 4304816, None, None], [4304656, 4304976, None, None], [4304816, 4305136, None, None], [4304976, 4305296, None, None], [4305136, 4305456, None, None], [4305296, 4305616, None, None], [4305456, 4305776, None, None], [4305616, 4305936, None, None], [4305776, 4306096, None, None], [4305936, 4306256, None, None], [4306096, 4306400, None, None], [4306256, 4306560, None, None], [4306400, 4306720, None, None], [4306560, 4306880, None, None], [4306720, 4307024, None, None], [4306880, 4307184, None, None], [4307024, 4307344, None, None], [4307184, 4307504, None, None], [4307344, 4307664, None, None], [4307504, 4307808, None, None], [4307664, 4307968, None, None], [4307808, 4308128, None, None], [4307968, 4308288, None, None], [4308128, 4308448, None, None], [4308288, None, None, None], [None, None, 4308880, 4297904], [None, None, 4309040, 4298064], [None, None, 4311264, 4308576], [None, None, 4311888, 4308720], [None, 4309360, 4312336, None], [4309200, 4309520, 4312496, None], [4309360, None, 4312624, None], [None, None, 4313872, None], [None, 4309984, 4315312, None], [4309824, None, 4315472, None], [None, 4310304, 4316112, None], [4310144, 4310464, 4316272, None], [4310304, 4310624, 4316432, None], [4310464, 4310784, 4316592, None], [4310624, 4310944, 4316736, None], [4310784, 4311104, 4316896, None], [4310944, None, 4317024, None], [None, 4311424, 4317664, 4308880], [4311264, 4311584, 4317824, None], [4311424, 4311744, 4317984, None], [4311584, None, 4318112, None], [None, None, 4318752, 4309040], [None, 4312176, None, None], [4312048, 4312336, 4318896, None], [4312176, 4312496, None, 4309200], [4312336, 4312624, None, 4309360], [4312496, 4312784, None, 4309520], [4312624, 4312928, None, None], [4312784, 4313088, None, None], [4312928, 4313248, None, None], [4313088, 4313408, None, None], [4313248, 4313568, None, None], [4313408, 4313712, None, None], [4313568, 4313872, 4319056, None], [4313712, 4314032, None, 4309680], [4313872, 4314192, 4319200, None], [4314032, 4314352, None, None], [4314192, 4314512, None, None], [4314352, 4314672, None, None], [4314512, 4314832, None, None], [4314672, 4314992, None, None], [4314832, 4315152, None, None], [4314992, 4315312, 4319328, None], [4315152, 4315472, None, 4309824], [4315312, 4315632, None, 4309984], [4315472, 4315792, 4319472, None], [4315632, 4315952, None, None], [4315792, 4316112, None, None], [4315952, 4316272, None, 4310144], [4316112, 4316432, None, 4310304], [4316272, 4316592, None, 4310464], [4316432, 4316736, 4319616, 4310624], [4316592, 4316896, None, 4310784], [4316736, 4317024, None, 4310944], [4316896, 4317184, None, 4311104], [4317024, 4317344, None, None], [4317184, 4317504, None, None], [4317344, 4317664, 4319760, None], [4317504, 4317824, None, 4311264], [4317664, 4317984, None, 4311424], [4317824, 4318112, None, 4311584], [4317984, 4318272, None, 4311744], [4318112, 4318432, None, None], [4318272, 4318592, None, None], [4318432, 4318752, None, None], [4318592, None, None, 4311888], [None, None, 4319920, 4312176], [None, None, None, 4313712], [None, None, None, 4314032], [None, None, None, 4315152], [None, None, None, 4315632], [None, None, 4320080, 4316592], [None, None, 4320240, 4317504], [None, None, 4321472, 4318896], [None, None, 4321600, 4319616], [None, 4320400, 4321760, 4319760], [4320240, 4320560, None, None], [4320400, 4320720, None, None], [4320560, 4320880, None, None], [4320720, 4321024, None, None], [4320880, 4321184, None, None], [4321024, 4321344, None, None], [4321184, None, None, None], [None, None, None, 4319920], [None, None, 4321904, 4320080], [None, None, None, 4320240], [None, None, None, 4321600]]func_list = [4198480, 4198624, 4198784, 4198944, 4199104, 4199264, 4199424, 4199584, 4199744, 4199904, 4200064, 4200224, 4200384, 4200544, 4200688, 4200848, 4201008, 4201168, 4201312, 4201456, 4201616, 4201776, 4201936, 4202096, 4202240, 4202384, 4202544, 4202704, 4202848, 4203008, 4203168, 4203328, 4203488, 4203648, 4203808, 4203968, 4204128, 4204272, 4204432, 4204592, 4204752, 4204912, 4205056, 4205216, 4205376, 4205536, 4205680, 4205824, 4205984, 4206144, 4206304, 4206448, 4206608, 4206768, 4206928, 4207088, 4207232, 4207392, 4207552, 4207712, 4207872, 4208032, 4208192, 4208352, 4208496, 4208656, 4208816, 4208960, 4209120, 4209280, 4209440, 4209600, 4209760, 4209904, 4210064, 4210224, 4210368, 4210528, 4210688, 4210832, 4210992, 4211152, 4211312, 4211472, 4211632, 4211792, 4211952, 4212112, 4212272, 4212432, 4212592, 4212752, 4212912, 4213072, 4213232, 4213392, 4213552, 4213696, 4213856, 4214016, 4214176, 4214320, 4214480, 4214640, 4214800, 4214960, 4215120, 4215280, 4215440, 4215584, 4215744, 4215904, 4216064, 4216208, 4216352, 4216512, 4216672, 4216832, 4216992, 4217136, 4217296, 4217440, 4217600, 4217760, 4217920, 4218080, 4218240, 4218400, 4218560, 4218720, 4218880, 4219040, 4219200, 4219360, 4219520, 4219680, 4219840, 4219984, 4220144, 4220304, 4220464, 4220608, 4220768, 4220928, 4221088, 4221232, 4221392, 4221552, 4221712, 4221872, 4222032, 4222192, 4222352, 4222496, 4222640, 4222800, 4222928, 4223088, 4223248, 4223408, 4223568, 4223712, 4223856, 4224016, 4224176, 4224336, 4224496, 4224656, 4224816, 4224976, 4225120, 4225264, 4225424, 4225584, 4225744, 4225888, 4226048, 4226208, 4226368, 4226528, 4226688, 4226848, 4227008, 4227168, 4227328, 4227488, 4227648, 4227808, 4227968, 4228112, 4228272, 4228416, 4228576, 4228736, 4228896, 4229056, 4229216, 4229376, 4229520, 4229680, 4229840, 4229984, 4230144, 4230288, 4230448, 4230608, 4230768, 4230928, 4231088, 4231248, 4231408, 4231568, 4231728, 4231888, 4232048, 4232208, 4232368, 4232528, 4232672, 4232832, 4232992, 4233152, 4233312, 4233472, 4233616, 4233776, 4233920, 4234080, 4234240, 4234400, 4234560, 4234720, 4234880, 4235040, 4235200, 4235328, 4235488, 4235632, 4235792, 4235952, 4236112, 4236272, 4236432, 4236576, 4236736, 4236896, 4237056, 4237216, 4237376, 4237520, 4237664, 4237824, 4237984, 4238144, 4238304, 4238464, 4238624, 4238784, 4238944, 4239104, 4239264, 4239424, 4239584, 4239744, 4239904, 4240064, 4240224, 4240368, 4240528, 4240688, 4240848, 4241008, 4241168, 4241312, 4241456, 4241616, 4241776, 4241936, 4242096, 4242256, 4242416, 4242576, 4242736, 4242896, 4243040, 4243200, 4243360, 4243504, 4243664, 4243824, 4243984, 4244144, 4244288, 4244448, 4244608, 4244768, 4244928, 4245072, 4245232, 4245392, 4245536, 4245696, 4245840, 4246000, 4246160, 4246320, 4246480, 4246640, 4246800, 4246960, 4247120, 4247280, 4247440, 4247600, 4247744, 4247904, 4248064, 4248224, 4248384, 4248544, 4248704, 4248864, 4249024, 4249184, 4249344, 4249504, 4249664, 4249824, 4249984, 4250144, 4250304, 4250464, 4250624, 4250784, 4250944, 4251088, 4251248, 4251408, 4251568, 4251712, 4251872, 4252032, 4252192, 4252336, 4252496, 4252656, 4252816, 4252976, 4253136, 4253296, 4253456, 4253616, 4253776, 4253936, 4254096, 4254240, 4254400, 4254544, 4254704, 4254848, 4255008, 4255152, 4255312, 4255472, 4255616, 4255776, 4255936, 4256080, 4256240, 4256400, 4256560, 4256704, 4256848, 4257008, 4257152, 4257312, 4257472, 4257632, 4257760, 4257920, 4258080, 4258240, 4258400, 4258544, 4258704, 4258864, 4259024, 4259184, 4259344, 4259488, 4259648, 4259808, 4259968, 4260128, 4260288, 4260448, 4260592, 4260752, 4260912, 4261072, 4261232, 4261392, 4261552, 4261712, 4261872, 4262032, 4262176, 4262320, 4262480, 4262640, 4262800, 4262960, 4263120, 4263280, 4263440, 4263600, 4263760, 4263920, 4264080, 4264240, 4264400, 4264560, 4264720, 4264880, 4265040, 4265200, 4265344, 4265504, 4265648, 4265792, 4265952, 4266112, 4266272, 4266432, 4266592, 4266752, 4266912, 4267072, 4267232, 4267392, 4267552, 4267712, 4267872, 4268032, 4268192, 4268352, 4268496, 4268656, 4268816, 4268976, 4269136, 4269296, 4269456, 4269616, 4269760, 4269920, 4270080, 4270240, 4270400, 4270560, 4270720, 4270880, 4271040, 4271184, 4271328, 4271488, 4271648, 4271808, 4271968, 4272128, 4272288, 4272448, 4272608, 4272768, 4272928, 4273088, 4273248, 4273392, 4273552, 4273696, 4273840, 4274000, 4274160, 4274320, 4274480, 4274640, 4274800, 4274960, 4275120, 4275280, 4275440, 4275584, 4275744, 4275904, 4276064, 4276208, 4276368, 4276528, 4276688, 4276848, 4277008, 4277168, 4277328, 4277488, 4277648, 4277808, 4277968, 4278128, 4278288, 4278448, 4278608, 4278768, 4278928, 4279072, 4279216, 4279376, 4279536, 4279696, 4279840, 4280000, 4280160, 4280304, 4280464, 4280624, 4280784, 4280944, 4281088, 4281248, 4281408, 4281568, 4281728, 4281888, 4282048, 4282208, 4282352, 4282512, 4282656, 4282816, 4282976, 4283136, 4283296, 4283456, 4283616, 4283776, 4283936, 4284096, 4284256, 4284416, 4284576, 4284736, 4284896, 4285056, 4285216, 4285376, 4285536, 4285696, 4285856, 4286016, 4286176, 4286336, 4286496, 4286656, 4286816, 4286976, 4287120, 4287264, 4287424, 4287584, 4287744, 4287904, 4288064, 4288224, 4288384, 4288528, 4288688, 4288848, 4288992, 4289152, 4289312, 4289472, 4289632, 4289792, 4289952, 4290112, 4290272, 4290432, 4290592, 4290752, 4290912, 4291072, 4291232, 4291376, 4291536, 4291696, 4291856, 4292000, 4292144, 4292288, 4292448, 4292608, 4292768, 4292928, 4293088, 4293248, 4293392, 4293552, 4293696, 4293856, 4294016, 4294160, 4294320, 4294480, 4294640, 4294800, 4294944, 4295088, 4295232, 4295392, 4295552, 4295696, 4295856, 4296016, 4296176, 4296336, 4296496, 4296656, 4296816, 4296976, 4297136, 4297296, 4297424, 4297584, 4297744, 4297904, 4298064, 4298224, 4298384, 4298528, 4298688, 4298848, 4299008, 4299168, 4299312, 4299472, 4299632, 4299792, 4299936, 4300096, 4300256, 4300416, 4300576, 4300720, 4300864, 4301024, 4301184, 4301344, 4301504, 4301648, 4301808, 4301968, 4302128, 4302288, 4302448, 4302608, 4302768, 4302912, 4303072, 4303232, 4303392, 4303552, 4303712, 4303872, 4304032, 4304192, 4304352, 4304496, 4304656, 4304816, 4304976, 4305136, 4305296, 4305456, 4305616, 4305776, 4305936, 4306096, 4306256, 4306400, 4306560, 4306720, 4306880, 4307024, 4307184, 4307344, 4307504, 4307664, 4307808, 4307968, 4308128, 4308288, 4308448, 4308576, 4308720, 4308880, 4309040, 4309200, 4309360, 4309520, 4309680, 4309824, 4309984, 4310144, 4310304, 4310464, 4310624, 4310784, 4310944, 4311104, 4311264, 4311424, 4311584, 4311744, 4311888, 4312048, 4312176, 4312336, 4312496, 4312624, 4312784, 4312928, 4313088, 4313248, 4313408, 4313568, 4313712, 4313872, 4314032, 4314192, 4314352, 4314512, 4314672, 4314832, 4314992, 4315152, 4315312, 4315472, 4315632, 4315792, 4315952, 4316112, 4316272, 4316432, 4316592, 4316736, 4316896, 4317024, 4317184, 4317344, 4317504, 4317664, 4317824, 4317984, 4318112, 4318272, 4318432, 4318592, 4318752, 4318896, 4319056, 4319200, 4319328, 4319472, 4319616, 4319760, 4319920, 4320080, 4320240, 4320400, 4320560, 4320720, 4320880, 4321024, 4321184, 4321344, 4321472, 4321600, 4321760, 4321904]src_node = 0x401050 # èµ·ç‚¹target_node = 0x41F1E0 # ç»ˆç‚¹G = nx.MultiDiGraph() # ç”Ÿæˆä¸€å¼ ç©ºå›¾ï¼ŒMulå…è®¸2ä¸ªèŠ‚ç‚¹ä¹‹é—´å­˜åœ¨å¤šä¸ªè¾¹ï¼ŒDiä»£è¡¨è¾¹æ˜¯æœ‰æ–¹å‘çš„for i in func_list: G.add_node(i) # æ·»åŠ èŠ‚ç‚¹for i, value in enumerate(all_edges): src = func_list[i] for j in value: if j != None: # ä¸ä¸ºNone,å°±å¯ä»¥æ„é€ ä¸€æ¡è¾¹ dst = j G.add_edge(src, dst)path = nx.shortest_path(G, source = src_node, target = target_node) # ç›´æ¥è°ƒç”¨æ­¤å‡½æ•°å°±å¯ä»¥æ±‚å‡ºæœ€çŸ­è·¯å¾„ç»è¿‡çš„é‚£å‡ ä¸ªèŠ‚ç‚¹print(len(path))print([hex(i) for i in path])s = &quot;&quot; for i in range(1, len(path)): # æ ¹æ®å¾—åˆ°çš„ç»“æœæ¥æ±‚å‡ºæ¯ä¸€æ­¥èµ°çš„æ–¹å‘ func_index = func_list.index(path[i - 1]) index = all_edges[func_index].index(path[i]) if index == 0: s += &#x27;a&#x27; elif index == 1: s += &#x27;d&#x27; elif index == 2: s += &#x27;s&#x27; else: s += &#x27;w&#x27;# æˆåŠŸçš„åœ°æ–¹åœ¨41F1E0å¤„# case &#x27;s&#x27;:# result = printf(&quot;Great!!!you got it!flag is DASCTF&#123;md5&#123;your input&#125;\\n&quot;);# break;input_ = s + &#x27;s&#x27;print(input_) # DASCTF&#123;md5&#123;your input&#125;\\n&quot;)print(&quot;DASCTF&#123;%s&#125;&quot; % hashlib.md5(input_.encode()).hexdigest())ã€ è¾“å‡º 1234496[&#x27;0x401050&#x27;, &#x27;0x4010e0&#x27;, &#x27;0x401180&#x27;, &#x27;0x403460&#x27;, &#x27;0x403500&#x27;, &#x27;0x4035a0&#x27;, &#x27;0x403640&#x27;, &#x27;0x4036e0&#x27;, &#x27;0x403770&#x27;, &#x27;0x403810&#x27;, &#x27;0x4038b0&#x27;, &#x27;0x403940&#x27;, &#x27;0x4039e0&#x27;, &#x27;0x403a80&#x27;, &#x27;0x403b20&#x27;, &#x27;0x403bc0&#x27;, &#x27;0x403c60&#x27;, &#x27;0x403cf0&#x27;, &#x27;0x403d90&#x27;, &#x27;0x403e30&#x27;, &#x27;0x403ec0&#x27;, &#x27;0x403f60&#x27;, &#x27;0x404630&#x27;, &#x27;0x405e20&#x27;, &#x27;0x406450&#x27;, &#x27;0x406eb0&#x27;, &#x27;0x408060&#x27;, &#x27;0x4087c0&#x27;, &#x27;0x4097c0&#x27;, &#x27;0x40a520&#x27;, &#x27;0x40b490&#x27;, &#x27;0x40b970&#x27;, &#x27;0x40ba10&#x27;, &#x27;0x40bab0&#x27;, &#x27;0x40bb50&#x27;, &#x27;0x40bbf0&#x27;, &#x27;0x40bc90&#x27;, &#x27;0x40bd30&#x27;, &#x27;0x40bdd0&#x27;, &#x27;0x40be60&#x27;, &#x27;0x40bf00&#x27;, &#x27;0x40bfa0&#x27;, &#x27;0x40c030&#x27;, &#x27;0x40c0d0&#x27;, &#x27;0x40c170&#x27;, &#x27;0x40c210&#x27;, &#x27;0x40c2b0&#x27;, &#x27;0x40c340&#x27;, &#x27;0x40c3e0&#x27;, &#x27;0x40c480&#x27;, &#x27;0x40c520&#x27;, &#x27;0x40c5c0&#x27;, &#x27;0x40c650&#x27;, &#x27;0x40c6f0&#x27;, &#x27;0x40c790&#x27;, &#x27;0x40c820&#x27;, &#x27;0x40c8c0&#x27;, &#x27;0x40c950&#x27;, &#x27;0x40c9f0&#x27;, &#x27;0x40ca90&#x27;, &#x27;0x40cb30&#x27;, &#x27;0x40cbd0&#x27;, &#x27;0x40cc70&#x27;, &#x27;0x40b530&#x27;, &#x27;0x40ae60&#x27;, &#x27;0x409990&#x27;, &#x27;0x408f10&#x27;, &#x27;0x408240&#x27;, &#x27;0x407990&#x27;, &#x27;0x4078f0&#x27;, &#x27;0x407860&#x27;, &#x27;0x4077d0&#x27;, &#x27;0x407730&#x27;, &#x27;0x407690&#x27;, &#x27;0x4075f0&#x27;, &#x27;0x407550&#x27;, &#x27;0x4074b0&#x27;, &#x27;0x407410&#x27;, &#x27;0x4081a0&#x27;, &#x27;0x408ad0&#x27;, &#x27;0x408b60&#x27;, &#x27;0x408c00&#x27;, &#x27;0x408c90&#x27;, &#x27;0x408d30&#x27;, &#x27;0x408dd0&#x27;, &#x27;0x408e70&#x27;, &#x27;0x409900&#x27;, &#x27;0x40adc0&#x27;, &#x27;0x40ad20&#x27;, &#x27;0x40ac80&#x27;, &#x27;0x40abe0&#x27;, &#x27;0x40ab40&#x27;, &#x27;0x40aaa0&#x27;, &#x27;0x40aa00&#x27;, &#x27;0x40a960&#x27;, &#x27;0x40a8d0&#x27;, &#x27;0x40a840&#x27;, &#x27;0x40a7a0&#x27;, &#x27;0x40a700&#x27;, &#x27;0x40a660&#x27;, &#x27;0x40a5c0&#x27;, &#x27;0x409860&#x27;, &#x27;0x408860&#x27;, &#x27;0x408900&#x27;, &#x27;0x408990&#x27;, &#x27;0x408a30&#x27;, &#x27;0x408100&#x27;, &#x27;0x407370&#x27;, &#x27;0x406590&#x27;, &#x27;0x405f60&#x27;, &#x27;0x404770&#x27;, &#x27;0x404810&#x27;, &#x27;0x4048b0&#x27;, &#x27;0x404950&#x27;, &#x27;0x4049f0&#x27;, &#x27;0x404a90&#x27;, &#x27;0x404b30&#x27;, &#x27;0x404bc0&#x27;, &#x27;0x404c60&#x27;, &#x27;0x404d00&#x27;, &#x27;0x404da0&#x27;, &#x27;0x404e30&#x27;, &#x27;0x404ed0&#x27;, &#x27;0x404f70&#x27;, &#x27;0x405010&#x27;, &#x27;0x4050b0&#x27;, &#x27;0x405150&#x27;, &#x27;0x4051f0&#x27;, &#x27;0x405290&#x27;, &#x27;0x405320&#x27;, &#x27;0x4053c0&#x27;, &#x27;0x405460&#x27;, &#x27;0x405500&#x27;, &#x27;0x405590&#x27;, &#x27;0x405620&#x27;, &#x27;0x4056c0&#x27;, &#x27;0x405760&#x27;, &#x27;0x406000&#x27;, &#x27;0x406630&#x27;, &#x27;0x407a30&#x27;, &#x27;0x4082e0&#x27;, &#x27;0x408fb0&#x27;, &#x27;0x409a30&#x27;, &#x27;0x40af00&#x27;, &#x27;0x40b5d0&#x27;, &#x27;0x40cd10&#x27;, &#x27;0x40d200&#x27;, &#x27;0x40f620&#x27;, &#x27;0x40faf0&#x27;, &#x27;0x410ff0&#x27;, &#x27;0x412270&#x27;, &#x27;0x4126c0&#x27;, &#x27;0x412760&#x27;, &#x27;0x412800&#x27;, &#x27;0x4128a0&#x27;, &#x27;0x412940&#x27;, &#x27;0x4129e0&#x27;, &#x27;0x412a80&#x27;, &#x27;0x412b20&#x27;, &#x27;0x412bc0&#x27;, &#x27;0x412c50&#x27;, &#x27;0x412ce0&#x27;, &#x27;0x412d80&#x27;, &#x27;0x412e20&#x27;, &#x27;0x412ec0&#x27;, &#x27;0x412f60&#x27;, &#x27;0x413000&#x27;, &#x27;0x4130a0&#x27;, &#x27;0x412310&#x27;, &#x27;0x411580&#x27;, &#x27;0x40fcd0&#x27;, &#x27;0x40f880&#x27;, &#x27;0x40d480&#x27;, &#x27;0x40cf90&#x27;, &#x27;0x40b830&#x27;, &#x27;0x40b180&#x27;, &#x27;0x409ca0&#x27;, &#x27;0x409410&#x27;, &#x27;0x408410&#x27;, &#x27;0x407b60&#x27;, &#x27;0x406bb0&#x27;, &#x27;0x406b10&#x27;, &#x27;0x406a70&#x27;, &#x27;0x4069d0&#x27;, &#x27;0x406930&#x27;, &#x27;0x4068a0&#x27;, &#x27;0x406800&#x27;, &#x27;0x406760&#x27;, &#x27;0x406140&#x27;, &#x27;0x4058a0&#x27;, &#x27;0x404450&#x27;, &#x27;0x402c70&#x27;, &#x27;0x402d00&#x27;, &#x27;0x402da0&#x27;, &#x27;0x402e40&#x27;, &#x27;0x402ee0&#x27;, &#x27;0x402f70&#x27;, &#x27;0x403010&#x27;, &#x27;0x4030b0&#x27;, &#x27;0x403150&#x27;, &#x27;0x4031f0&#x27;, &#x27;0x403280&#x27;, &#x27;0x403320&#x27;, &#x27;0x4033c0&#x27;, &#x27;0x4044f0&#x27;, &#x27;0x405930&#x27;, &#x27;0x4061e0&#x27;, &#x27;0x406c50&#x27;, &#x27;0x407c00&#x27;, &#x27;0x4084b0&#x27;, &#x27;0x408540&#x27;, &#x27;0x4094b0&#x27;, &#x27;0x409550&#x27;, &#x27;0x409d40&#x27;, &#x27;0x409de0&#x27;, &#x27;0x40b220&#x27;, &#x27;0x40b8d0&#x27;, &#x27;0x40d160&#x27;, &#x27;0x40d0c0&#x27;, &#x27;0x40d660&#x27;, &#x27;0x40d5c0&#x27;, &#x27;0x40d520&#x27;, &#x27;0x40f920&#x27;, &#x27;0x40fd70&#x27;, &#x27;0x411620&#x27;, &#x27;0x4123b0&#x27;, &#x27;0x413140&#x27;, &#x27;0x413930&#x27;, &#x27;0x4161e0&#x27;, &#x27;0x416140&#x27;, &#x27;0x4160a0&#x27;, &#x27;0x416000&#x27;, &#x27;0x415f60&#x27;, &#x27;0x415ec0&#x27;, &#x27;0x415e20&#x27;, &#x27;0x415d80&#x27;, &#x27;0x415ce0&#x27;, &#x27;0x415c40&#x27;, &#x27;0x415ba0&#x27;, &#x27;0x415b00&#x27;, &#x27;0x415a60&#x27;, &#x27;0x4159c0&#x27;, &#x27;0x415920&#x27;, &#x27;0x415890&#x27;, &#x27;0x4157f0&#x27;, &#x27;0x415760&#x27;, &#x27;0x4156c0&#x27;, &#x27;0x415620&#x27;, &#x27;0x415580&#x27;, &#x27;0x4154e0&#x27;, &#x27;0x415440&#x27;, &#x27;0x4153a0&#x27;, &#x27;0x415300&#x27;, &#x27;0x415270&#x27;, &#x27;0x4151d0&#x27;, &#x27;0x415130&#x27;, &#x27;0x415090&#x27;, &#x27;0x414ff0&#x27;, &#x27;0x414f60&#x27;, &#x27;0x414ec0&#x27;, &#x27;0x414e20&#x27;, &#x27;0x414d90&#x27;, &#x27;0x414cf0&#x27;, &#x27;0x414c50&#x27;, &#x27;0x414bb0&#x27;, &#x27;0x414b20&#x27;, &#x27;0x414a90&#x27;, &#x27;0x4149f0&#x27;, &#x27;0x414950&#x27;, &#x27;0x4148b0&#x27;, &#x27;0x414810&#x27;, &#x27;0x414770&#x27;, &#x27;0x4146d0&#x27;, &#x27;0x413890&#x27;, &#x27;0x4137f0&#x27;, &#x27;0x413750&#x27;, &#x27;0x4136b0&#x27;, &#x27;0x414630&#x27;, &#x27;0x414590&#x27;, &#x27;0x4144f0&#x27;, &#x27;0x414450&#x27;, &#x27;0x4143b0&#x27;, &#x27;0x414310&#x27;, &#x27;0x414270&#x27;, &#x27;0x4141d0&#x27;, &#x27;0x414130&#x27;, &#x27;0x414090&#x27;, &#x27;0x413ff0&#x27;, &#x27;0x413f60&#x27;, &#x27;0x413ec0&#x27;, &#x27;0x413e20&#x27;, &#x27;0x413d80&#x27;, &#x27;0x413cf0&#x27;, &#x27;0x413c50&#x27;, &#x27;0x413bb0&#x27;, &#x27;0x413b10&#x27;, &#x27;0x413a70&#x27;, &#x27;0x413620&#x27;, &#x27;0x412630&#x27;, &#x27;0x411880&#x27;, &#x27;0x4101c0&#x27;, &#x27;0x410260&#x27;, &#x27;0x4102f0&#x27;, &#x27;0x410390&#x27;, &#x27;0x410430&#x27;, &#x27;0x4104d0&#x27;, &#x27;0x410570&#x27;, &#x27;0x410610&#x27;, &#x27;0x4106b0&#x27;, &#x27;0x410750&#x27;, &#x27;0x4107f0&#x27;, &#x27;0x410890&#x27;, &#x27;0x410920&#x27;, &#x27;0x4109b0&#x27;, &#x27;0x410a50&#x27;, &#x27;0x410af0&#x27;, &#x27;0x410b90&#x27;, &#x27;0x410c30&#x27;, &#x27;0x410cd0&#x27;, &#x27;0x410d70&#x27;, &#x27;0x410e10&#x27;, &#x27;0x410eb0&#x27;, &#x27;0x411920&#x27;, &#x27;0x4119c0&#x27;, &#x27;0x411a60&#x27;, &#x27;0x411b00&#x27;, &#x27;0x411ba0&#x27;, &#x27;0x411c40&#x27;, &#x27;0x411ce0&#x27;, &#x27;0x411d80&#x27;, &#x27;0x411e20&#x27;, &#x27;0x411ec0&#x27;, &#x27;0x411f60&#x27;, &#x27;0x412000&#x27;, &#x27;0x4120a0&#x27;, &#x27;0x412140&#x27;, &#x27;0x4121d0&#x27;, &#x27;0x410f50&#x27;, &#x27;0x40fa60&#x27;, &#x27;0x40f580&#x27;, &#x27;0x40f4f0&#x27;, &#x27;0x40f450&#x27;, &#x27;0x40f3c0&#x27;, &#x27;0x40f330&#x27;, &#x27;0x40f290&#x27;, &#x27;0x40f1f0&#x27;, &#x27;0x40f150&#x27;, &#x27;0x40f0c0&#x27;, &#x27;0x40f020&#x27;, &#x27;0x40ef80&#x27;, &#x27;0x40eef0&#x27;, &#x27;0x40ee50&#x27;, &#x27;0x40edb0&#x27;, &#x27;0x40ed20&#x27;, &#x27;0x40ec80&#x27;, &#x27;0x40ebf0&#x27;, &#x27;0x40eb50&#x27;, &#x27;0x40eac0&#x27;, &#x27;0x40ea20&#x27;, &#x27;0x40e990&#x27;, &#x27;0x40e8f0&#x27;, &#x27;0x40e850&#x27;, &#x27;0x40e7b0&#x27;, &#x27;0x40e710&#x27;, &#x27;0x40e670&#x27;, &#x27;0x40e5d0&#x27;, &#x27;0x40e530&#x27;, &#x27;0x40e490&#x27;, &#x27;0x40e3f0&#x27;, &#x27;0x40e350&#x27;, &#x27;0x40e2b0&#x27;, &#x27;0x40e220&#x27;, &#x27;0x40e180&#x27;, &#x27;0x40e0e0&#x27;, &#x27;0x40e040&#x27;, &#x27;0x40dfb0&#x27;, &#x27;0x40df10&#x27;, &#x27;0x40de70&#x27;, &#x27;0x40ddd0&#x27;, &#x27;0x40dd40&#x27;, &#x27;0x40dca0&#x27;, &#x27;0x40dc00&#x27;, &#x27;0x40db60&#x27;, &#x27;0x40dac0&#x27;, &#x27;0x40da20&#x27;, &#x27;0x40d980&#x27;, &#x27;0x40d8e0&#x27;, &#x27;0x40d840&#x27;, &#x27;0x40d7a0&#x27;, &#x27;0x40d700&#x27;, &#x27;0x40f9c0&#x27;, &#x27;0x40fe10&#x27;, &#x27;0x4116b0&#x27;, &#x27;0x412450&#x27;, &#x27;0x4131e0&#x27;, &#x27;0x413280&#x27;, &#x27;0x413320&#x27;, &#x27;0x4133c0&#x27;, &#x27;0x413460&#x27;, &#x27;0x4134f0&#x27;, &#x27;0x4124f0&#x27;, &#x27;0x411740&#x27;, &#x27;0x40fea0&#x27;, &#x27;0x40ff40&#x27;, &#x27;0x40ffe0&#x27;, &#x27;0x410080&#x27;, &#x27;0x410120&#x27;, &#x27;0x4117e0&#x27;, &#x27;0x412590&#x27;, &#x27;0x413590&#x27;, &#x27;0x4139d0&#x27;, &#x27;0x416820&#x27;, &#x27;0x416780&#x27;, &#x27;0x4166e0&#x27;, &#x27;0x416640&#x27;, &#x27;0x4165a0&#x27;, &#x27;0x416500&#x27;, &#x27;0x416460&#x27;, &#x27;0x4163c0&#x27;, &#x27;0x416320&#x27;, &#x27;0x416280&#x27;, &#x27;0x4168c0&#x27;, &#x27;0x419110&#x27;, &#x27;0x419370&#x27;, &#x27;0x419fb0&#x27;, &#x27;0x41a040&#x27;, &#x27;0x41a0e0&#x27;, &#x27;0x41a180&#x27;, &#x27;0x41a220&#x27;, &#x27;0x41a2c0&#x27;, &#x27;0x41a350&#x27;, &#x27;0x41a3f0&#x27;, &#x27;0x41a490&#x27;, &#x27;0x41a530&#x27;, &#x27;0x41a5d0&#x27;, &#x27;0x419410&#x27;, &#x27;0x4191b0&#x27;, &#x27;0x416960&#x27;, &#x27;0x416a00&#x27;, &#x27;0x416a90&#x27;, &#x27;0x416b20&#x27;, &#x27;0x416bc0&#x27;, &#x27;0x416c60&#x27;, &#x27;0x416d00&#x27;, &#x27;0x416da0&#x27;, &#x27;0x416e40&#x27;, &#x27;0x416ee0&#x27;, &#x27;0x416f80&#x27;, &#x27;0x417010&#x27;, &#x27;0x4170b0&#x27;, &#x27;0x417150&#x27;, &#x27;0x4171e0&#x27;, &#x27;0x417280&#x27;, &#x27;0x417320&#x27;, &#x27;0x4173c0&#x27;, &#x27;0x417460&#x27;, &#x27;0x417500&#x27;, &#x27;0x4175a0&#x27;, &#x27;0x417640&#x27;, &#x27;0x4176e0&#x27;, &#x27;0x417780&#x27;, &#x27;0x417820&#x27;, &#x27;0x4178c0&#x27;, &#x27;0x417960&#x27;, &#x27;0x417a00&#x27;, &#x27;0x417aa0&#x27;, &#x27;0x417b30&#x27;, &#x27;0x417bd0&#x27;, &#x27;0x417c70&#x27;, &#x27;0x417d10&#x27;, &#x27;0x417da0&#x27;, &#x27;0x417e30&#x27;, &#x27;0x417ec0&#x27;, &#x27;0x417f60&#x27;, &#x27;0x418000&#x27;, &#x27;0x4180a0&#x27;, &#x27;0x418140&#x27;, &#x27;0x4181e0&#x27;, &#x27;0x418280&#x27;, &#x27;0x418310&#x27;, &#x27;0x4183b0&#x27;, &#x27;0x418440&#x27;, &#x27;0x4184e0&#x27;, &#x27;0x418580&#x27;, &#x27;0x418610&#x27;, &#x27;0x4186b0&#x27;, &#x27;0x419250&#x27;, &#x27;0x4194b0&#x27;, &#x27;0x41be60&#x27;, &#x27;0x41bf90&#x27;, &#x27;0x41c8e0&#x27;, &#x27;0x41e1e0&#x27;, &#x27;0x41e140&#x27;, &#x27;0x41ea10&#x27;, &#x27;0x41ebf0&#x27;, &#x27;0x41f1e0&#x27;]dssddddddddddddddddddssssssssssdddddddddddddddddddddddddddddddwwwwwwaaaaaaaaassddddddssaaaaaaaaaaaaawwdddwwwwwddddddddddddddddddddddddddsssssssssssssssddddddddddddddddwwwwwwwwwwwwwaaaaaaawwwwddddddddddddssssssdsdsdsssasaasssssssaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaawaaasaaaaaaaaaaaaaaaaaaawwwwdddddddddddddddddddddsddddddddddddddwwwaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaasssssdddddwwwddddsssssaaaaaaaaassssddddddddddwwwddddddddddddddddddddddddddddddddddddddddddddddddssssssassssDASCTF&#123;0a80fbe4b623aa3c09173ecf9147601e&#125; å¯¹äºnetworkxçš„å­¦ä¹ ï¼Œå¯ä»¥å‚è€ƒæ­¤æ–‡æ¡£ https://www.osgeo.cn/networkx/tutorial.html å¯¹äºæ±‚æœ€çŸ­è·¯å¾„æ¥è¯´ï¼ŒåŸºæœ¬å°±æ˜¯ åˆ›å»ºåˆé€‚çš„å›¾ æ·»åŠ èŠ‚ç‚¹ï¼Œæ·»åŠ è¾¹ è°ƒç”¨shortest_pathï¼Œæ±‚å‡ºæœ€çŸ­è·¯å¾„ï¼Œè¿™é‡Œæ±‚å‡ºçš„æ˜¯ç»è¿‡çš„èŠ‚ç‚¹ ç„¶åå†æ ¹æ®å…·ä½“é¢˜ç›®è¦æ±‚ï¼Œæ ¹æ®ç»è¿‡çš„èŠ‚ç‚¹ï¼ŒæŠŠæ“ä½œçš„æ­¥éª¤æ‰“å°å‡ºæ¥å³å¯ IDAAAAAAåˆ†ææ­¤é¢˜ä¸ºä»Šå¹´L3HCTFçš„ä¸€é“reé¢˜ï¼Œé¢˜ç›®ä»…ç»™äº†ä¸€ä¸ªi64æ–‡ä»¶ï¼Œæ²¡æœ‰ç»™å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒIDAæ‰“å¼€åˆ†æ sub_401E97å‡½æ•°è¿”å›1ï¼Œåˆ™æ­£ç¡®, è¿›å…¥æ­¤å‡½æ•°å‘ç°æœ‰5ä¸ªæ–¹ç¨‹ï¼Œç”¨z3è§£ å‘ç°æ— è§£ å†æ¬¡è§‚å¯Ÿï¼Œå‘ç°è¿™é‡Œæœ‰ä¸ªæ–­ç‚¹ï¼Œæ¥åˆ°æ–­ç‚¹çª—å£ å‘ç°æ˜¯ä¸ªæ¡ä»¶æ–­ç‚¹ï¼Œå°†conditonçš„æ•°æ®å¤åˆ¶å‡ºæ¥ 12345678910111213141516global jIS40AjIS40A = [xxx, xxx, xxxã€‚ã€‚ã€‚ã€‚] # å¾ˆé•¿çš„å¯†æ–‡ æ˜¯ä¸ªåˆ—è¡¨ï¼Œé•¿åº¦æ˜¯1000N4QKUt = 0EpUdLx = 4728923 # 0x048285B idaapi.add_bpt(EpUdLx) # 0x048285B uwGgnM = idaapi.bpt_t()idaapi.get_bpt(EpUdLx, uwGgnM)uwGgnM.elang = &quot;Python&quot; uwGgnM.condition = &quot;N4QKUt = &#123;&#125;\\n&quot;.format(N4QKUt) + &#x27;VLzxDy = idaapi.get_byte(5127584 + N4QKUt)\\nVLzxDy -= ord(\\&#x27;a\\&#x27;)\\nif VLzxDy == 0:\\n bYsMTa = 287\\n LjzrdT = b\\&#x27;lqAT7pNI3BX\\&#x27;\\nelif VLzxDy == 1:\\n bYsMTa = 96\\n LjzrdT = b\\&#x27;z3Uhis74aPq\\&#x27;\\nelif VLzxDy == 2:\\n bYsMTa = 8\\n LjzrdT = b\\&#x27;9tjseMGBHR5\\&#x27;\\nelif VLzxDy == 3:\\n bYsMTa = 777\\n LjzrdT = b\\&#x27;FhnvgMQjexH\\&#x27;\\nelif VLzxDy == 4:\\n bYsMTa = 496\\n LjzrdT = b\\&#x27;SKnZ51f9WsE\\&#x27;\\nelif VLzxDy == 5:\\n bYsMTa = 822\\n LjzrdT = b\\&#x27;gDJy104BSHW\\&#x27;\\nelif VLzxDy == 6:\\n bYsMTa = 914\\n LjzrdT = b\\&#x27;PbRV4rSM7fd\\&#x27;\\nelif VLzxDy == 7:\\n bYsMTa = 550\\n LjzrdT = b\\&#x27;WHPnoMTsbx3\\&#x27;\\nelif VLzxDy == 8:\\n bYsMTa = 273\\n LjzrdT = b\\&#x27;mLx5hvlqufG\\&#x27;\\nelif VLzxDy == 9:\\n bYsMTa = 259\\n LjzrdT = b\\&#x27;QvKgNmUFTnW\\&#x27;\\nelif VLzxDy == 10:\\n bYsMTa = 334\\n LjzrdT = b\\&#x27;TCrHaitRfY1\\&#x27;\\nelif VLzxDy == 11:\\n bYsMTa = 966\\n LjzrdT = b\\&#x27;m26IAvjq1zC\\&#x27;\\nelif VLzxDy == 12:\\n bYsMTa = 331\\n LjzrdT = b\\&#x27;dQb2ufTZwLX\\&#x27;\\nelif VLzxDy == 13:\\n bYsMTa = 680\\n LjzrdT = b\\&#x27;Y6Sr7znOeHL\\&#x27;\\nelif VLzxDy == 14:\\n bYsMTa = 374\\n LjzrdT = b\\&#x27;hLFj1wl5A0U\\&#x27;\\nelif VLzxDy == 15:\\n bYsMTa = 717\\n LjzrdT = b\\&#x27;H6W03R7TLFe\\&#x27;\\nelif VLzxDy == 16:\\n bYsMTa = 965\\n LjzrdT = b\\&#x27;fphoJwDKsTv\\&#x27;\\nelif VLzxDy == 17:\\n bYsMTa = 952\\n LjzrdT = b\\&#x27;CMF1Vk7NH4O\\&#x27;\\nelif VLzxDy == 18:\\n bYsMTa = 222\\n LjzrdT = b\\&#x27;43PSbAlgLqj\\&#x27;\\nelse:\\n bYsMTa = -1\\nif bYsMTa &lt; 0:\\n cpu.rsp -= 8\\n cpu.rdi = 4927649\\n cpu.rax = 0\\n idaapi.patch_qword(cpu.rsp, 4202616)\\n idaapi.del_bpt(cpu.rip)\\n cpu.rip = 4263680\\nelse:\\n zaqhdD = 0x486195\\n bYsMTa = jIS40A[bYsMTa]\\n\\n idaapi.patch_bytes(5117568, bYsMTa)\\n idaapi.patch_bytes(5117488, LjzrdT)\\n\\n cpu.rsp -= 8\\n idaapi.patch_qword(cpu.rsp, zaqhdD)\\n cpu.rdi = 5117568\\n cpu.rsi = len(bYsMTa)\\n cpu.rdx = 5117488\\n cpu.rcx = 11\\n cpu.r8 = 5117568\\n cpu.rax = 5117568\\n\\n idaapi.add_bpt(zaqhdD)\\n jQfwUA = idaapi.bpt_t()\\n idaapi.get_bpt(zaqhdD, jQfwUA)\\n jQfwUA.elang = &quot;Python&quot;\\n jQfwUA.condition = &quot;N4QKUt = &#123;&#125;\\\\nSdjOr3 = &#123;&#125;\\\\n&quot;.format(N4QKUt, len(bYsMTa)) + \\&#x27;bYsMTa = idaapi.get_bytes(cpu.rax, SdjOr3).decode()\\\\nzaqhdD = 4767838\\\\nidaapi.add_bpt(zaqhdD)\\\\njQfwUA = idaapi.bpt_t()\\\\nidaapi.get_bpt(zaqhdD, jQfwUA)\\\\njQfwUA.elang = &quot;Python&quot;\\\\njQfwUA.condition = &quot;N4QKUt = &#123;&#125;\\\\\\\\n&quot;.format(N4QKUt+1) + bYsMTa\\\\nidaapi.del_bpt(zaqhdD)\\\\nidaapi.add_bpt(jQfwUA)\\\\nidaapi.del_bpt(cpu.rip)\\\\ncpu.rsp -= 8\\\\nidaapi.patch_qword(cpu.rsp, zaqhdD)\\\\ncpu.rip = 4447160\\\\n\\&#x27;\\n idaapi.del_bpt(zaqhdD)\\n idaapi.add_bpt(jQfwUA)\\n idaapi.del_bpt(cpu.rip)\\n cpu.rip = 4201909\\n&#x27; idaapi.del_bpt(EpUdLx)idaapi.add_bpt(uwGgnM) # æ”¹ä¸ºæ¡ä»¶æ–­ç‚¹cpu.rsp -= 8idaapi.patch_qword(cpu.rsp, EpUdLx) # 0x48285Bcpu.rip = 4202096 # retn --&gt;æ¥åˆ°åˆšæ‰æ¡ä»¶æ–­ç‚¹çš„ä½ç½® å¯ä»¥å‘ç°ï¼Œå¤§è‡´æµç¨‹ä¸ºï¼Œè§¦å‘0x40201Få¤„çš„æ–­ç‚¹çš„æ—¶å€™ï¼Œè®¾ç½®ä¸€ä¸ªæ–°çš„æ¡ä»¶æ–­ç‚¹ï¼Œè·³è½¬è¿‡å»ï¼Œè§¦å‘æ–°çš„æ¡ä»¶æ–­ç‚¹çš„conditionï¼Œç”±æ­¤å¯è§éªŒè¯flagçš„ç®—æ³•å…¨éƒ¨åœ¨è¿™äº›conditionä¸­ å°†uwGgnM.condition ç¨ä½œæ•´ç†ï¼Œç„¶ååˆ†æ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596N4QKUt = 0VLzxDy = idaapi.get_byte(5127584 + N4QKUt) # 5127584(0x4e3da0) ä¸ºç¨‹åºä¸­è¾“å…¥çš„flagçš„åœ°å€ flag[N4QKUt]VLzxDy -= ord(&#x27;a&#x27;)if VLzxDy == 0: # æ ¹æ®VLzxDyåˆå§‹åŒ–2ä¸ªå€¼ bYsMTa = 287 # jIS40Açš„ç´¢å¼• LjzrdT = b&#x27;lqAT7pNI3BX&#x27; # è§£å¯† jIS40A[bYsMTa] çš„keyelif VLzxDy == 1: bYsMTa = 96 LjzrdT = b&#x27;z3Uhis74aPq&#x27;elif VLzxDy == 2: bYsMTa = 8 LjzrdT = b&#x27;9tjseMGBHR5&#x27;elif VLzxDy == 3: bYsMTa = 777 LjzrdT = b&#x27;FhnvgMQjexH&#x27;elif VLzxDy == 4: bYsMTa = 496 LjzrdT = b&#x27;SKnZ51f9WsE&#x27;elif VLzxDy == 5: bYsMTa = 822 LjzrdT = b&#x27;gDJy104BSHW&#x27;elif VLzxDy == 6: bYsMTa = 914 LjzrdT = b&#x27;PbRV4rSM7fd&#x27;elif VLzxDy == 7: bYsMTa = 550 LjzrdT = b&#x27;WHPnoMTsbx3&#x27;elif VLzxDy == 8: bYsMTa = 273 LjzrdT = b&#x27;mLx5hvlqufG&#x27;elif VLzxDy == 9: bYsMTa = 259 LjzrdT = b&#x27;QvKgNmUFTnW&#x27;elif VLzxDy == 10: bYsMTa = 334 LjzrdT = b&#x27;TCrHaitRfY1&#x27;elif VLzxDy == 11: bYsMTa = 966 LjzrdT = b&#x27;m26IAvjq1zC&#x27;elif VLzxDy == 12: bYsMTa = 331 LjzrdT = b&#x27;dQb2ufTZwLX&#x27;elif VLzxDy == 13: bYsMTa = 680 LjzrdT = b&#x27;Y6Sr7znOeHL&#x27;elif VLzxDy == 14: bYsMTa = 374 LjzrdT = b&#x27;hLFj1wl5A0U&#x27;elif VLzxDy == 15: bYsMTa = 717 LjzrdT = b&#x27;H6W03R7TLFe&#x27;elif VLzxDy == 16: bYsMTa = 965 LjzrdT = b&#x27;fphoJwDKsTv&#x27;elif VLzxDy == 17: bYsMTa = 952 LjzrdT = b&#x27;CMF1Vk7NH4O&#x27;elif VLzxDy == 18: bYsMTa = 222 LjzrdT = b&#x27;43PSbAlgLqj&#x27;else: bYsMTa = -1 if bYsMTa &lt; 0: # Wrongçš„ä½ç½® cpu.rsp -= 8 cpu.rdi = 4927649 # 0x4b30a1: &quot;O, no&quot; # ä¼ é€’å‚æ•° cpu.rax = 0 idaapi.patch_qword(cpu.rsp, 4202616) # leave retn idaapi.del_bpt(cpu.rip) cpu.rip = 4263680 # 0410F00 printf(&quot;O, no&quot;)else: zaqhdD = 0x486195 bYsMTa = jIS40A[bYsMTa] # ä»ä¸€é•¿ä¸²å¯†æ–‡ä¸­å–å‡ºæ•°æ® idaapi.patch_bytes(5117568, bYsMTa) # 0x4e1680 # å–å‡ºçš„å¯†æ–‡ idaapi.patch_bytes(5117488, LjzrdT) # 0x4e1630 # å–å‡ºçš„key # rdi, rsi, rdx, rcx, r8, r9 cpu.rsp -= 8 idaapi.patch_qword(cpu.rsp, zaqhdD) # 0x486195 # è®¾ç½®å‚æ•° cpu.rdi = 5117568 # 0x4e1680 # å¯†æ–‡åœ°å€ cpu.rsi = len(bYsMTa) # å¯†æ–‡é•¿åº¦ cpu.rdx = 5117488 # 0x4e1630 # keyåœ°å€ cpu.rcx = 11 # keyé•¿åº¦ cpu.r8 = 5117568 # 0x4e1680 # å¯†æ–‡åœ°å€ cpu.rax = 5117568 # 0x4e1680 # è¿”å›å€¼ idaapi.add_bpt(zaqhdD) jQfwUA = idaapi.bpt_t() idaapi.get_bpt(zaqhdD, jQfwUA) jQfwUA.elang = &quot;Python&quot; jQfwUA.condition = &quot;N4QKUt = &#123;&#125;\\nSdjOr3 = &#123;&#125;\\n&quot;.format(N4QKUt, len(bYsMTa)) + &#x27;bYsMTa = idaapi.get_bytes(cpu.rax, SdjOr3).decode()\\nzaqhdD = 4767838\\nidaapi.add_bpt(zaqhdD)\\njQfwUA = idaapi.bpt_t()\\nidaapi.get_bpt(zaqhdD, jQfwUA)\\njQfwUA.elang = &quot;Python&quot;\\njQfwUA.condition = &quot;N4QKUt = &#123;&#125;\\\\n&quot;.format(N4QKUt+1) + bYsMTa\\nidaapi.del_bpt(zaqhdD)\\nidaapi.add_bpt(jQfwUA)\\nidaapi.del_bpt(cpu.rip)\\ncpu.rsp -= 8\\nidaapi.patch_qword(cpu.rsp, zaqhdD)\\ncpu.rip = 4447160\\n&#x27; idaapi.del_bpt(zaqhdD) idaapi.add_bpt(jQfwUA) idaapi.del_bpt(cpu.rip) cpu.rip = 4201909 #0x401db5 # 5ä¸ªå‚æ•° å…ˆæ‰§è¡Œè§£å¯†ï¼Œç„¶åå†-&gt;0x486195(å› ä¸ºä¸Šé¢å·²ç»æŠŠcpu.esp-8çš„ä½ç½®æ”¹ä¸ºäº†0x486195), è§¦å‘æ¡ä»¶æ–­ç‚¹ å¯ä»¥å‘ç°æµç¨‹å°±æ˜¯ï¼Œæ ¹æ®è¾“å…¥çš„flagçš„æ¯ä¸ªå­—ç¬¦ï¼Œæ¥åˆ¤æ–­è¿›å…¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹è§£å¯†å‡½æ•°æ˜¯ä¸€ä¸ªç®€å•çš„å¼‚æˆ–, å…ˆéšä¾¿æ‰¾å‡ ä¸ªè§£å¯†çœ‹çœ‹ï¼Œkeyçš„é•¿åº¦éƒ½æ˜¯11 123456789def dec(_x, _key): m = [] for i in range(len(encs[_x])): m.append(encs[_x][i] ^ ord(_key[i % 11])) print(bytes(m).decode())dec(287, &#x27;lqAT7pNI3BX&#x27;)print(&#x27;===============================================================&#x27;)dec(96, &#x27;z3Uhis74aPq&#x27;) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293NyPGpw = idaapi.get_byte(5127584 + N4QKUt)NyPGpw -= ord(&#x27;a&#x27;)if NyPGpw == 0: afvkwL = 667 hsYnNw = b&#x27;vjHiPd4bBuf&#x27;elif NyPGpw == 1: afvkwL = 667 hsYnNw = b&#x27;vjHiPd4bBuf&#x27;elif NyPGpw == 2: afvkwL = 667 hsYnNw = b&#x27;vjHiPd4bBuf&#x27;else: afvkwL = -1if afvkwL &lt; 0: cpu.rsp -= 8 cpu.rdi = 4927649 cpu.rax = 0 idaapi.patch_qword(cpu.rsp, 4202616) idaapi.del_bpt(cpu.rip) cpu.rip = 4263680else: RrNlIm = 0x4438d8 afvkwL = jIS40A[afvkwL] idaapi.patch_bytes(5117568, afvkwL) idaapi.patch_bytes(5117488, hsYnNw) cpu.rsp -= 8 idaapi.patch_qword(cpu.rsp, RrNlIm) cpu.rdi = 5117568 cpu.rsi = len(afvkwL) cpu.rdx = 5117488 cpu.rcx = 11 cpu.r8 = 5117568 cpu.rax = 5117568 idaapi.add_bpt(RrNlIm) XKDdOn = idaapi.bpt_t() idaapi.get_bpt(RrNlIm, XKDdOn) XKDdOn.elang = &quot;Python&quot; XKDdOn.condition = &quot;N4QKUt = &#123;&#125;\\nSdjOr3 = &#123;&#125;\\n&quot;.format(N4QKUt, len(afvkwL)) + &#x27;afvkwL = idaapi.get_bytes(cpu.rax, SdjOr3).decode()\\nRrNlIm = 4370382\\nidaapi.add_bpt(RrNlIm)\\nXKDdOn = idaapi.bpt_t()\\nidaapi.get_bpt(RrNlIm, XKDdOn)\\nXKDdOn.elang = &quot;Python&quot;\\nXKDdOn.condition = &quot;N4QKUt = &#123;&#125;\\\\n&quot;.format(N4QKUt+1) + afvkwL\\nidaapi.del_bpt(RrNlIm)\\nidaapi.add_bpt(XKDdOn)\\nidaapi.del_bpt(cpu.rip)\\ncpu.rsp -= 8\\nidaapi.patch_qword(cpu.rsp, RrNlIm)\\ncpu.rip = 4220940\\n&#x27; idaapi.del_bpt(RrNlIm) idaapi.add_bpt(XKDdOn) idaapi.del_bpt(cpu.rip) cpu.rip = 4201909===============================================================XxrupR = idaapi.get_byte(5127584 + N4QKUt)XxrupR -= ord(&#x27;a&#x27;)if XxrupR == 0: SAoBHX = 667 EOlVWv = b&#x27;vjHiPd4bBuf&#x27;elif XxrupR == 1: SAoBHX = 667 EOlVWv = b&#x27;vjHiPd4bBuf&#x27;elif XxrupR == 2: SAoBHX = 667 EOlVWv = b&#x27;vjHiPd4bBuf&#x27;else: SAoBHX = -1if SAoBHX &lt; 0: cpu.rsp -= 8 cpu.rdi = 4927649 cpu.rax = 0 idaapi.patch_qword(cpu.rsp, 4202616) idaapi.del_bpt(cpu.rip) cpu.rip = 4263680else: uBEeMD = 0x45e68a SAoBHX = jIS40A[SAoBHX] idaapi.patch_bytes(5117568, SAoBHX) idaapi.patch_bytes(5117488, EOlVWv) cpu.rsp -= 8 idaapi.patch_qword(cpu.rsp, uBEeMD) cpu.rdi = 5117568 cpu.rsi = len(SAoBHX) cpu.rdx = 5117488 cpu.rcx = 11 cpu.r8 = 5117568 cpu.rax = 5117568 idaapi.add_bpt(uBEeMD) piHsvj = idaapi.bpt_t() idaapi.get_bpt(uBEeMD, piHsvj) piHsvj.elang = &quot;Python&quot; piHsvj.condition = &quot;N4QKUt = &#123;&#125;\\nSdjOr3 = &#123;&#125;\\n&quot;.format(N4QKUt, len(SAoBHX)) + &#x27;SAoBHX = idaapi.get_bytes(cpu.rax, SdjOr3).decode()\\nuBEeMD = 4808702\\nidaapi.add_bpt(uBEeMD)\\npiHsvj = idaapi.bpt_t()\\nidaapi.get_bpt(uBEeMD, piHsvj)\\npiHsvj.elang = &quot;Python&quot;\\npiHsvj.condition = &quot;N4QKUt = &#123;&#125;\\\\n&quot;.format(N4QKUt+1) + SAoBHX\\nidaapi.del_bpt(uBEeMD)\\nidaapi.add_bpt(piHsvj)\\nidaapi.del_bpt(cpu.rip)\\ncpu.rsp -= 8\\nidaapi.patch_qword(cpu.rsp, uBEeMD)\\ncpu.rip = 4405922\\n&#x27; idaapi.del_bpt(uBEeMD) idaapi.add_bpt(piHsvj) idaapi.del_bpt(cpu.rip) cpu.rip = 4201909 å¯ä»¥å‘ç°éƒ½ç¬¦åˆä¸€ä¸ªæ¡†æ¶ 12345678910111213xxxx = idaapi.get_byte(5127584 + N4QKUt)xxxx -= ord(&#x27;a&#x27;)if xxxx == 0: afvkwL = 667 hsYnNw = b&#x27;vjHiPd4bBuf&#x27;elif xxxx == 1: afvkwL = 667 hsYnNw = b&#x27;vjHiPd4bBuf&#x27; .......else: afvkwL = -1if afvkwL &lt; 0: ........ å› ä¸ºè§£å¯†å‡ºæ¥éƒ½å«æœ‰idaapi.get_byte(5127584 + N4QKUt)ï¼Œè€Œkeyçš„é•¿åº¦éƒ½æ˜¯11ï¼Œå› æ­¤å¯ä»¥å¯¹keyå…¨éƒ¨çˆ†ç ´å‡ºæ¥ 123456789101112131415encs = [....] def get_keys(): sign = [ord(i) for i in &#x27;XxrupR = idaapi.get_byte(5127584 + N4QKUt)&#x27;[11:22]] keys = [0]*1000 # encsçš„é•¿åº¦æ˜¯1000ï¼Œ å¯¹åº”1000ä¸ªkey for i in range(len(encs)): tmp = encs[i][11:22] tmp_key = [tmp[j] ^ sign[j] for j in range(11)] # è·å¾—key sign_1 = [tmp_key[j] ^ encs[i][j] for j in range(11)] if b&#x27;= id&#x27; in bytes(sign_1): keys[i] = bytes(tmp_key) else: keys[i] = None # i = 426 return keyskeys = get_keys()print(keys.count(None)) # 1 åªæœ‰1ä¸ªèŠ‚ç‚¹æ²¡æœ‰è§£å¯†æˆåŠŸï¼Œå³æ²¡æœ‰æŒ‡å‘ï¼Œåº”è¯¥å°±æ˜¯ç»ˆç‚¹ï¼Œç»“åˆé¢˜ç›®ï¼Œæ˜¯ä¸ªæœ€çŸ­è·¯å¾„é—®é¢˜ ç»ˆç‚¹çš„ç´¢å¼•æ˜¯426ï¼Œå†™è„šæœ¬æ‰¾åˆ°ç´¢å¼•426çš„key 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849def dec(_src, _key): m = [] for i in range(len(_src)): m.append(_src[i] ^ _key[i % 11]) return bytes(m).decode(&quot;utf-8&quot;)def get_keys(): sign = [ord(i) for i in &#x27;XxrupR = idaapi.get_byte(5127584 + N4QKUt)&#x27;[11:22]] keys = [0]*1000 # encsçš„é•¿åº¦æ˜¯1000ï¼Œ å¯¹åº”1000ä¸ªkey for i in range(len(encs)): tmp = encs[i][11:22] tmp_key = [tmp[j] ^ sign[j] for j in range(11)] # è·å¾—key sign_1 = [tmp_key[j] ^ encs[i][j] for j in range(11)] if b&#x27;= id&#x27; in bytes(sign_1): keys[i] = bytes(tmp_key) else: keys[i] = None return keysdef get_node_edges(_dec_src): # è·å–æ¯æ¡è¾¹ï¼Œ2ä¸ªç‚¹å³æ„æˆä¸€æ¡è¾¹ # ä¼ å…¥è§£å¯†åçš„è„šæœ¬ i = _dec_src.index(&#x27;&lt;&#x27;) _dec_src = _dec_src[:i] m = re.findall(r&#x27; = (\\d+)&#x27;, _dec_src) nodes = [int(i) for i in m] return nodes keys = get_keys()for i, value in enumerate(encs): if keys[i] == None: target_node = i else: dec_src = dec(value, keys[i]) nodes = get_node_edges(dec_src) # æ·»åŠ è¾¹ for j in range(len(nodes)): if nodes[j]==426: print(i) print(dec_src) exit()# 705# GKjYbv = idaapi.get_byte(5127584 + N4QKUt)# GKjYbv -= ord(&#x27;a&#x27;)# if GKjYbv == 0:# NizaZl = 426# BCTfiu = b&#x27;akUx3IWl29V&#x27;# else:# ...... keyä¸ºakUx3IWl29V, è§£å¯†å¾—åˆ° 123idaapi.del_bpt(cpu.rip)cpu.rax = 0cpu.rip = 4202594 # 0x402062 æ˜¯ç»ˆç‚¹æ— ç–‘äº†ï¼Œç°åœ¨éœ€è¦æ‰¾å‡ºæ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œä»¥åŠè¾¹ï¼ˆ2ä¸ªèŠ‚ç‚¹å°±æ˜¯1ä¸ªè¾¹ï¼Œæœ‰æ–¹å‘ï¼‰,ç„¶åç”¨networkxæ±‚è§£ networkxæ±‚æœ€çŸ­è·¯å¾„ç›´æ¥è´´è„šæœ¬äº†ï¼Œå°±æ˜¯é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‡ºnode,ç„¶åæ„é€ è¾¹ï¼Œæ·»åŠ è¾¹ï¼Œç”¨networkxæ±‚å‡ºè·¯å¾„ï¼Œå†å†™å‡ºæ§åˆ¶æ–¹å‘çš„çš„flagå­—ç¬¦å³å¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384import reimport networkximport hashlibencs = [....] def dec(_src, _key): m = [] for i in range(len(_src)): m.append(_src[i] ^ _key[i % 11]) return bytes(m).decode(&quot;utf-8&quot;)def get_keys(): sign = [ord(i) for i in &#x27;XxrupR = idaapi.get_byte(5127584 + N4QKUt)&#x27;[11:22]] keys = [0]*1000 # encsçš„é•¿åº¦æ˜¯1000ï¼Œ å¯¹åº”1000ä¸ªkey for i in range(len(encs)): tmp = encs[i][11:22] tmp_key = [tmp[j] ^ sign[j] for j in range(11)] # è·å¾—key sign_1 = [tmp_key[j] ^ encs[i][j] for j in range(11)] if b&#x27;= id&#x27; in bytes(sign_1): keys[i] = bytes(tmp_key) else: keys[i] = None return keysdef get_node_edges(_dec_src): # è·å–æ¯ä¸ªèŠ‚ç‚¹æŒ‡å‘çš„å…¶ä»–çš„èŠ‚ç‚¹ï¼Œç„¶åé€šè¿‡æ­¤æ¥è·å–è¾¹ # ä¼ å…¥è§£å¯†åçš„è„šæœ¬ i = _dec_src.index(&#x27;&lt;&#x27;) _dec_src = _dec_src[:i] m = re.findall(r&#x27; = (\\d+)&#x27;, _dec_src) nodes = [int(i) for i in m] return nodes keys = get_keys()edges = []node2node = []for i, value in enumerate(encs): if keys[i] == None: target_node = i # ç»ˆç‚¹ nodes = [] else: dec_src = dec(value, keys[i]) nodes = get_node_edges(dec_src) # æ·»åŠ è¾¹ for j in range(len(nodes)): # æ ¹æ®è·å–çš„æŒ‡å‘çš„èŠ‚ç‚¹æ¥æ·»åŠ è¾¹ edges.append([i, nodes[j]]) node2node.append(nodes)src_node = -1 # æœ€å¼€å§‹è¿˜æœ‰1ä¸ªèŠ‚ç‚¹src_edge = [287, 96, 8, 777, 496, 822, 914, 550, 273, 259, 334, 966, 331, 680, 374, 717, 965, 952, 222]# å°†æœ€åˆçš„è¾¹æ·»åŠ è¿›å»for i in src_edge: edges.append([src_node, i])G = networkx.DiGraph()G.add_node(-1)for i in range(len(encs)): G.add_node(i)for i in edges: G.add_edge(i[0], i[1])path = networkx.shortest_path(G, source=src_node, target=target_node)print(path) # æ‰“å°å‡ºè·¯å¾„æ¥s = []s.append(src_edge.index(path[1]))for i in range(2, len(path)): s.append(node2node[path[i-1]].index(path[i]))print(s)s = &quot;&quot;.join([chr(ord(&#x27;a&#x27;) + i) for i in s])print(s)print(&quot;L3HCTF&#123;&quot; + hashlib.md5(s.encode()).hexdigest() + &quot;&#125;&quot;)# [-1, 331, 578, 255, 875, 765, 687, 209, 119, 963, 939, 443, 250, 366, 65, 504, 920, 849, 720, 893, 728, 580, 114, 665, 72, 51, 241, 519, 473, 970, 984, 557, 90, 793, 487, 67, 428, 236, 263, 24, 39, 104, 505, 491, 95, 223, 486, 798, 873, 872, 64, 229, 37, 274, 329, 601, 372, 750, 446, 3, 332, 698, 277, 740, 816, 845, 570, 828, 21, 36, 839, 770, 343, 451, 151, 994, 937, 760, 644, 9, 614, 302, 454, 153, 840, 76, 424, 352, 950, 238, 613, 497, 898, 858, 415, 205, 393, 927, 522, 705, 426]# [12, 2, 0, 4, 1, 0, 2, 4, 3, 0, 0, 1, 5, 0, 2, 0, 2, 0, 1, 6, 0, 6, 1, 1, 0, 0, 4, 0, 2, 0, 1, 2, 1, 0, 2, 4, 1, 0, 6, 0, 0, 0, 1, 2, 3, 1, 6, 1, 3, 1, 2, 1, 3, 0, 2, 6, 0, 1, # 5, 1, 1, 4, 1, 0, 1, 0, 1, 1, 1, 1, 1, 2, 0, 0, 1, 3, 0, 1, 0, 1, 0, 5, 0, 2, 2, 0, 2, 3, 0, 6, 3, 0, 0, 1, 0, 1, 0, 0, 0, 0]# mcaebacedaabfacacabgagbbaaeacabcbacebagaaabcdbgbdbcbdacgabfbbebababbbbbcaabdababafaccacdagdaababaaaa# L3HCTF&#123;6584ed9fd9497981117f22a6c572caee&#125; flagä¸º L3HCTF&#123;6584ed9fd9497981117f22a6c572caee&#125; å‚è€ƒï¼š https://www.anquanke.com/post/id/259494#h3-2","categories":[{"name":"CTF","slug":"CTF","permalink":"https://zzzzsky.github.io/categories/CTF/"}],"tags":[{"name":"å›¾","slug":"å›¾","permalink":"https://zzzzsky.github.io/tags/%E5%9B%BE/"},{"name":"æœ€çŸ­è·¯å¾„","slug":"æœ€çŸ­è·¯å¾„","permalink":"https://zzzzsky.github.io/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/"}]},{"title":"IDAPython å­¦ä¹ ç¬”è®°","slug":"LearnIDAPython","date":"2021-12-08T14:12:00.000Z","updated":"2021-12-08T14:22:07.588Z","comments":true,"path":"2021/12/08/LearnIDAPython/","link":"","permalink":"https://zzzzsky.github.io/2021/12/08/LearnIDAPython/","excerpt":"","text":"æ‘˜è¦æ¯”ç€å¤§ä½¬å†™çš„æ–‡ç« ç³»ç»Ÿçš„å­¦ä¹ ä¸‹IDAPythonï¼Œåšä¸‹ç¬”è®°ï¼Œä¾›è‡ªå·±ä»¥åæŸ¥è¯¢ å¤§ä½¬çš„æ–‡ç« ï¼ŒğŸ‘‡ https://www.cnblogs.com/iBinary/p/14642662.htmlhttps://www.cnblogs.com/iBinary/p/14672540.htmlhttps://www.cnblogs.com/iBinary/p/14801928.html IDAPythonå‚è€ƒå­¦ä¹ æ–‡æ¡£ IDAPythonå®˜æ–¹å‡½æ•°æ–‡æ¡£ï¼š https://www.hex-rays.com/wp-content/static/products/ida/support/idapython_docs/ IDAç‰ˆæœ¬å˜åŒ–åIDAPythonå¯¹åº”å·®å¼‚å‡½æ•°æŸ¥è¯¢ï¼šhttps://www.hex-rays.com/products/ida/support/ida74_idapython_no_bc695_porting_guide.shtml IDAä¸­è·å–ç•Œé¢ä¸­åœ°å€å‡½æ•° ä½œç”¨ è€ç‰ˆå‡½æ•° æ–°ç‰ˆå‡½æ•° è·å–å½“å‰æŒ‡ä»¤åœ°å€ï¼ˆå…‰æ ‡ç‚¹å‡»çš„é‚£ä¸ªï¼Œç°è‰²é˜´å½±é‚£è¡Œï¼‰ idc.ScreenEA() idc.get_screen_ea() æ•´ä¸ªIDAä¸­çš„æœ€å°åœ°å€ idc.MinEA() idc.StartEA() idc.BeginEA() ida_ida.inf_get_min_ea() æ•´ä¸ªIDAä¸­çš„æœ€å¤§åœ°å€ï¼ˆå…¶å®æ˜¯æœ€å¤§åœ°å€ + 1ï¼‰ idc.MaxEA() ida_ida.inf_get_max_ea() å…‰æ ‡é€‰æ‹©å—çš„å¼€å§‹åœ°å€ idc.SelStart() idc.read_selection_start() å…‰æ ‡é€‰æ‹©å—çš„ç»“æŸåœ°å€ï¼ˆç»“æŸåœ°å€ + 1ï¼‰ idc.SelEnd() idc.read_selection_end() æ•°å€¼è·å–åŠæ‰“è¡¥ä¸æ“ä½œè·å–æ•°æ®åœ¨IDAä¸­æƒ³è¦è·å–æŸä¸ªåœ°å€å¤„çš„æ•°æ®å¯ä»¥é‡‡ç”¨ä»¥ä¸‹å‡½æ•° ä½œç”¨ è€ç‰ˆå‡½æ•° æ–°ç‰ˆå‡½æ•° è·å–BYTESç±»å‹ ida_bytes.get_many_bytes(addr, len) ida_bytes.get_bytes(addr, len) è·å–BYTEç±»å‹ idc.Byte(addr) idc.get_wide_byte(addr) è·å–WORDç±»å‹ idc.Word(addr) idc.get_wide_word(addr) è·å–DWORDç±»å‹ idc.Dword(addr) idc.get_wide_dword(addr) è·å–QWORDç±»å‹ idc.Qword(addr) idc.get_qword(addr) Patchæ‰“è¡¥ä¸ ä½œç”¨ è€ç‰ˆå‡½æ•° æ–°ç‰ˆå‡½æ•° æ‰“è¡¥ä¸BYTE idc.PatchByte(addr,value) ida_bytes.patch_byte(addr,value) æ‰“è¡¥ä¸WORD idc.PatchWord(addr,value) ida_bytes.patch_word(addr,value) æ‰“è¡¥ä¸DWORD idc.PatchDword(addr,value) ida_bytes.patch_dword(addr,value) æ‰“è¡¥ä¸QWORD idc.PatchQword(addr,value) ida_bytes.patch_qword(addr,value) æ±‡ç¼–ç›¸å…³æŒ‡ä»¤æ“ä½œ ä½œç”¨ è€ç‰ˆå‡½æ•° æ–°ç‰ˆå‡½æ•° è·å–åœ°å€å¤„çš„æ±‡ç¼–è¯­å¥ idc.GetDisasm(addr) æ—  æ›´é«˜çº§çš„è·å–.å¸¦æœ‰æ ‡å¿—. ä¸€èˆ¬æ˜¯ç»™ä¸€ä¸ª0 idc.GetDisasmEx(addr,flags) idc.generate_disasm_line(addr,flags) è·å–æŒ‡å®šä½ç½®çš„æ“ä½œæ•°mov ebp, esp. ebpç´¢å¼•æ˜¯0ï¼Œespç´¢å¼•æ˜¯1 idc.GetOpnd(addr,index) idc.print_operand(addr,index) è·å–åœ°å€å¤„æ±‡ç¼–æŒ‡ä»¤çš„æ“ä½œæŒ‡ä»¤ mov ebp,esp è·å–mov idc.GetMnem(addr) idc.print_insn_mnem(addr) è·å–åŸºåœ°å€ idaapi.get_imagebase() æ—  è·å–æ“ä½œæ•°çš„ç±»å‹ idc.GetOpType(ea,index) idc.get_operand_type(addr,index) call printfï¼› è°ƒç”¨æ­¤å‡½æ•°ï¼Œindexå¡«0çš„è¯ï¼Œè¿”å›çš„å°±æ˜¯printfçš„åœ°å€ã€‚ and esp, 0FFFFFFF8hï¼›indexå¡«1çš„è¯ï¼Œè¿”å›çš„å°±æ˜¯0xfffffff8 idc.GetOperandValue(addr,index) get_operand_value(addr,index) è·å–ä¸‹ä¸€è¡Œæ±‡ç¼–çš„åœ°å€ idc.NextHead idc.next_head(ea) è·å–ä¸Šä¸€è¡Œæ±‡ç¼–çš„åœ°å€ idc.PrevHead idc.PrevHead(ea) æ®µç›¸å…³æ“ä½œ ä½œç”¨ è€ç‰ˆå‡½æ•° æ–°ç‰ˆå‡½æ•° è·å–æ®µçš„åå­— idc.SegName(addr) idc.get_segm_name(addr) è·å–æ®µçš„å¼€å§‹åœ°å€ idc.SegStart(addr) idc.get_segm_start(addr) è·å–æ®µçš„ç»“æŸåœ°å€ idc.SegEnd(addr) idc.get_segm_end(addr) è¿”å›ä¸€ä¸ªåˆ—è¡¨è®°å½•æ‰€æœ‰æ®µçš„åœ°å€ idautils.Segments() æ—  è·å–ç¬¬ä¸€ä¸ªæ®µ idc.FirstSeg() idc.get_first_seg() è·å–ä¸‹ä¸€ä¸ªæ®µ å‚æ•°æ˜¯å½“å‰æ®µçš„ä»»æ„åœ°å€ è¿”å›çš„æ˜¯ä¸‹ä¸€ä¸ªæ®µçš„åœ°å€ idc.NextSeg(addr) idc.get_next_seg(addr) å‡½æ•°ç›¸å…³æ“ä½œ ä½œç”¨ è€ç‰ˆå‡½æ•° æ–°ç‰ˆå‡½æ•° è·å–æŒ‡å®šåœ°å€ä¹‹é—´çš„æ‰€æœ‰å‡½æ•° Functions(startaddr,endaddr) æ—  è·å–æŒ‡å®šåœ°å€çš„å‡½æ•°å idc.GetFunctionName(addr) idc.get_func_name(addr) è·å–å‡½æ•°çš„æ³¨é‡Š idc.GetFunctionCmt get_func_cmt(ea, repeatable) 1æ˜¯åœ°å€ 2æ˜¯0æˆ–1 1æ˜¯è·å–é‡å¤æ³¨é‡Š 0æ˜¯è·å–å¸¸è§„æ³¨é‡Š è®¾ç½®å‡½æ•°æ³¨é‡Š idc.SetFunctionCmt set_func_cmt(ea, cmt, repeatable) å¼¹æ¡†è®©ç”¨æˆ·é€‰æ‹©å‡½æ•°ï¼Œè¿”å›çš„æ˜¯å‡½æ•°çš„åœ°å€ idc.ChooseFunction(title) idc.choose_func(title) è¿”å›: addr è·ç¦»å‡½æ•°çš„åç§»å½¢å¼ idc.GetFuncOffset(addr) idc.get_func_off_str(addr) å¯»æ‰¾å‡½æ•°ç»“å°¾,å¦‚æœå‡½æ•°å­˜åœ¨åˆ™è¿”å›ç»“å°¾åœ°å€,å¦åˆ™è¿”å›-1 idc.FindFuncEnd(addr) idc.find_func_end(addr) è®¾ç½®å‡½æ•°ç»“å°¾ ida_funcs.func_setstart(addr,newstartaddr) ida_funcs.set_func_start(addr, newstart) è®¾ç½®å‡½æ•°å¼€å¤´ ida_funcs.func_setstart(addr,newstartaddr) ida_funcs.set_func_start(addr, newstart) è®¾ç½®åœ°å€å¤„çš„åå­— idc.MakeName(addr, name) ä¸ä¹‹åŒåäº†è¿˜æœ‰Exå‡½æ•° idc.set_name(ea, name, SN_CHECK) Exå‡½æ•°ä¹Ÿä½¿ç”¨set_name è·å–å‰ä¸€ä¸ªå‡½æ•°çš„åœ°å€ idc.PrevFunction idc.get_prev_func(ea) è·å–ä¸‹ä¸€ä¸ªå‡½æ•°çš„åœ°å€ idc.NextFunction idc.get_next_func æœç´¢åŠŸèƒ½æœç´¢ ä½œç”¨ è€ç‰ˆå‡½æ•° æ–°ç‰ˆå‡½æ•° æŸ¥æ‰¾äºŒè¿›åˆ¶æ‰¾åˆ°è¿”å›åœ°å€æ²¡æ‰¾åˆ°è¿”å›-1(BADADDR) idc.FindBinary idc.find_binary(ea, flag, searchstr, radix=16, from_bc695=False) è¿”å›dataçš„åœ°å€ï¼Œè€Œä¸æ˜¯codeï¼ˆæ³¨æ„ä¸æ˜¯æŒ‡å…·ä½“çš„æ•°æ®ï¼Œè€Œæ˜¯æŒ‡çš„dataç±»å‹ï¼‰ idc.FindData idc.find_data æˆ–è€…ida_search.find_data è¿”å›codeçš„åœ°å€ï¼Œè€Œä¸æ˜¯data idc.FindCode idc.find_code å¯ä»¥ä½¿ç”¨ ida_search.find_code ä¹Ÿå¯ä»¥ä½¿ç”¨ è·³è½¬åˆ°eaä½ç½® idc.Jump ida_kernwin.jumpto(ea) æ ¡éªŒæ•°æ®æ ¡éªŒå‡½æ•°is_xxxxä¼ å…¥çš„éƒ½æ˜¯flagï¼Œå› ä¸ºéœ€è¦å…ˆè·å–æŸä¸ªåœ°å€å¤„çš„flagï¼Œç„¶åå†å°†è·å–çš„flagä¼ å…¥is_xxxx ä½œç”¨ è€ç‰ˆå‡½æ•° æ–°ç‰ˆå‡½æ•° è·å–æ ‡å¿— idc.GetFlags(ea) ida_bytes.get_full_flags(ea) åˆ¤æ–­æ˜¯å¦æ˜¯ä»£ç ï¼Œä¼ å…¥æ ‡å¿—ï¼Œæ ¹æ®æ ‡å¿—è¿”å›True or False idc.isCode(f) ida_bytes.is_code(f) åŒä¸Š åªä¸è¿‡æ˜¯åˆ¤æ–­æ˜¯å¦æ˜¯æ•°æ® idc.isData(f) ida_bytes.is_data(f)","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://zzzzsky.github.io/categories/%E5%B7%A5%E5%85%B7/"}],"tags":[{"name":"IDAPython","slug":"IDAPython","permalink":"https://zzzzsky.github.io/tags/IDAPython/"},{"name":"IDA","slug":"IDA","permalink":"https://zzzzsky.github.io/tags/IDA/"}]},{"title":"2é“CTF_APKé¢˜ä¸èƒ½è°ƒè¯•çš„è§£å†³æ–¹æ³•åŠå¼•å‘çš„æ€è€ƒ","slug":"å®‰å“é‡æ–°ç­¾åæ‰“åŒ…è°ƒè¯•","date":"2021-12-04T14:02:00.000Z","updated":"2021-12-05T12:02:16.016Z","comments":true,"path":"2021/12/04/å®‰å“é‡æ–°ç­¾åæ‰“åŒ…è°ƒè¯•/","link":"","permalink":"https://zzzzsky.github.io/2021/12/04/%E5%AE%89%E5%8D%93%E9%87%8D%E6%96%B0%E7%AD%BE%E5%90%8D%E6%89%93%E5%8C%85%E8%B0%83%E8%AF%95/","excerpt":"","text":"2é“CTF_APKé¢˜ä¸èƒ½è°ƒè¯•çš„è§£å†³æ–¹æ³•åŠå¼•å‘çš„æ€è€ƒå‰è¨€æœ€è¿‘æ‰¾åˆ°2ä¸ªå®‰å“é¢˜ç›®æ¥ç»ƒä¹ ï¼Œåˆ†æåå‘ç°å¦‚æœå¯ä»¥è°ƒè¯•çš„è¯ä¼šå¤§å¤§é™ä½éš¾åº¦ï¼ˆä¸€é“æ˜¯JEBè°ƒè¯•ï¼Œä¸€é“æ˜¯IDAè°ƒè¯•soæ–‡ä»¶ï¼‰ï¼Œäºæ˜¯æˆ‘ç”¨å·¥å…·å¼€å§‹è°ƒè¯•ï¼Œå‘ç°éƒ½æ²¡æœ‰åŠæ³•è°ƒè¯•ï¼Œç»è¿‡å„ç§æŸ¥é˜…èµ„æ–™ç»ˆäºå¯ä»¥è°ƒè¯•äº†ï¼Œäºæ˜¯å†™ä¸‹æ­¤æ–‡ï¼Œè®°å½•ä¸‹ç¯å¢ƒé…ç½®ã€‚ é“¾æ¥ï¼šhttps://pan.baidu.com/s/1nYwqxmipw_marYN6wKJjAg æå–ç ï¼š9rxq é¢˜ç›®:CTF_2.apké‡åˆ°é—®é¢˜JEBè°ƒè¯•APKçš„æ—¶å€™, å…ˆadb shellï¼Œ ç„¶åæŸ¥çœ‹è¿›ç¨‹IDï¼Œä¸º4546 123beyond1q:/ # ps | grep &quot;ctf&quot;ps | grep &quot;ctf&quot;u0_a44 4546 1876 964728 83108 d772dcc0 S com.example.ctf æ‰“å¼€JEBé™„åŠ  æ²¡æ³•è°ƒè¯•ï¼Œä¸‹é¢å¼€å§‹è§£å†³ è§£å†³é—®é¢˜æ‰“å¼€Manifest ï¼Œå‘ç°å¹¶æ²¡æœ‰android:debuggable=&quot;true&quot; å…ˆè§£åŒ… apktool.bat d CTF_2_.apk äºæ˜¯ç”¨åŠ ä¸Šåç”¨é‡æ–°æ‰“åŒ… apktool.bat b CTF_2_ï¼Œ æ–°ç”Ÿæˆçš„APKæ–‡ä»¶åœ¨ CTF_2_\\distä¸­, è¿™ä¸ªæ—¶å€™å¦‚æœç›´æ¥å®‰è£…çš„è¯ä¼šæŠ¥é”™ 1234C:\\Users\\ZSKY\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹\\CTF_2\\CTF_2_\\distÎ» adb install CTF_2_.apk4685 KB/s (3004999 bytes in 0.626s)Failure [INSTALL_PARSE_FAILED_NO_CERTIFICATES: Failed to collect certificates from /data/app/vmdl625528294.tmp/base.apk: Attempt to get length of null array] è¿˜éœ€è¦ç­¾åæ‰å¯ä»¥ 123456789101112131415161718C:\\Users\\ZSKY\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹\\CTF_2 Î» keytool -genkey -keystore coolapk.keystore -keyalg RSA -validity 10000 -alias coolapk è¾“å…¥å¯†é’¥åº“å£ä»¤: #123456 å†æ¬¡è¾“å…¥æ–°å£ä»¤: #123456 æ‚¨çš„åå­—ä¸å§“æ°æ˜¯ä»€ä¹ˆ? [Unknown]: æ‚¨çš„ç»„ç»‡å•ä½åç§°æ˜¯ä»€ä¹ˆ? [Unknown]: æ‚¨çš„ç»„ç»‡åç§°æ˜¯ä»€ä¹ˆ? [Unknown]: æ‚¨æ‰€åœ¨çš„åŸå¸‚æˆ–åŒºåŸŸåç§°æ˜¯ä»€ä¹ˆ? [Unknown]: æ‚¨æ‰€åœ¨çš„çœ/å¸‚/è‡ªæ²»åŒºåç§°æ˜¯ä»€ä¹ˆ? [Unknown]: è¯¥å•ä½çš„åŒå­—æ¯å›½å®¶/åœ°åŒºä»£ç æ˜¯ä»€ä¹ˆ? [Unknown]: CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknownæ˜¯å¦æ­£ç¡®? [å¦]: y ç”Ÿæˆç­¾åæ–‡ä»¶å‘½ä»¤: keytool -genkey -keystore ç­¾åæ–‡ä»¶çš„æ–‡ä»¶å -keyalg RSA -validity 10000 -alias ç­¾åæ–‡ä»¶åˆ«å è¿™ä¸ªæ—¶å€™ä¼šç”Ÿæˆcoolapk.keystoreç­¾åæ–‡ä»¶, ç„¶åè¿è¡Œ jarsigner.exe -verbose -keystore coolapk.keystore -storepass 123456 -signedjar CTF_2_new_sign.apk -digestalg SHA1 -sigalg MD5withRSA CTF_2_new.apk coolapk å³å¯ç­¾å ç»™APKæ·»åŠ ç­¾åå‘½ä»¤: jarsigner.exe -verbose -keystore coolapk.keystore -storepass å¯†ç  -signedjar æ–°çš„APKæ–‡ä»¶å -digestalg SHA1 -sigalg MD5withRSA éœ€è¦ç­¾åçš„APKæ–‡ä»¶å ç­¾åæ–‡ä»¶çš„åˆ«å è¿™ä¸ªæ—¶å€™ï¼ŒæŠŠä¹‹å‰çš„å®‰è£…å¥½çš„APKåˆ é™¤ï¼Œç„¶åè¿è¡Œadb install CTF_2_new_sign.apkå³å¯å®‰è£…æˆåŠŸ å†ç”¨JEBè°ƒè¯•çš„æ—¶å€™ï¼Œè¿™é‡Œä¼šå¤šä¸€ä¸ªDæ ‡å¿— ä¸‹æ–­ç‚¹è¾“å…¥FLAGï¼Œç¨‹åºå°±ä¼šæ–­ä¸‹äº† é¢˜ç›®:CTF_4.apké‡åˆ°é—®é¢˜IDAåœ¨ æ£€æµ‹flagçš„å‡½æ•°é‚£é‡Œä¸‹æ–­ç‚¹ï¼Œæ‰‹æœºè¾“å…¥flagåç‚¹æ³¨å†ŒæŒ‰é’®ï¼ŒIDAæ€»æ˜¯æ–­ä¸ä¸‹æ¥ï¼Œç„¶åä¸‹æ–­ç‚¹çš„è¯æ˜¯æ©˜é»„è‰²ï¼Œåæ¥æŸ¥é˜…èµ„æ–™å‘ç°æ˜¯åŸºå€çš„é—®é¢˜ï¼Œè¿™é‡Œlibnative-lib.so æ–‡ä»¶åŠ è½½çš„åŸºå€å±…ç„¶æ˜¯0 IDAå¦‚ä½•è°ƒè¯•å®‰å“soæ–‡ä»¶å¯ä»¥å‚è€ƒ: https://zzzzsky.com/2021/11/29/IDA%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95%E5%AE%89%E5%8D%93so%E6%96%87%E4%BB%B6/ è§£å†³é—®é¢˜1ã€å°è¯•å»æ‰¾åŠ è½½è¯¥soæ–‡ä»¶çš„åŸºå€ç„¶åæ‰‹åŠ¨ä¿®å¤ æ ¹æœ¬æ‰¾ä¸åˆ°è¯¥soæ–‡ä»¶ã€‚ 2ã€ç”¨CTF_2é‚£ä¸ªæ–¹æ³•æŠŠandroid:debuggable=&quot;true&quot;åŠ ä¸Šï¼Œç„¶åé‡æ–°æ‰“åŒ…ç­¾åï¼Œç„¶åadb install CTF_4.apkçš„æ—¶å€™é‡åˆ°äº†é”™è¯¯ ç»æŸ¥é˜…ï¼Œæ­¤é”™è¯¯æ˜¯android:extractNativeLibs=&quot;false&quot;çš„ç¼˜æ•…ï¼Œæ”¹ä¸ºandroid:extractNativeLibs=&quot;true&quot;å³å¯ï¼Œæˆ‘ä»¬å³åŠ ä¸Šandroid:debuggable=&quot;true&quot; ä¹Ÿè®¾ç½®android:extractNativeLibs=&quot;true&quot;é‡æ–°ç­¾åæ‰“åŒ…ï¼Œå‘ç°å¯ä»¥è°ƒè¯• æ€è€ƒåœ¨ä¸Šä¸€æ­¥è§£å†³é—®é¢˜ä¹‹åï¼Œè¿˜æ˜¯æŸ¥çœ‹mapsæ–‡ä»¶çœ‹åŸºå€¼ï¼Œå½“ç‚¹å‡»æ³¨å†ŒæŒ‰é’®ä¹‹åï¼Œå‘ç°å¯ä»¥å‘ç°åŠ è½½äº†è¿™ä¸ªsoæ–‡ä»¶ï¼Œå¹¶ä¸”å‰é¢æœ‰åŸºå€ï¼Œä¼°è®¡æ˜¯android:extractNativeLibs=&quot;true&quot;çš„åŸå›  æˆ‘æƒ³æµ‹è¯•ï¼Œå¦‚æœä»…ä»…è®¾ç½®android:extractNativeLibs=&quot;true&quot; è€Œ android:debuggable=&quot;false&quot;ä¸å˜çš„æƒ…å†µä¸‹ï¼Œèƒ½ä¸èƒ½é€šè¿‡æ‰‹åŠ¨çš„ä¿®å¤åŸºå€æ¥è¾¾åˆ°IDAè°ƒè¯•soçš„ç›®çš„ï¼Œå¼€å§‹æµ‹è¯•ï¼Œandroid:extractNativeLibs=&quot;true&quot; android:debuggable=&quot;false&quot; é‡æ–°æ‰“åŒ…ç­¾åï¼Œç„¶åå®‰è£…, æ‰‹æœºè¿è¡ŒCTF_4ï¼Œ ç„¶åæŸ¥çœ‹mapsæ–‡ä»¶æœ‰æ²¡æœ‰åŠ è½½é‚£ä¸ªsoæ–‡ä»¶ å¯ä»¥å‘ç°ï¼Œæœç„¶åŠ è½½äº†,ç„¶åå‡†å¤‡è°ƒè¯•ï¼Œæ‰‹æœºç‚¹å‡»æ³¨å†ŒæŒ‰é’®ï¼ŒIDAå¼¹å‡º ç‚¹å‡»sameï¼Œç„¶ååœ¨æ–­ç‚¹é‚£é‡Œæ–­ä¸‹ï¼Œä¸éœ€è¦ä¿®å¤åŸºå€ æ‰€ä»¥ï¼Œå¦‚æœä»…ä»…æ˜¯IDAè°ƒè¯•soçš„è¯ï¼Œä¸éœ€è¦JEBè°ƒè¯•çš„è¯ï¼Œæ ¹æœ¬ä¸éœ€è¦è®¾ç½®android:debuggable=&quot;true&quot;,ä½†æ˜¯å¿…é¡»å¾—android:extractNativeLibs=&quot;true&quot; å¹¶ä¸”è¿™é‡Œè¿™ä¸ªandroid:extractNativeLibs å¦‚æœè®¾ç½®ä¸ºtrueæˆ–falseï¼Œæ„Ÿè§‰æœ‰ç‚¹åƒPEçš„é‚£ä¸ªé™æ€åº“å’ŒåŠ¨æ€åº“ åŠè‡ªåŠ¨è„šæœ¬å†™äº†ä¸ªåŠè‡ªåŠ¨è„šæœ¬ï¼Œè‡ªåŠ¨åŠ debugå±æ€§ï¼Œç„¶åé‡æ–°æ‰“åŒ…ç­¾åï¼Œç¯å¢ƒä¸ºpython3.8 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970import sysimport subprocessimport osfrom xml.dom.minidom import parse# 1ã€å…ˆè§£åŒ…APK# 2ã€æ‰“å¼€xmlæ–‡ä»¶åˆ†æï¼Œandroid:debuggable å’Œ android:extractNativeLibså±æ€§# 3ã€å¦‚æœæ²¡æœ‰android:debuggable,åˆ™å¯ä»¥åŠ å…¥å¹¶ä¸”è®¾ç½®ä¸ºå±æ€§ä¸º true# 4ã€å¦‚æœæœ‰android:debuggableï¼Œ åˆ™ç›´æ¥è®¾ç½®ä¸ºtrue# 5ã€å¦‚æœæ²¡æœ‰android:extractNativeLibs åˆ™ä¸ç®¡ï¼Œå¦‚æœæœ‰ä¸”ä¸ºfalseï¼Œåˆ™æ”¹ä¸ºtrue# 6ã€apktoolé‡æ–°æ‰“åŒ…# 7ã€ç”Ÿæˆç­¾åæ–‡ä»¶# 8ã€å°†ç­¾ååŠ å…¥åˆ°apkä¸­def handle_xml(): # 3,4,5 å¤„ç†XMLæ–‡ä»¶å¹¶å†™å› # AndroidManifest.xml dom = parse(&quot;AndroidManifest.xml&quot;) data = dom.documentElement # android:extractNativeLibs=&quot;true&quot; # android:debuggable=&quot;true&quot; application = data.getElementsByTagName(&quot;application&quot;) print(&quot;[+] æ­£åœ¨ä¿®æ”¹ android:debuggable å±æ€§&quot;) application[0].setAttribute(&quot;android:debuggable&quot;, &quot;true&quot;) if application[0].getAttribute(&quot;android:extractNativeLibs&quot;) == &#x27;false&#x27;: print(&quot;[+] æ­£åœ¨ä¿®æ”¹android:extractNativeLibs å±æ€§&quot;) application[0].setAttribute(&quot;android:extractNativeLibs&quot;, &quot;true&quot;) f = open(&quot;AndroidManifest.xml&quot;, &#x27;w&#x27;) dom.writexml(f, encoding=&quot;utf-8&quot;) f.close() with open(&quot;AndroidManifest.xml&quot;, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f: c = f.read() c = c.replace(&#x27;encoding=&quot;utf-8&quot;&#x27;, &#x27;encoding=&quot;utf-8&quot; standalone=&quot;no&quot;&#x27;) f.close() with open(&quot;AndroidManifest.xml&quot;, &quot;w&quot;, encoding=&quot;utf-8&quot;)as f: f.write(c)if __name__ == &quot;__main__&quot;: if len(sys.argv) != 2: print(&quot;[X] æ ¼å¼æœ‰é”™! pythonåè·Ÿapkåå­—&quot;) sys.exit(-1) apkpath = sys.argv[1] apkname = os.path.splitext(apkpath)[0] apkdirpath = apkname + &quot;_DIR&quot; # 1ã€è§£åŒ…APK print(&quot;[+] è§£åŒ…APKæ–‡ä»¶&quot;) subprocess.run([&#x27;apktool.bat&#x27;, &#x27;d&#x27;, apkpath, &quot;-o&quot;, apkdirpath]) os.chdir(apkdirpath) # 2ã€æ‰“å¼€xmlæ–‡ä»¶ print(&quot;[+] å½“å‰å·¥ä½œè·¯å¾„ä¸º: &quot; + os.getcwd()) handle_xml() print(&quot;[+] ä¿®æ”¹XMLæ–‡ä»¶æˆåŠŸ&quot;) # 6ã€é‡æ–°æ‰“åŒ…ä¸ºAPK os.chdir(&#x27;../&#x27;) print(&quot;[+] é‡æ–°æ‰“åŒ…APKæ–‡ä»¶&quot;) print(&quot;[+] å½“å‰å·¥ä½œè·¯å¾„ä¸º: &quot; + os.getcwd()) apkpath_new = apkname + &quot;_new.apk&quot; subprocess.run([&#x27;apktool.bat&#x27;, &#x27;b&#x27;, apkdirpath, &quot;-o&quot;, apkpath_new]) # 7ã€ç”Ÿæˆç­¾åæ–‡ä»¶ print(&quot;[+] å¯†ç è¯·è¾“å…¥123456ï¼Œå¦åˆ™ä¼šå‡ºé”™&quot;) # keytool -genkey -keystore ç­¾åæ–‡ä»¶çš„æ–‡ä»¶å -keyalg RSA -validity 10000 -alias ç­¾åæ–‡ä»¶åˆ«å subprocess.run([&#x27;keytool&#x27;, &#x27;-genkey&#x27;, &#x27;-keystore&#x27;, apkname + &quot;_new.keystore&quot;, &#x27;-keyalg&#x27;, &#x27;RSA&#x27;, &#x27;-validity&#x27;, &#x27;10000&#x27;, &#x27;-alias&#x27;, apkname]) # 8ã€ç»™APKæ–‡ä»¶æ·»åŠ ç­¾å print(f&quot;[+] ç»™&#123;apkname&#125;_new.apkæ·»åŠ ç­¾å&quot;) subprocess.run([&#x27;jarsigner.exe&#x27;, &#x27;-verbose&#x27;, &#x27;-keystore&#x27;, apkname + &quot;_new.keystore&quot;, &#x27;-storepass&#x27;, &#x27;123456&#x27;, &#x27;-signedjar&#x27;, apkname + &#x27;_new_sign.apk&#x27;, &#x27;-digestalg&#x27;, &#x27;SHA1&#x27;, &#x27;-sigalg&#x27;, &#x27;MD5withRSA&#x27;, apkname + &quot;_new.apk&quot;, apkname]) æ€»ç»“ å¦‚æœæ˜¯JEBè°ƒè¯•ï¼Œå¿…é¡»è®¾ç½®android:debuggable=&quot;true&quot; å¦‚æœä¸ç”¨JEBï¼Œä»…ä»…æ˜¯IDAè°ƒè¯•soæ–‡ä»¶ï¼Œä¸ç”¨å¿…é¡»è®¾ç½®android:debuggable=&quot;true&quot;, ä½†æ˜¯å¿…é¡»å¾—è®¾ç½®android:extractNativeLibs=&quot;true&quot; å‚è€ƒæ–‡ç«  https://www.jianshu.com/p/eb766d2bb837 https://www.jianshu.com/p/879d53256ff3","categories":[{"name":"å®‰å“","slug":"å®‰å“","permalink":"https://zzzzsky.github.io/categories/%E5%AE%89%E5%8D%93/"}],"tags":[{"name":"debug","slug":"debug","permalink":"https://zzzzsky.github.io/tags/debug/"}]},{"title":"Python å¸¸ç”¨æ•°æ®ç±»å‹è½¬æ¢","slug":"pythonå¤„ç†æ•°æ®ç±»å‹","date":"2021-12-03T09:46:00.000Z","updated":"2021-12-03T09:47:22.856Z","comments":true,"path":"2021/12/03/pythonå¤„ç†æ•°æ®ç±»å‹/","link":"","permalink":"https://zzzzsky.github.io/2021/12/03/python%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/","excerpt":"","text":"Python å¸¸ç”¨æ•°æ®ç±»å‹è½¬æ¢åœ¨CTFä¸­ï¼Œç»å¸¸éœ€è¦å„ç§æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢ structæ¨¡å— å®˜æ–¹æ–‡æ¡£: https://docs.python.org/zh-cn/3.10/library/struct.html Cè¯­è¨€æ•°æ®ç»“æ„ä¸python bytesä¹‹é—´çš„è½¬æ¢ â€‹ 12345678910111213141516171819In [1]: import struct In [2]: struct.pack(&quot;&lt;LLLL&quot;, 1,2,3,4) Out[2]: b&#x27;\\x01\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x03\\x00\\x00\\x00\\x04\\x00\\x00\\x00&#x27; In [3]: struct.pack(&quot;&lt;LLLL&quot;,&#x27;a&#x27;,2,3,4) --------------------------------------------------------------------------- error Traceback (most recent call last) &lt;ipython-input-3-e0808e208379&gt; in &lt;module&gt; ----&gt; 1 struct.pack(&quot;&lt;LLLL&quot;,&#x27;a&#x27;,2,3,4) error: required argument is not an integer In [4]: c = struct.pack(&#x27;&lt;I&#x27;, ord(&#x27;a&#x27;)) In [5]: b = struct.unpack(&#x27;&lt;I&#x27;, c) In [6]: b[0] Out[6]: 97 binasciiæ¨¡å—äºŒè¿›åˆ¶å’ŒASCIIä¹‹é—´çš„è½¬æ¢ å®˜æ–¹æ–‡æ¡£: https://docs.python.org/zh-cn/3.7/library/binascii.html 12345678910111213141516In [1]: import binasciiIn [2]: binascii.hexlify(b&#x27;12345&#x27;)Out[2]: b&#x27;3132333435&#x27;In [3]: binascii.hexlify(b&#x27;12345&#x27;, &#x27;-&#x27;)Out[3]: b&#x27;31-32-33-34-35&#x27;In [4]: binascii.unhexlify(b&#x27;3132333435&#x27;)Out[4]: b&#x27;12345&#x27;In [5]: binascii.crc32(b&#x27;123&#x27;)Out[5]: 2286445522In [6]: hex(binascii.crc32(b&#x27;123&#x27;))Out[6]: &#x27;0x884863d2&#x27; è¿›åˆ¶ä¹‹é—´çš„è½¬æ¢1234567891011121314151617In [7]: int(0x12)Out[7]: 18In [8]: int(&#x27;23&#x27;)Out[8]: 23In [9]: int(&#x27;1111&#x27;, 2)Out[9]: 15In [10]: int(&#x27;11&#x27;, 16)Out[10]: 17In [11]: bin(123)Out[11]: &#x27;0b1111011&#x27;In [12]: int(&#x27;1111011&#x27;, 2)Out[12]: 123 byteså’Œæ•°å­—ä¹‹é—´çš„è½¬æ¢1234567891011121314151617181920212223In [17]: from Crypto.Util.number import long_to_bytes, bytes_to_longIn [18]: bytes_to_long(b&#x27;flag&#x27;)Out[18]: 1718378855In [19]: hex(1718378855)Out[19]: &#x27;0x666c6167&#x27;In [20]: from binascii import *In [21]: unhexlify(1718378855)---------------------------------------------------------------------------TypeError Traceback (most recent call last)&lt;ipython-input-21-43c0727e7de8&gt; in &lt;module&gt;----&gt; 1 unhexlify(1718378855)TypeError: argument should be bytes, buffer or ASCII string, not &#x27;int&#x27;In [22]: unhexlify(&#x27;666c6167&#x27;)Out[22]: b&#x27;flag&#x27;In [23]: long_to_bytes(1718378855)Out[23]: b&#x27;flag&#x27; åˆ—è¡¨å’Œbytes,strç±»å‹è½¬æ¢1234567891011121314151617In [28]: a = b&#x27;flag&#x27;In [29]: b = list(a)In [30]: bOut[30]: [102, 108, 97, 103]In [31]: bytes(b)Out[31]: b&#x27;flag&#x27; In [36]: a = list(&quot;flag&quot;)In [37]: aOut[37]: [&#x27;f&#x27;, &#x27;l&#x27;, &#x27;a&#x27;, &#x27;g&#x27;]In [38]: &quot;&quot;.join(a)Out[38]: &#x27;flag&#x27;","categories":[{"name":"python","slug":"python","permalink":"https://zzzzsky.github.io/categories/python/"}],"tags":[{"name":"struct","slug":"struct","permalink":"https://zzzzsky.github.io/tags/struct/"}]},{"title":"2021è¥¿æ¹–è®ºå‰‘_RE_WP","slug":"2021è¥¿æ¹–è®ºå‰‘_RE_WP","date":"2021-12-02T12:37:00.000Z","updated":"2021-12-02T12:37:36.844Z","comments":true,"path":"2021/12/02/2021è¥¿æ¹–è®ºå‰‘_RE_WP/","link":"","permalink":"https://zzzzsky.github.io/2021/12/02/2021%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91_RE_WP/","excerpt":"","text":"2021è¥¿æ¹–è®ºå‰‘_RE_WPTacticalArmedIDAæ‰“å¼€å‘ç°æœ‰TLSå›è°ƒå‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰è°ƒè¯•å°±åˆå§‹åŒ–4ä¸ªå€¼ ç›´æ¥patchï¼Œå¼ºåˆ¶jmpåˆ°4010F1çš„ä½ç½® ç¬¬50è¡Œï¼Œv21é‚£é‡Œæ˜¯æ¯æ¬¡æ‰§è¡Œçš„æŒ‡ä»¤ å†™ODè„šæœ¬ï¼Œåœ¨004014A3å’Œ 40146Dä½ç½®ä¸‹æ–­ç‚¹ï¼ŒODè¿è¡Œè„šæœ¬ï¼Œæ‰“å°å‡ºä¸‹å›¾ä¸­ä¸€è½®æ¥ 12345678910111213141516var fvar xmov f,&quot;C:\\\\Users\\\\ZSKY\\\\Desktop\\\\xihulunjian\\\\log.txt&quot;vv:RUNcmp eip,004014A3je stopcmp eip,40146Djnz vvstiopcode eipeval &quot;&#123;eip&#125; : &#123;$RESULT_1&#125;&quot;wrta f,$RESULTjmp vvstop:pause 1234567891011121314151617181920212223242526272829303132335AC720 : mov ecx,dword ptr ds:[0x405748]5AC720 : sub ecx,0x7E5A96D25AC720 : mov dword ptr ds:[0x405748],ecx5AC720 : mov edx,dword ptr ds:[0x40564C]5AC720 : shr edx,0x55AC720 : mov eax,dword ptr ds:[0x405004]5AC720 : add eax,edx5AC720 : mov ecx,dword ptr ds:[0x405748]5AC720 : add ecx,dword ptr ds:[0x40564C]5AC720 : xor eax,ecx5AC720 : mov edx,dword ptr ds:[0x40564C]5AC720 : shl edx,0x45AC720 : mov ecx,dword ptr ds:[0x405000]5AC720 : add ecx,edx5AC720 : xor eax,ecx5AC720 : mov edx,dword ptr ds:[0x405648]5AC720 : add edx,eax5AC720 : mov dword ptr ds:[0x405648],edx5AC720 : mov eax,dword ptr ds:[0x405648]5AC720 : shr eax,0x55AC720 : mov ecx,dword ptr ds:[0x40500C]5AC720 : add ecx,eax5AC720 : mov edx,dword ptr ds:[0x405748]5AC720 : add edx,dword ptr ds:[0x405648]5AC720 : xor ecx,edx5AC720 : mov eax,dword ptr ds:[0x405648]5AC720 : shl eax,0x45AC720 : mov edx,dword ptr ds:[0x405008]5AC720 : add edx,eax5AC720 : xor ecx,edx5AC720 : mov eax,dword ptr ds:[0x40564C]5AC720 : add eax,ecx5AC720 : mov dword ptr ds:[0x40564C],eax åœ¨IDAä¸­éšä¾¿æ‰¾ä¸ªåœ°æ–¹patchä¸‹ä¸Šé¢æ±‡ç¼–ï¼Œç„¶åF5 ç¨å¾®æ•´ç†æ•´ç† è¿™ä¸å°±æ˜¯teaç»“æ„å—ï¼Œåªä¸è¿‡deltaæ¢äº†ï¼Œç„¶åå¾ªç¯å˜ä¸ºäº†33è½®,æå–å‡ºæ•°æ®å†™è„šæœ¬å³å¯ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;unsigned char enc_flag[] = &#123; 0xED, 0x1D, 0x2F, 0x42, 0x72, 0xE4, 0x85, 0x14, 0xD5, 0x78, 0x55, 0x03, 0xA2, 0x80, 0x6B, 0xBF, 0x45, 0x72, 0xD7, 0x97, 0xD1, 0x75, 0xAE, 0x2D, 0x63, 0xA9, 0x5F, 0x66, 0x74, 0x6D, 0x2E, 0x29, 0xC1, 0xFC, 0x95, 0x97, 0xE9, 0xC8, 0xB5, 0x0B, 0&#125;;uint32_t key[] = &#123; 0x7CE45630, 0x58334908, 0x66398867, 0x0C35195B1&#125;;void decrypt(uint32_t *v, uint32_t *k, uint32_t *pSum)&#123; uint32_t v0 = v[0], v1 = v[1], i; uint32_t delta = 0x7E5A96D2; uint32_t k0 = k[0], k1 = k[1], k2 = k[2], k3 = k[3]; for (i = 0; i &lt; 33; i++) &#123; v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + *pSum) ^ ((v0 &gt;&gt; 5) + k3); v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + *pSum) ^ ((v1 &gt;&gt; 5) + k1); *pSum += delta; &#125; v[0] = v0; v[1] = v1;&#125;int main()&#123; unsigned sum = 0; for (int i = 0; i &lt; 33 * 5; i++) &#123; sum -= 0x7E5A96D2; &#125; uint32_t *pFlag = (uint32_t *)enc_flag; for (int i = 0; i &lt; 5; i++) &#123; decrypt(pFlag + (4 - i) * 2, key, &amp;sum); &#125; printf(&quot;%s&quot;, pFlag); return 0;&#125;# kgD1ogB2yGa2roiAeXiG8_aqnLzCJ_rFHSPrn55K flagä¸º kgD1ogB2yGa2roiAeXiG8_aqnLzCJ_rFHSPrn55K gghdlIDAæ‰“å¼€ç¨‹åº ç›´æ¥F5åˆ†æä¸€æ³¢ case 0æ˜¯è¾“å…¥flagï¼Œcase 5æ˜¯éªŒè¯flagæ˜¯å¦æ­£ç¡®ï¼Œcase 6æ˜¯å¯¹flagä¸­çš„æ¯ä¸ªå­—ç¬¦è¿›è¡ŒåŠ å¯†ï¼Œcase 7æ˜¯å°†åŠ å¯†åçš„æ¯ä¸ªå­—ç¬¦åçš„æ•°æ®ä¸ç¨‹åºä¸­ç”Ÿæˆçš„æ•°æ®æ¯”è¾ƒ è°ƒè¯•èµ·æ¥ åŠ å¯†åv127æŒ‡å‘çš„å€¼ä¸º 2, 3, 2, 2, 2, 2, 2, 3 ï¼Œ è€Œord(â€˜Aâ€™) = 0x41, äºŒè¿›åˆ¶ä¸º 01000001 ä¹Ÿå°±æ˜¯æŠŠ2æ¢ä¸º0ï¼Œ æŠŠ3æ¢ä¸º1 ç„¶åè¿è¡Œæ¥åˆ°case 7çš„ä½ç½® v126çš„å€¼ä¸º3, 3, 2, 3, 3, 3, 2, 3 è½¬ä¸ºäºŒè¿›åˆ¶ 0b11011101 1234Python&gt;0b110111010xddPython&gt;0xdd ^ ord(&#x27;A&#x27;)0x9c ç„¶åä¸‹é¢çš„åŒç†ï¼Œå‘ç°å…¨éƒ½æ˜¯xor 0x9c, ä¸€æ­¥æ­¥è°ƒè¯•å°†å¯¹æ¯”çš„æ•°æ®v123æå–å‡ºæ¥ï¼Œç„¶å3å˜ä¸º1ï¼Œ2å˜ä¸º0ï¼Œè½¬ä¸º2è¿›åˆ¶ï¼Œå†xor 0x9cå³ä¸ºflag 1234567enc = [0b11011000, 0b11011101, 0b11001111, 0b11011111, 0b11001000, 0b11011010, 0b11100111, 0b10101100, 0b10101010, 0b10101110, 0b10100101, 0b10101101, 0b10100101, 0b10101010, 0b10101110, 0b10110001, 0b11111101, 0b11111110, 0b11111101, 0b11111000, 0b10110001, 0b10101000, 0b10101100, 0b11111111, 0b10100100, 0b10110001, 0b10100100, 0b10101111, 0b10101101, 0b10100100, 0b10110001, 0b11111010, 0b10101100, 0b11111101, 0b10101010, 0b11111110, 0b10101101, 0b10100100, 0b10101010, 0b10101000, 0b10100100, 0b10101110, 0b11111111, 0b11100001]flag = [chr(i ^ 0x9c) for i in enc]print(&quot;&quot;.join(flag))# DASCTF&#123;06291962-abad-40c8-8318-f0a6b186482c&#125; éªŒè¯ä¸‹ flagæ­£ç¡®ï¼Œflagä¸º DASCTF&#123;06291962-abad-40c8-8318-f0a6b186482c&#125; RORIDAæ‰“å¼€åˆ†æ å…ˆæ‰¾å‡ºbyte_405000çš„ç´¢å¼•ï¼Œç„¶åZ3è§£å³å¯ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667from z3 import *ENC_FLAG = [0x65, 0x55, 0x24, 0x36, 0x9D, 0x71, 0xB8, 0xC8, 0x65, 0xFB, 0x87, 0x7F, 0x9A, 0x9C, 0xB1, 0xDF, 0x65, 0x8F, 0x9D, 0x39, 0x8F, 0x11, 0xF6, 0x8E, 0x65, 0x42, 0xDA, 0xB4, 0x8C, 0x39, 0xFB, 0x99, 0x65, 0x48, 0x6A, 0xCA, 0x63, 0xE7, 0xA4, 0x79]byte_405000 = [0x65, 0x08, 0xF7, 0x12, 0xBC, 0xC3, 0xCF, 0xB8, 0x83, 0x7B, 0x02, 0xD5, 0x34, 0xBD, 0x9F, 0x33, 0x77, 0x76, 0xD4, 0xD7, 0xEB, 0x90, 0x89, 0x5E, 0x54, 0x01, 0x7D, 0xF4, 0x11, 0xFF, 0x99, 0x49, 0xAD, 0x57, 0x46, 0x67, 0x2A, 0x9D, 0x7F, 0xD2, 0xE1, 0x21, 0x8B, 0x1D, 0x5A, 0x91, 0x38, 0x94, 0xF9, 0x0C, 0x00, 0xCA, 0xE8, 0xCB, 0x5F, 0x19, 0xF6, 0xF0, 0x3C, 0xDE, 0xDA, 0xEA, 0x9C, 0x14, 0x75, 0xA4, 0x0D, 0x25, 0x58, 0xFC, 0x44, 0x86, 0x05, 0x6B, 0x43, 0x9A, 0x6D, 0xD1, 0x63, 0x98, 0x68, 0x2D, 0x52, 0x3D, 0xDD, 0x88, 0xD6, 0xD0, 0xA2, 0xED, 0xA5, 0x3B, 0x45, 0x3E, 0xF2, 0x22, 0x06, 0xF3, 0x1A, 0xA8, 0x09, 0xDC, 0x7C, 0x4B, 0x5C, 0x1E, 0xA1, 0xB0, 0x71, 0x04, 0xE2, 0x9B, 0xB7, 0x10, 0x4E, 0x16, 0x23, 0x82, 0x56, 0xD8, 0x61, 0xB4, 0x24, 0x7E, 0x87, 0xF8, 0x0A, 0x13, 0xE3, 0xE4, 0xE6, 0x1C, 0x35, 0x2C, 0xB1, 0xEC, 0x93, 0x66, 0x03, 0xA9, 0x95, 0xBB, 0xD3, 0x51, 0x39, 0xE7, 0xC9, 0xCE, 0x29, 0x72, 0x47, 0x6C, 0x70, 0x15, 0xDF, 0xD9, 0x17, 0x74, 0x3F, 0x62, 0xCD, 0x41, 0x07, 0x73, 0x53, 0x85, 0x31, 0x8A, 0x30, 0xAA, 0xAC, 0x2E, 0xA3, 0x50, 0x7A, 0xB5, 0x8E, 0x69, 0x1F, 0x6A, 0x97, 0x55, 0x3A, 0xB2, 0x59, 0xAB, 0xE0, 0x28, 0xC0, 0xB3, 0xBE, 0xCC, 0xC6, 0x2B, 0x5B, 0x92, 0xEE, 0x60, 0x20, 0x84, 0x4D, 0x0F, 0x26, 0x4A, 0x48, 0x0B, 0x36, 0x80, 0x5D, 0x6F, 0x4C, 0xB9, 0x81, 0x96, 0x32, 0xFD, 0x40, 0x8D, 0x27, 0xC1, 0x78, 0x4F, 0x79, 0xC8, 0x0E, 0x8C, 0xE5, 0x9E, 0xAE, 0xBF, 0xEF, 0x42, 0xC5, 0xAF, 0xA0, 0xC2, 0xFA, 0xC7, 0xB6, 0xDB, 0x18, 0xC4, 0xA6, 0xFE, 0xE9, 0xF5, 0x6E, 0x64, 0x2F, 0xF1, 0x1B, 0xFB, 0xBA, 0xA7, 0x37, 0x8F]indexs = []for i in range(len(ENC_FLAG)): indexs.append(byte_405000.index(ENC_FLAG[i]))v6 = [0] * 8v6[0] = 128v6[1] = 64v6[2] = 32v6[3] = 16v6[4] = 8v6[5] = 4v6[6] = 2v6[7] = 1flag = [BitVec(&quot;flag%d&quot; % i, 8) for i in range(40)]s = Solver()for i in range(0, 40, 8): for j in range(8): v5 = ((v6[j] &amp; flag[i + 3]) &lt;&lt; (8 - (3 - j) % 8)) | ((v6[j] &amp; flag[i + 3]) &gt;&gt; ((3 - j) % 8)) | ((v6[j] &amp; flag[i + 2]) &lt;&lt; (8 - (2 - j) % 8)) | ((v6[j] &amp; flag[i + 2]) &gt;&gt; ((2 - j) % 8)) | ((v6[j] &amp; flag[i + 1]) &lt;&lt; (8 - (1 - j) % 8)) | ((v6[j] &amp; flag[i + 1]) &gt;&gt; ((1 - j) % 8)) | ((v6[j] &amp; flag[i]) &lt;&lt; (8 - -j % 8)) | ((v6[j] &amp; flag[i]) &gt;&gt; (-j % 8)) index = ((v6[j] &amp; flag[i + 7]) &lt;&lt; (8 - (7 - j) % 8)) | ((v6[j] &amp; flag[i + 7]) &gt;&gt; ((7 - j) % 8)) | ((v6[j] &amp; flag[i + 6]) &lt;&lt; (8 - (6 - j) % 8)) | ((v6[j] &amp; flag[i + 6]) &gt;&gt; ((6 - j) % 8) ) | ((v6[j] &amp; flag[i + 5]) &lt;&lt; (8 - (5 - j) % 8)) | ((v6[j] &amp; flag[i + 5]) &gt;&gt; ((5 - j) % 8)) | ((v6[j] &amp; flag[i + 4]) &lt;&lt; (8 - (4 - j) % 8)) | ((v6[j] &amp; flag[i + 4]) &gt;&gt; ((4 - j) % 8)) | v5 s.add(index == indexs[i+j])assert s.check() == satm = s.model()flag = [chr(m[i].as_long()) for i in flag]print(&quot;DASCTF&#123;&quot; + &quot;&quot;.join(flag) + &quot;&#125;&quot;)# DASCTF&#123;Q5la5_3KChtem6_HYHk_NlHhNZz73aCZeK05II96&#125; è™šå‡çš„ç²‰ä¸IDAæ‰“å¼€ç¨‹åºåˆ†æ \\ è¾“å…¥3ä¸ªæ•°å­— æ–‡ä»¶åºå· è¯»å–æ­¤æ–‡ä»¶çš„åç§» ä»åç§»å¤„è¯»å¤šå°‘ä¸ªå­—èŠ‚ ç„¶åä¸‹é¢åˆ¤æ–­è¯»å–çš„æ•°æ®Buffer[0] != &#39;U&#39; || Buffer[39] != &#39;S&#39; å†™è„šæœ¬åˆ¤æ–­å“ªä¸ªæ–‡ä»¶å«æœ‰è¿™2ä¸ªå­—æ¯ 12345678for i in range(1, 5317): filename = &quot;f/ASCII-faded &quot; + str(i).zfill(4) + &quot;.txt&quot; f = open(filename, &#x27;r&#x27;, encoding=&quot;utf-8&quot;) c = f.read() if &#x27;U&#x27; in c and &#x27;S&#x27; in c: print(filename) f.close()# f/ASCII-faded 4157.txt äºæ˜¯æ‰“å¼€æ‰¾åˆ°äº† UzNDcmU3X0szeSUyMCUzRCUyMEFsNE5fd0FsSzNS å°†å…¶base64è§£å¯†ä¸ºS3Cre7_K3y%20%3D%20Al4N_wAlK3R URL_decodeåä¸º S3Cre7_K3y = Al4N_wAlK3R åç§»æ˜¯0x45E(1118), è¾“å…¥çš„ä¸‰ä¸ªæ•°å­—æ˜¯4157, 1118, 40ï¼Œç„¶åè¾“å…¥ Al4N_wAlK3R æœ€ç»ˆ/f/ASCII-faded 5315.txt ä¼šè¢«è§£å¯†ï¼Œæ‰“å¼€å³å¯çœ‹åˆ°flag flagä¸º A_TrUe_AW_f4ns é¢˜ç›®é™„ä»¶é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Manwxlun-0gK4ZdkzBU0Zwæå–ç ï¼šsj8s","categories":[{"name":"CTF","slug":"CTF","permalink":"https://zzzzsky.github.io/categories/CTF/"}],"tags":[{"name":"CTFWP","slug":"CTFWP","permalink":"https://zzzzsky.github.io/tags/CTFWP/"},{"name":"z3","slug":"z3","permalink":"https://zzzzsky.github.io/tags/z3/"}]},{"title":"NCTF2021_RE_WP","slug":"NCTF2021_RE_WP","date":"2021-11-29T06:41:34.000Z","updated":"2021-11-29T11:44:44.992Z","comments":true,"path":"2021/11/29/NCTF2021_RE_WP/","link":"","permalink":"https://zzzzsky.github.io/2021/11/29/NCTF2021_RE_WP/","excerpt":"","text":"NCTF2021_RE_WPHello ã›ã‹ã„è®°äº‹æœ¬éƒ½èƒ½åšçš„é¢˜.IDAæ‰“å¼€ç›´æ¥çœ‹åˆ°flag flagä¸º NCTF&#123;We1come_2_Reverse_Engineering&#125; Shadowbringerbase64æ¢äº†2æ¬¡è¡¨ï¼Œè°ƒè¯•èµ·æ¥æ‰¾åˆ°è¡¨ï¼Œé€†å›å»å³å¯ å†™è„šæœ¬è§£å¯† 1234567891011121314import base64flag = &quot;U&gt;F2UsQXN`5sXMELT=:7M_2&lt;X]^1ThaWF0=KM?9IUhAsTM5:T==_Ns&amp;&lt;Vhb!&quot;std_table = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;my_table = &#x27;#$%&amp;\\x27()*+,-.s0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[h]^_`ab&#x27;my_table2 = &#x27;ba`_^]h[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210s.-,+*)(\\x27&amp;%$#&#x27;flag = flag.translate(str.maketrans(my_table2, std_table))flag = flag.replace(&quot;!&quot;, &#x27;=&#x27;).encode() # &quot;6G074JP+s)WV:Z+T&lt;&amp;(Q18`Ks)WV:Y4hs9[h:YCS?&amp;0`&quot;flag = base64.b64decode(flag).decode()flag = flag.translate(str.maketrans(my_table, std_table))print(base64.b64decode(flag))# NCTF&#123;H0m3_r1d1n9_h0m3_dy1n9_h0p3&#125; flag ä¸º NCTF&#123;H0m3_r1d1n9_h0m3_dy1n9_h0p3&#125; é²¨é²¨çš„ç§˜å¯†è¿™ä¸ªé¢˜è·Ÿè¥¿æ¹–è®ºå‰‘é‚£ä¸ªç¬¬ä¸€ä¸ªREé¢˜å¥½åƒ loc_404E3Bä¸ºæ‰§è¡Œçš„æŒ‡ä»¤ï¼Œå› ä¸ºæ¯æ¬¡å°±33æ¡æ±‡ç¼–ï¼Œä¹Ÿä¸é•¿ï¼Œç›´æ¥è°ƒè¯•æŠŠç¬¬ä¸€è½®æ‰€æœ‰çš„æ±‡ç¼–æ‹¿å‡ºæ¥åˆ†æ 12345678910111213141516171819202122232425262728293031323334mov ds:dword_404E50, 0FFFFFFFFh # dword_404E50 = -1mov ecx, ds:Imov dl, [ecx+4049F8h] # flag[0]mov byte ptr ds:dword_404E4C, dl movzx eax, byte ptr ds:dword_404E4Cxor eax, ds:dword_404E50 dword_404E4C = (flag[0] ^ 404E50 ) &amp; 0xFFmov byte ptr ds:dword_404E4C, almovzx ecx, byte ptr ds:dword_404E4Cand ecx, 0FFh dword_404E50 &gt;&gt;= 8mov byte ptr ds:dword_404E4C, clmov edx, ds:dword_404E50 dword_404E50 ^= dword_404A38[dword_404E4C * 4]shr edx, 8mov ds:dword_404E50, edxmovzx eax, byte ptr ds:dword_404E4Cmov ecx, ds:dword_404E50xor ecx, ds:dword_404A38[eax*4]mov ds:dword_404E50, ecxmov edx, ds:Imov al, [edx+4049F9h] # flag[1]mov byte ptr ds:dword_404E4C, almovzx ecx, byte ptr ds:dword_404E4Cxor ecx, ds:dword_404E50 404E4C = flag[1] ^ 404E50mov byte ptr ds:dword_404E4C, clmov edx, ds:dword_404E50 shr edx, 8 dword_404E50 &gt;&gt;= 8mov ds:dword_404E50, edxmovzx eax, byte ptr ds:dword_404E4Cmov ecx, ds:dword_404E50xor ecx, ds:dword_404A38[eax*4] dword_404E50 ^= dword_404A38[dword_404E4C * 4]mov ds:dword_404E50, ecxmov edx, ds:dword_404E50xor edx, 0FFFFFFFFhmov ds:dword_404E50, edx åˆ†æå®Œæ¯•ï¼ŒæŠŠç¨‹åºä¸­åŠ å¯†åçš„flagæå–å‡ºæ¥ç›´æ¥çˆ†ç ´ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156#include &lt;stdio.h&gt;#include &lt;windows.h&gt;unsigned char byte_404A38[] =&#123; 0x00, 0x00, 0x00, 0x00, 0x96, 0x30, 0x07, 0x77, 0x2C, 0x61, 0x0E, 0xEE, 0xBA, 0x51, 0x09, 0x99, 0x19, 0xC4, 0x6D, 0x07, 0x8F, 0xF4, 0x6A, 0x70, 0x35, 0xA5, 0x63, 0xE9, 0xA3, 0x95, 0x64, 0x9E, 0x32, 0x88, 0xDB, 0x0E, 0xA4, 0xB8, 0xDC, 0x79, 0x1E, 0xE9, 0xD5, 0xE0, 0x88, 0xD9, 0xD2, 0x97, 0x2B, 0x4C, 0xB6, 0x09, 0xBD, 0x7C, 0xB1, 0x7E, 0x07, 0x2D, 0xB8, 0xE7, 0x91, 0x1D, 0xBF, 0x90, 0x64, 0x10, 0xB7, 0x1D, 0xF2, 0x20, 0xB0, 0x6A, 0x48, 0x71, 0xB9, 0xF3, 0xDE, 0x41, 0xBE, 0x84, 0x7D, 0xD4, 0xDA, 0x1A, 0xEB, 0xE4, 0xDD, 0x6D, 0x51, 0xB5, 0xD4, 0xF4, 0xC7, 0x85, 0xD3, 0x83, 0x56, 0x98, 0x6C, 0x13, 0xC0, 0xA8, 0x6B, 0x64, 0x7A, 0xF9, 0x62, 0xFD, 0xEC, 0xC9, 0x65, 0x8A, 0x4F, 0x5C, 0x01, 0x14, 0xD9, 0x6C, 0x06, 0x63, 0x63, 0x3D, 0x0F, 0xFA, 0xF5, 0x0D, 0x08, 0x8D, 0xC8, 0x20, 0x6E, 0x3B, 0x5E, 0x10, 0x69, 0x4C, 0xE4, 0x41, 0x60, 0xD5, 0x72, 0x71, 0x67, 0xA2, 0xD1, 0xE4, 0x03, 0x3C, 0x47, 0xD4, 0x04, 0x4B, 0xFD, 0x85, 0x0D, 0xD2, 0x6B, 0xB5, 0x0A, 0xA5, 0xFA, 0xA8, 0xB5, 0x35, 0x6C, 0x98, 0xB2, 0x42, 0xD6, 0xC9, 0xBB, 0xDB, 0x40, 0xF9, 0xBC, 0xAC, 0xE3, 0x6C, 0xD8, 0x32, 0x75, 0x5C, 0xDF, 0x45, 0xCF, 0x0D, 0xD6, 0xDC, 0x59, 0x3D, 0xD1, 0xAB, 0xAC, 0x30, 0xD9, 0x26, 0x3A, 0x00, 0xDE, 0x51, 0x80, 0x51, 0xD7, 0xC8, 0x16, 0x61, 0xD0, 0xBF, 0xB5, 0xF4, 0xB4, 0x21, 0x23, 0xC4, 0xB3, 0x56, 0x99, 0x95, 0xBA, 0xCF, 0x0F, 0xA5, 0xBD, 0xB8, 0x9E, 0xB8, 0x02, 0x28, 0x08, 0x88, 0x05, 0x5F, 0xB2, 0xD9, 0x0C, 0xC6, 0x24, 0xE9, 0x0B, 0xB1, 0x87, 0x7C, 0x6F, 0x2F, 0x11, 0x4C, 0x68, 0x58, 0xAB, 0x1D, 0x61, 0xC1, 0x3D, 0x2D, 0x66, 0xB6, 0x90, 0x41, 0xDC, 0x76, 0x06, 0x71, 0xDB, 0x01, 0xBC, 0x20, 0xD2, 0x98, 0x2A, 0x10, 0xD5, 0xEF, 0x89, 0x85, 0xB1, 0x71, 0x1F, 0xB5, 0xB6, 0x06, 0xA5, 0xE4, 0xBF, 0x9F, 0x33, 0xD4, 0xB8, 0xE8, 0xA2, 0xC9, 0x07, 0x78, 0x34, 0xF9, 0x00, 0x0F, 0x8E, 0xA8, 0x09, 0x96, 0x18, 0x98, 0x0E, 0xE1, 0xBB, 0x0D, 0x6A, 0x7F, 0x2D, 0x3D, 0x6D, 0x08, 0x97, 0x6C, 0x64, 0x91, 0x01, 0x5C, 0x63, 0xE6, 0xF4, 0x51, 0x6B, 0x6B, 0x62, 0x61, 0x6C, 0x1C, 0xD8, 0x30, 0x65, 0x85, 0x4E, 0x00, 0x62, 0xF2, 0xED, 0x95, 0x06, 0x6C, 0x7B, 0xA5, 0x01, 0x1B, 0xC1, 0xF4, 0x08, 0x82, 0x57, 0xC4, 0x0F, 0xF5, 0xC6, 0xD9, 0xB0, 0x65, 0x50, 0xE9, 0xB7, 0x12, 0xEA, 0xB8, 0xBE, 0x8B, 0x7C, 0x88, 0xB9, 0xFC, 0xDF, 0x1D, 0xDD, 0x62, 0x49, 0x2D, 0xDA, 0x15, 0xF3, 0x7C, 0xD3, 0x8C, 0x65, 0x4C, 0xD4, 0xFB, 0x58, 0x61, 0xB2, 0x4D, 0xCE, 0x51, 0xB5, 0x3A, 0x74, 0x00, 0xBC, 0xA3, 0xE2, 0x30, 0xBB, 0xD4, 0x41, 0xA5, 0xDF, 0x4A, 0xD7, 0x95, 0xD8, 0x3D, 0x6D, 0xC4, 0xD1, 0xA4, 0xFB, 0xF4, 0xD6, 0xD3, 0x6A, 0xE9, 0x69, 0x43, 0xFC, 0xD9, 0x6E, 0x34, 0x46, 0x88, 0x67, 0xAD, 0xD0, 0xB8, 0x60, 0xDA, 0x73, 0x2D, 0x04, 0x44, 0xE5, 0x1D, 0x03, 0x33, 0x5F, 0x4C, 0x0A, 0xAA, 0xC9, 0x7C, 0x0D, 0xDD, 0x3C, 0x71, 0x05, 0x50, 0xAA, 0x41, 0x02, 0x27, 0x10, 0x10, 0x0B, 0xBE, 0x86, 0x20, 0x0C, 0xC9, 0x25, 0xB5, 0x68, 0x57, 0xB3, 0x85, 0x6F, 0x20, 0x09, 0xD4, 0x66, 0xB9, 0x9F, 0xE4, 0x61, 0xCE, 0x0E, 0xF9, 0xDE, 0x5E, 0x98, 0xC9, 0xD9, 0x29, 0x22, 0x98, 0xD0, 0xB0, 0xB4, 0xA8, 0xD7, 0xC7, 0x17, 0x3D, 0xB3, 0x59, 0x81, 0x0D, 0xB4, 0x2E, 0x3B, 0x5C, 0xBD, 0xB7, 0xAD, 0x6C, 0xBA, 0xC0, 0x20, 0x83, 0xB8, 0xED, 0xB6, 0xB3, 0xBF, 0x9A, 0x0C, 0xE2, 0xB6, 0x03, 0x9A, 0xD2, 0xB1, 0x74, 0x39, 0x47, 0xD5, 0xEA, 0xAF, 0x77, 0xD2, 0x9D, 0x15, 0x26, 0xDB, 0x04, 0x83, 0x16, 0xDC, 0x73, 0x12, 0x0B, 0x63, 0xE3, 0x84, 0x3B, 0x64, 0x94, 0x3E, 0x6A, 0x6D, 0x0D, 0xA8, 0x5A, 0x6A, 0x7A, 0x0B, 0xCF, 0x0E, 0xE4, 0x9D, 0xFF, 0x09, 0x93, 0x27, 0xAE, 0x00, 0x0A, 0xB1, 0x9E, 0x07, 0x7D, 0x44, 0x93, 0x0F, 0xF0, 0xD2, 0xA3, 0x08, 0x87, 0x68, 0xF2, 0x01, 0x1E, 0xFE, 0xC2, 0x06, 0x69, 0x5D, 0x57, 0x62, 0xF7, 0xCB, 0x67, 0x65, 0x80, 0x71, 0x36, 0x6C, 0x19, 0xE7, 0x06, 0x6B, 0x6E, 0x76, 0x1B, 0xD4, 0xFE, 0xE0, 0x2B, 0xD3, 0x89, 0x5A, 0x7A, 0xDA, 0x10, 0xCC, 0x4A, 0xDD, 0x67, 0x6F, 0xDF, 0xB9, 0xF9, 0xF9, 0xEF, 0xBE, 0x8E, 0x43, 0xBE, 0xB7, 0x17, 0xD5, 0x8E, 0xB0, 0x60, 0xE8, 0xA3, 0xD6, 0xD6, 0x7E, 0x93, 0xD1, 0xA1, 0xC4, 0xC2, 0xD8, 0x38, 0x52, 0xF2, 0xDF, 0x4F, 0xF1, 0x67, 0xBB, 0xD1, 0x67, 0x57, 0xBC, 0xA6, 0xDD, 0x06, 0xB5, 0x3F, 0x4B, 0x36, 0xB2, 0x48, 0xDA, 0x2B, 0x0D, 0xD8, 0x4C, 0x1B, 0x0A, 0xAF, 0xF6, 0x4A, 0x03, 0x36, 0x60, 0x7A, 0x04, 0x41, 0xC3, 0xEF, 0x60, 0xDF, 0x55, 0xDF, 0x67, 0xA8, 0xEF, 0x8E, 0x6E, 0x31, 0x79, 0xBE, 0x69, 0x46, 0x8C, 0xB3, 0x61, 0xCB, 0x1A, 0x83, 0x66, 0xBC, 0xA0, 0xD2, 0x6F, 0x25, 0x36, 0xE2, 0x68, 0x52, 0x95, 0x77, 0x0C, 0xCC, 0x03, 0x47, 0x0B, 0xBB, 0xB9, 0x16, 0x02, 0x22, 0x2F, 0x26, 0x05, 0x55, 0xBE, 0x3B, 0xBA, 0xC5, 0x28, 0x0B, 0xBD, 0xB2, 0x92, 0x5A, 0xB4, 0x2B, 0x04, 0x6A, 0xB3, 0x5C, 0xA7, 0xFF, 0xD7, 0xC2, 0x31, 0xCF, 0xD0, 0xB5, 0x8B, 0x9E, 0xD9, 0x2C, 0x1D, 0xAE, 0xDE, 0x5B, 0xB0, 0xC2, 0x64, 0x9B, 0x26, 0xF2, 0x63, 0xEC, 0x9C, 0xA3, 0x6A, 0x75, 0x0A, 0x93, 0x6D, 0x02, 0xA9, 0x06, 0x09, 0x9C, 0x3F, 0x36, 0x0E, 0xEB, 0x85, 0x67, 0x07, 0x72, 0x13, 0x57, 0x00, 0x05, 0x82, 0x4A, 0xBF, 0x95, 0x14, 0x7A, 0xB8, 0xE2, 0xAE, 0x2B, 0xB1, 0x7B, 0x38, 0x1B, 0xB6, 0x0C, 0x9B, 0x8E, 0xD2, 0x92, 0x0D, 0xBE, 0xD5, 0xE5, 0xB7, 0xEF, 0xDC, 0x7C, 0x21, 0xDF, 0xDB, 0x0B, 0xD4, 0xD2, 0xD3, 0x86, 0x42, 0xE2, 0xD4, 0xF1, 0xF8, 0xB3, 0xDD, 0x68, 0x6E, 0x83, 0xDA, 0x1F, 0xCD, 0x16, 0xBE, 0x81, 0x5B, 0x26, 0xB9, 0xF6, 0xE1, 0x77, 0xB0, 0x6F, 0x77, 0x47, 0xB7, 0x18, 0xE6, 0x5A, 0x08, 0x88, 0x70, 0x6A, 0x0F, 0xFF, 0xCA, 0x3B, 0x06, 0x66, 0x5C, 0x0B, 0x01, 0x11, 0xFF, 0x9E, 0x65, 0x8F, 0x69, 0xAE, 0x62, 0xF8, 0xD3, 0xFF, 0x6B, 0x61, 0x45, 0xCF, 0x6C, 0x16, 0x78, 0xE2, 0x0A, 0xA0, 0xEE, 0xD2, 0x0D, 0xD7, 0x54, 0x83, 0x04, 0x4E, 0xC2, 0xB3, 0x03, 0x39, 0x61, 0x26, 0x67, 0xA7, 0xF7, 0x16, 0x60, 0xD0, 0x4D, 0x47, 0x69, 0x49, 0xDB, 0x77, 0x6E, 0x3E, 0x4A, 0x6A, 0xD1, 0xAE, 0xDC, 0x5A, 0xD6, 0xD9, 0x66, 0x0B, 0xDF, 0x40, 0xF0, 0x3B, 0xD8, 0x37, 0x53, 0xAE, 0xBC, 0xA9, 0xC5, 0x9E, 0xBB, 0xDE, 0x7F, 0xCF, 0xB2, 0x47, 0xE9, 0xFF, 0xB5, 0x30, 0x1C, 0xF2, 0xBD, 0xBD, 0x8A, 0xC2, 0xBA, 0xCA, 0x30, 0x93, 0xB3, 0x53, 0xA6, 0xA3, 0xB4, 0x24, 0x05, 0x36, 0xD0, 0xBA, 0x93, 0x06, 0xD7, 0xCD, 0x29, 0x57, 0xDE, 0x54, 0xBF, 0x67, 0xD9, 0x23, 0x2E, 0x7A, 0x66, 0xB3, 0xB8, 0x4A, 0x61, 0xC4, 0x02, 0x1B, 0x68, 0x5D, 0x94, 0x2B, 0x6F, 0x2A, 0x37, 0xBE, 0x0B, 0xB4, 0xA1, 0x8E, 0x0C, 0xC3, 0x1B, 0xDF, 0x05, 0x5A, 0x8D, 0xEF, 0x02, 0x2D&#125;;unsigned char compare[] = &#123; 0x5E, 0x60, 0xF6, 0xC0, 0x0A, 0x6E, 0xB1, 0x00, 0xD2, 0xA2, 0x19, 0x33, 0xB7, 0xB7, 0xCA, 0x57, 0x9C, 0x6D, 0x64, 0x9A, 0x26, 0x27, 0xD8, 0xBD, 0x91, 0xFB, 0x38, 0xD8, 0xB3, 0x0B, 0xE1, 0x8D, 0xAD, 0x0D, 0x6B, 0x17, 0xEF, 0xDE, 0x5F, 0x68, 0xB1, 0xF7, 0x1F, 0x2C, 0x96, 0x42, 0x44, 0x6C, 0x90, 0xFE, 0x5C, 0xA1, 0x21, 0x87, 0xCD, 0x20, 0xE8, 0x7C, 0x96, 0x62, 0xFD, 0x41, 0x16, 0x2C, 0x9A, 0x0F, 0x2D, 0x57, 0x2C, 0xDC, 0x52, 0xAE, 0xCF, 0x7D, 0x49, 0x50, 0x4A, 0xBF, 0x6A, 0xFF&#125;;int main() &#123; DWORD* dword_404A38 = (DWORD*)byte_404A38; DWORD* dwcompare = (DWORD*)compare; char flag[40] = &#123;0&#125;; for (int k = 0; k &lt; 40; k+=2) &#123; for (int i = 32; i &lt; 128; i++) &#123; for (int j = 32; j &lt; 128; j++) &#123; flag[0] = i; flag[1] = j; DWORD dword_404E50 = 0xFFFFFFFF; DWORD dword_404E4C = (flag[0] ^ dword_404E50) &amp; 0xFF; dword_404E50 &gt;&gt;= 8; dword_404E50 ^= dword_404A38[dword_404E4C]; dword_404E4C = (flag[1] ^ dword_404E50) &amp; 0Xff; dword_404E50 &gt;&gt;= 8; dword_404E50 ^= dword_404A38[dword_404E4C]; dword_404E50 = 0xFFFFFFFF - dword_404E50; if (dword_404E50 == dwcompare[k/2]) &#123; printf(&quot;%c%c&quot;, i, j); &#125; &#125; &#125; &#125; return 0;&#125; flagä¸º NCTF&#123;rLdE57TG0iHA39qUnFZp6LeJyYEBcxMNL7&#125; ç‹—ç‹—çš„ç§˜å¯† å‰é¢æ˜¯47è¿›åˆ¶ï¼Œç›´æ¥ç”¨Cè¯­è¨€å®ç°ä¸Šé¢é‚£ä¸ªæ¡†ä¸­çš„ç®—æ³•ï¼Œè°ƒè¯•ï¼Œè¾“å‡ ä¸ªæ•°è¯•è¯•å°±èƒ½è¯•å‡ºæ¥äº† å…ˆå†™è„šæœ¬ä»ä¸‹å¾€ä¸ŠæŠŠ47è¿›åˆ¶åçš„flagå¼„å‡ºæ¥ï¼Œå‘ç°æœ‰å¾ˆå¤šç§æƒ…å†µ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253byte_405018 = [ 0x21, 0x43, 0x65, 0x87, 0x09, 0x21, 0x43, 0x65, 0xA2, 0x9B, 0xF4, 0xDF, 0xAC, 0x7C, 0xA1, 0xC6, 0x16, 0xD0, 0x0F, 0xDD, 0xDC, 0x73, 0xC5, 0x6B, 0xD1, 0x96, 0x47, 0xC2, 0x26, 0x67, 0x4E, 0x41, 0x82, 0x20, 0x56, 0x9A, 0x6E, 0x33, 0x92, 0x88, 0x29, 0xB5, 0xB4, 0x71, 0xA9, 0xCE, 0xC3, 0x34, 0x50, 0x59, 0xBF, 0x2D, 0x57, 0x22, 0xA6, 0x30, 0x04, 0xB2, 0xCD, 0x36, 0xD5, 0x68, 0x4D, 0x5B, 0x45, 0x9E, 0x85, 0xCF, 0x9D, 0xCC, 0x61, 0x78, 0x32, 0x76, 0x31, 0xE3, 0x80, 0xAD, 0x39, 0x4F, 0xFA, 0x72, 0x83, 0x4C, 0x86, 0x60, 0xB7, 0xD7, 0x63, 0x0C, 0x44, 0x35, 0xB3, 0x7B, 0x19, 0xD4, 0x69, 0x08, 0x0B, 0x1F, 0x3D, 0x11, 0x79, 0xD3, 0xEE, 0x93, 0x42, 0xDE, 0x23, 0x3B, 0x5D, 0x8D, 0xA5, 0x77, 0x5F, 0x58, 0xDB, 0x97, 0xF6, 0x7A, 0x18, 0x52, 0x15, 0x74, 0x25, 0x62, 0x2C, 0x05, 0xE8, 0x0D, 0x98, 0x2A, 0x43, 0xE2, 0xEF, 0x48, 0x87, 0x49, 0x1C, 0xCA, 0x2B, 0xA7, 0x8A, 0x09, 0x81, 0xE7, 0x53, 0xAA, 0xFF, 0x6F, 0x8E, 0x91, 0xF1, 0xF0, 0xA4, 0x46, 0x3A, 0x7D, 0x54, 0xEB, 0x2F, 0xC1, 0xC0, 0x0E, 0xBD, 0xE1, 0x6C, 0x64, 0xBE, 0xE4, 0x02, 0x3C, 0x5A, 0xA8, 0x9F, 0x37, 0xAF, 0xA0, 0x13, 0xED, 0x1B, 0xEC, 0x8B, 0x3E, 0x7E, 0x27, 0x99, 0x75, 0xAB, 0xFE, 0xD9, 0x3F, 0xF3, 0xEA, 0x70, 0xF7, 0x95, 0xBA, 0x1D, 0x40, 0xB0, 0xF9, 0xE5, 0xF8, 0x06, 0xBC, 0xB6, 0x03, 0xC9, 0x10, 0x9C, 0x2E, 0x89, 0x5C, 0x7F, 0xB1, 0x1A, 0xD6, 0x90, 0xAE, 0xDA, 0xE6, 0x5E, 0xB9, 0x84, 0xE9, 0x55, 0xBB, 0xC7, 0x0A, 0xE0, 0x66, 0xF2, 0xD8, 0xCB, 0x00, 0x12, 0xB8, 0x17, 0x94, 0x6A, 0x4A, 0x01, 0x24, 0x14, 0x51, 0x07, 0x65, 0x21, 0xC8, 0x38, 0xFD, 0x8F, 0xC4, 0xF5, 0xFC]byte_405118 = [ 0xA7, 0x1C, 0x7E, 0xAF, 0xD9, 0xC2, 0xC0, 0xBE, 0x1F, 0x45, 0x9A, 0x85, 0x26, 0xE3, 0x87, 0xC3, 0x21, 0xE0, 0x95, 0x10, 0x71, 0x70, 0x02, 0x75, 0x35, 0xA5, 0x1D, 0x0D, 0x2F, 0xEE, 0x25, 0x7B, 0xB5, 0x82, 0x66, 0x8D, 0xDB, 0x53, 0x3A, 0x29, 0xD4, 0x43, 0x99, 0x97, 0x9D, 0xE8, 0x49, 0x00]byte_v17 = [0x52, 0xC3, 0x1A, 0xE0, 0x16, 0x5D, 0x5E, 0xE2, 0x67, 0x1F, 0x1F, 0x06, 0x06, 0x1F, 0x17, 0x06, 0x0F, 0xF9, 0x06, 0x67, 0x58, 0xB2, 0xE2, 0x8C, 0x0F, 0x2A, 0x06, 0x89, 0xCF, 0x2A, 0x06, 0x1F, 0x98, 0x1A, 0x3E, 0x17, 0x67, 0x1F, 0xF7, 0x3A, 0x44, 0xC3, 0x16, 0x33, 0x69, 0x1A, 0x75, 0x16, 0x3E, 0x17, 0xD5, 0x69, 0x7A, 0x1B, 0x44, 0x44, 0x3E, 0x67, 0xF7, 0x89, 0x67]v11 = []for v17 in byte_v17: for i in range(256): c = byte_405018[i] ^ i if c == v17: # print(hex(i)) if i in byte_405118: print(byte_405118.index(i), end=&quot; &quot;) print(&quot;&quot;) ç´¢å¼•ä¸º 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960612 0 33 45 44 30 40 8 2322 11 737 3437 3419 20 4319 20 4337 342419 20 4331 42919 20 4322 11 7135234131 43519 20 439143519 20 4337 34333 45102422 11 737 343812503064233 45363010242142262825251022 11 738922 11 7 ç„¶åå†™è„šæœ¬ï¼Œä»ä¸€å¤´å¼€å§‹è¯•ï¼Œå› ä¸ºå¦‚æœä¸€å¤´ç¨å¾®ä¸€æ”¹ï¼Œæ‰“å°çš„å­—ç¬¦ä¸²å‰é¢å˜åŒ–å¾ˆå¤§çš„è¯ï¼Œè¯´æ˜æ”¹å¯¹äº†ï¼Œå› ä¸ºæ•°æ®é«˜ä½ä¸€æ”¹ï¼Œæ•´ä¸ªæ•°å­—å˜åŒ–æ‰å¤§ï¼Œç„¶ålong_to_bytesåå¯¹åº”çš„å­—ç¬¦ä¹Ÿå˜æ¢å¾ˆå¤§äº†ï¼Œå¦‚æœä»ä½ä½æ”¹ï¼Œæ•°æ®å˜åŒ–ä¸å¤§ï¼Œlong_to_bytesåå¤´éƒ¨çš„å­—ç¬¦å˜åŒ–ä¹Ÿä¸å¤§äº†ï¼Œ å°±è¿™æ ·ä¸€ç‚¹ç‚¹æ”¹ï¼Œflagå°±ä¸€ç‚¹ç‚¹çš„æ˜¾ç¤ºå‡ºæ¥äº† å¯èƒ½æè¿°çš„æœ‰ç‚¹æŠ½è±¡ï¼Œä¸¾ä¸ªä¾‹å­å°±å¾ˆå®¹æ˜“æ‡‚äº† å¯¹åº”çš„è§£å¯†è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071from Crypto.Util.number import *compare = [2, 0, 45, 44, 30, 40, 8, 23, 11, 37, 34, 43, 43, 37, 24, 19, 4, 29, 19, # 19 20 43 22, # 22 11 7 13, 5, 23, 41, 4, # 31 4 35, 20, # 19 20 43 9, 14, 35, 43, # 19 20 43 37, # 37 34 3, 33, # 33 45 10, 24, 22, # 22 11 7 37, # 37 34 38, 1, 25, 0, 30, 6, 42, 45, # 33 45 36, 30, 10, 24, 21, 42, 26, 28, 25, 25, 10, 7, 38, 9, 11]sum = 0re_compare = compare[::-1]for i in range(len(compare)): tmp = re_compare[i] * pow(47, i) sum += tmpprint(long_to_bytes(sum))# NCTF&#123;ADF0E239-D911-3781-7E40-A575A19E5835&#125; flagä¸º NCTF&#123;ADF0E239-D911-3781-7E40-A575A19E5835&#125; easy_mobileJEBæ‰“å¼€åˆ†æ å‘ç°check_flag çš„ç®—æ³•åœ¨å¯¹åº”çš„soæ–‡ä»¶é‡Œ IDAæ‰“å¼€æ‰¾åˆ° Java_com_example_rectf_MainActivity_checkflag å‡½æ•° å“‡å¡ï¼Œçœ‹è¿™ä¼˜ç¾çš„å›¾å½¢ï¼Œæ˜¯OLLVMï¼Œä»ç½‘ä¸Šæ‰¾æ¥å„ç§è„šæœ¬å¹³å¦åŒ–ï¼Œè¦ä¹ˆæ˜¯å¤±è´¥ï¼Œè¦ä¹ˆæ˜¯å»äº†è¿˜ä¸å¦‚ä¸å»å®¹æ˜“çœ‹ æˆ‘ä¸€å…±è¯•äº†è¿™2ä¸ªè„šæœ¬ https://github.com/cq674350529/deflat ï¼ˆæˆåŠŸå»é™¤ï¼ŒåŸºå€è®¾ç½®ä¸º0X400000ï¼Œæ¯”å¦‚check_flagæ˜¯0X7900ï¼Œç„¶å å°±è¿è¡Œ python deflat.py -f libnative-lib.so --addr 0x407900ï¼Œä½†æ˜¯å»äº†åæˆ‘æ„Ÿè§‰æ›´éš¾çœ‹äº†ï¼‰ https://github.com/pcy190/deobfuscator ï¼ˆè¿™ä¸ªæˆ‘å»é™¤å¤±è´¥ï¼Œå¯èƒ½æ˜¯qilingç‰ˆæœ¬çš„é—®é¢˜ï¼‰ å¥½å§ï¼Œç›´æ¥ç¡¬åˆšOLLVMï¼ŒçœŸæœºè°ƒè¯• å¦‚ä½•æ­å»ºçœŸæœºè°ƒè¯•ç¯å¢ƒå¯ä»¥å‚è€ƒæˆ‘å†™çš„è¿™ç¯‡æ–‡ç«  https://zzzzsky.com/2021/11/29/IDA%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95%E5%AE%89%E5%8D%93so%E6%96%87%E4%BB%B6/ åœ¨ä¸‹é¢æ¯ä¸ªæ¡†ä¸­ç¬¬ä¸€æ¡æŒ‡ä»¤ä¸‹æ–­ç‚¹ï¼Œå°¤å…¶æ˜¯è¿™ç§å¤§çš„å—è‚¯å®šæ˜¯æœ‰ç”¨çš„ï¼Œå…ˆå®¡è§†ä¸€ä¸‹è¿™ç§å¤§çš„å— å‘ç°åœ¨è¿™ä¸ªä½ç½®è°ƒç”¨äº†strlenï¼Œç„¶åä¸0X18å¯¹æ¯” çŒœæµ‹æ˜¯éªŒè¯flagçš„é•¿åº¦ï¼Œç»§ç»­å®¡è§†å…¶ä»–å— åœ¨è¿™ä¸ªä½ç½®å‘ç°äº†ä¸€äº›ç±»ä¼¼å¯†é’¥çš„å­—ç¬¦ä¸²ï¼Œè¿˜è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œè¿›å…¥è¿™ä¸ª sub_7D30F1E260 å‡½æ•° æ ¹æ®&lt;&lt; 4 &gt;&gt;5 0X12345678ç­‰ç‰¹å¾ï¼Œå‘ç°è¿™æ˜¯ä¸€ç§ä¸ªTEAç®—æ³•ï¼Œdeltaæ”¹ä¸ºäº†0X12345678 ç»§ç»­å®¡è§†ï¼Œåœ¨è¿™ä¸ªä½ç½®å‘ç°äº†ä¸€äº›æ˜æ–‡ F5ï¼Œå‘ç°è¿™é‡Œè¿˜æœ‰ä¸€äº›åŠ å‡ä¹˜é™¤çš„ä¸€äº›æ“ä½œ å¼€å§‹è°ƒè¯•ï¼Œç›´æ¥åœ¨ä¸Šé¢å¯¹åº”çš„ä½ç½®ä¸‹æ–­ç‚¹ï¼Œflagå…ˆè¾“å…¥12345è¯•è¯•ï¼Œä¸€ç‚¹ç‚¹æ¥åˆ°strlençš„ä½ç½®ï¼Œå‘ç°æœç„¶æ˜¯éªŒè¯flagçš„é•¿åº¦ ç»§ç»­F9ï¼Œå‘ç°å³æ²¡æœ‰åˆ°è¾¾åŠ å‡ä¹˜é™¤é‚£ä¸ªå—ï¼Œä¹Ÿæ²¡æœ‰åˆ°è¾¾TEAç®—æ³•é‚£é‡Œå°±æ˜¾ç¤ºNOäº†ï¼Œæˆ‘ä¹ˆè¾“å…¥flagä¸º 123456789012345678901234 å¥½ï¼Œç¨‹åºæ–­åœ¨äº†åŠ å‡ä¹˜é™¤é‚£ä¸ªå—é‚£é‡Œï¼Œç›´æ¥ä¸€ç‚¹ç‚¹å•æ­¥è°ƒè¯• åœ¨mulä¹‹å‰åœä¸‹ï¼Œè§‚å¯Ÿå¯„å­˜å™¨ï¼Œå‘ç°X1æŒ‡å‘çš„æ˜¯æœ€å8ä¸ªå­—ç¬¦ï¼Œç„¶åæ¥åˆ°X16å¯„å­˜å™¨æŒ‡å‘çš„å†…å­˜ä½ç½®ï¼Œç¨å¾®æ•´ç†æ•´ç† å‘ç°ç³»ç»Ÿåˆå§‹åŒ–äº†16ä¸ªå­—ç¬¦ PRST0123789: &quot;#$ ï¼Œç„¶åä¸‹é¢ç´§è·Ÿç€flag çš„å‰16ä½ï¼ŒçŒœæµ‹flagæ˜¯åˆ†å¼€éªŒè¯çš„16 + 8 è·³è¿‡ä¹˜æ³•ï¼Œå†çœ‹å†…å­˜ æœ€ç»ˆè°ƒè¯•åˆ°memcpyçš„ä½ç½® dword_7CD3B3E14C å¤„çš„æ•°æ®ä¸º è€Œåˆšæ‰0007FD020C630å¤„çš„æ•°æ®å·²ç»å˜ä¸ºäº† äºæ˜¯çŒœæµ‹æ˜¯flagçš„å‰16ä½æ ¹æ®PRST0123789: &quot;#$ åŠ å‡ä¹˜é™¤å ä¸dword_7CD3B3E14Cè¿›è¡Œå¯¹æ¯”ï¼Œç„¶åflag çš„å8ä½æ˜¯é‚£ä¸ªteaç®—æ³• è¿™é‡Œä¸€ç‚¹ç‚¹è°ƒè¯•ï¼Œå‘ç° 1234[&#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;] * [&#x27; &#x27;, &#x27;&quot;&#x27;, &#x27;#&#x27;, &#x27;$&#x27;] + [&#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;:&#x27;] = [1687, 1824, 1912, 2002][&#x27;9&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;] * [&#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;] + [&#x27;P&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;] = [2816, 2434, 2533, 2634][&#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;] * [&#x27; &#x27;, &#x27;&quot;&#x27;, &#x27;#&#x27;, &#x27;$&#x27;] + [&#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;:&#x27;] = [1751, 1892, 1982, 2074][&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;] * [&#x27; &#x27;, &#x27;&quot;&#x27;, &#x27;#&#x27;, &#x27;$&#x27;] + [&#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;:&#x27;] = [1623, 1756, 1842, 1930] å†™è„šæœ¬è§£å¯†å¾—åˆ°flagçš„å‰16ä¸ªå­—ç¬¦ 12345678910111213141516171819202122232425262728293031323334a = [3287, 1688, 3452, 1786, 3255, 1994, 1947, 2002, 2384, 2777, 2783, 5286, 3319, 1824, 1842, 2038] mul1 = [ord(i) for i in &quot;0123&quot;]mul2 = [ord(i) for i in &#x27; &quot;#$&#x27;]add1 = [ord(i) for i in &quot;PRST&quot;]add2 = [ord(i) for i in &quot;789:&quot;]flag = []flag1 = [(a[:4][i]-add2[i])/mul2[i] for i in range(4)]flag2 = [(a[4:8][i]-add2[i])/mul2[i] for i in range(4)]flag3 = [(a[8:12][i]-add1[i])/mul1[i] for i in range(4)]flag4 = [(a[12:][i]-add2[i])/mul2[i] for i in range(4)]print(flag1)print(flag2)print(flag3)print(flag4)flag = flag1 + flag2 + flag3 + flag4flag = [chr(int(i)) for i in flag]print(&quot;&quot;.join(flag))# [101.0, 48.0, 97.0, 48.0]# [100.0, 57.0, 54.0, 54.0]# [48.0, 55.0, 54.0, 102.0]# [102.0, 52.0, 51.0, 55.0]# e0a0d966076ff437 ç„¶åflagè¾“å…¥e0a0d966076ff437ABCD1234é‡æ–°è°ƒè¯•ï¼Œæœç„¶ç¨‹åºæ–­åœ¨äº†TEAç®—æ³•çš„ä½ç½® å‘ç°æœç„¶æ˜¯å¯¹flagçš„å8ä¸ªå­—ç¬¦è¿›è¡ŒTEAåŠ å¯†ï¼Œç›´æ¥è¿è¡Œåˆ°åŠ å¯†å®Œæˆ ç„¶åè¿›å…¥æ±‡ç¼–ç•Œé¢å•æ­¥è°ƒè¯•ï¼Œæ³¨æ„CMPæŒ‡ä»¤ å¯ä»¥å‘ç°V0åŠ å¯†ååº”æ”¹ä¸º0XC65AEDA, è¿™é‡Œä¿®æ”¹X13çš„å€¼ä¸º0XC65AEDA,ä½¿å…¶éªŒè¯é€šè¿‡ï¼Œç„¶åå†å•æ­¥ è¿è¡Œåˆ°è¿™ä¸ªä½ç½®ï¼Œå‘ç°V1åŠ å¯†åçš„æ•°æ®ä¸º 0xADBF8DB1 ç›´æ¥å†™è„šæœ¬è§£å¯† 123456789101112131415161718192021222324252627282930313233343536373839404142434445#include &lt;stdio.h&gt; #include &lt;stdint.h&gt; //åŠ å¯†å‡½æ•° void encrypt(uint32_t* v, uint32_t* k) &#123; uint32_t v0 = v[0], v1 = v[1], sum = 0, i; uint32_t delta = 0x12345678; uint32_t k0 = k[0], k1 = k[1], k2 = k[2], k3 = k[3]; for (i = 0; i &lt; 32; i++) &#123; sum += delta; v0 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k1); v1 += ((v0 &lt;&lt; 4) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k3); &#125; v[0] = v0; v[1] = v1;&#125;//è§£å¯†å‡½æ•° void decrypt(uint32_t* v, uint32_t* k) &#123; uint32_t delta = 0x12345678; uint32_t v0 = v[0], v1 = v[1], sum = delta * 32, i; uint32_t k0 = k[0], k1 = k[1], k2 = k[2], k3 = k[3]; for (i = 0; i &lt; 32; i++) &#123; v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k3); v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k1); sum -= delta; &#125; v[0] = v0; v[1] = v1;&#125;unsigned char byte_key[] =&#123; 0x71, 0x69, 0x68, 0x61, 0x68, 0x61, 0x69, 0x6E, 0x69, 0x6E, 0x61, 0x6E, 0x61, 0x6E, 0x61, 0x6D&#125;;//char enc[] = &#123; &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27; &#125;;int main()&#123; //uint32_t* v = (uint32_t*)enc; uint32_t v[2] = &#123; 0x000000000C65AEDA , 0x00000000ADBF8DB1 &#125;; uint32_t* k = (uint32_t*)byte_key; decrypt(v, k); printf(&quot;è§£å¯†åçš„æ•°æ®ï¼š%u %u\\n&quot;, v[0], v[1]); return 0;&#125; å8ä½æ˜¯ 58af2715 æ‹¼å‡‘å¾—åˆ° flag e0a0d966076ff43758af2715 éªŒè¯æˆåŠŸ çºªå¿µAK RE, æ‹¿äº†3ä¸€è¡€ï¼Œç¾æ»‹æ»‹ ç»§ç»­åŠ æ²¹~~ é¢˜ç›®é™„ä»¶é“¾æ¥ï¼šhttps://pan.baidu.com/s/1FaBD6_FDjKLziKpVqvGe-Qæå–ç ï¼šptjq","categories":[{"name":"CTF","slug":"CTF","permalink":"https://zzzzsky.github.io/categories/CTF/"}],"tags":[{"name":"CTFWP","slug":"CTFWP","permalink":"https://zzzzsky.github.io/tags/CTFWP/"},{"name":"ollvm","slug":"ollvm","permalink":"https://zzzzsky.github.io/tags/ollvm/"}]},{"title":"IDAçœŸæœºè°ƒè¯•å®‰å“soæ–‡ä»¶","slug":"IDAçœŸæœºè°ƒè¯•å®‰å“soæ–‡ä»¶","date":"2021-11-29T05:03:23.000Z","updated":"2021-11-29T11:44:31.569Z","comments":true,"path":"2021/11/29/IDAçœŸæœºè°ƒè¯•å®‰å“soæ–‡ä»¶/","link":"","permalink":"https://zzzzsky.github.io/2021/11/29/IDA%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95%E5%AE%89%E5%8D%93so%E6%96%87%E4%BB%B6/","excerpt":"","text":"IDAçœŸæœºè°ƒè¯•å®‰å“soæ–‡ä»¶ç®€è¦çœ‹äº†ç½‘ä¸Šå¾ˆå¤šçš„IDAçœŸæœºè°ƒè¯•å®‰å“çš„æ–‡ç« ï¼Œæ„Ÿè§‰å¾ˆå¤šæ­¥éª¤æ²¡æœ‰å¿…è¦ï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹æœ€ç®€å•çš„å®ç°å®‰å“çœŸæœºè°ƒè¯•çš„æ­¥éª¤ï¼Œä»¥ä¾¿ä»¥åå‚è€ƒï¼Œä»¥ 2021NCTF easy_mobileé¢˜ç›®ä¸¾ä¾‹ æ­¥éª¤ é¦–å…ˆéœ€è¦ä¸€ä¸ªroot åçš„æ‰‹æœºï¼Œç”¨æ•°æ®çº¿è¿æ¥ç”µè„‘ï¼Œå¹¶ä¸”å¼€å¯USBè°ƒè¯• ç”µè„‘å®‰è£…å¥½ adb è¿è¡Œadb devices è§‚å¯Ÿè®¾å¤‡æ˜¯å¦å·²ç»è¿æ¥ æ¥åˆ°IDAå®‰è£…ç›®å½•çš„æ–‡ä»¶å¤¹ï¼Œå°† ç”¨adb push ç”µè„‘æºç›®å½• å®‰å“çš„ç›®çš„ç›®å½• å°† dbgsrvå¯¹åº”çš„æ–‡ä»¶æ”¾åˆ°æ‰‹æœºæ–‡ä»¶çš„æŸä¸ªç›®å½•ä¸‹ è¿è¡Œadb shell ç„¶åsu åˆ‡æ¢åˆ°rootæƒé™ï¼Œæ¥åˆ°å¯¹åº”çš„ç›®å½•ä¸‹ ç»™ android_server å’Œ android_server64åŠ å¯æ‰§è¡Œæƒé™ è§‚å¯Ÿæ­¤é¢˜check_flagå‡½æ•°åœ¨libnative-lib.soæ–‡ä»¶ä¸­ï¼Œä¸ºarm64æ¶æ„ è¿è¡Œå¯¹åº”çš„server, è¿™é‡Œè¿è¡Œçš„æ˜¯./android_server64 ç«¯å£è½¬å‘adb forward tcp:23946 tcp:23946 æ‰“å¼€IDAï¼Œæ‹–å…¥å¯¹åº”çš„soæ–‡ä»¶ï¼Œé€‰æ‹©Remote ARM Linux/Android debugger 11ã€Debugger -&gt; Process options,å¡«å†™localhostï¼Œç«¯å£ä¿æŒé»˜è®¤ 12ã€å¯¹åº”çš„æ‰‹æœºä¸Šå®‰è£…å¯¹åº”çš„APKæ–‡ä»¶ 13ã€IDA Debugger -&gt; Attach to process, é€‰æ‹©å¯¹åº”çš„è¿›ç¨‹ 14ã€åœ¨Java_com_example_rectf_MainActivity_checkflag å‡½æ•°é‚£é‡Œä¸‹æ–­ç‚¹ï¼Œæ‰‹æœºè¾“å…¥flagï¼Œç‚¹éªŒè¯ï¼ŒIDAæ–­ä¸‹ å…³äºè¿™ä¸ªé¢˜çš„è¯¦ç»†é¢˜è§£å¯ä»¥å‚è€ƒ https://zzzzsky.com/2021/11/29/NCTF2021_RE_WP/ å‚è€ƒæ–‡ç« https://www.cnblogs.com/xuan52rock/p/11010304.html https://blog.csdn.net/Breeze_CAT/article/details/106298559 https://www.i4k.xyz/article/haodawei123/104060906","categories":[{"name":"å®‰å“","slug":"å®‰å“","permalink":"https://zzzzsky.github.io/categories/%E5%AE%89%E5%8D%93/"}],"tags":[{"name":"çœŸæœºè°ƒè¯•","slug":"çœŸæœºè°ƒè¯•","permalink":"https://zzzzsky.github.io/tags/%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95/"},{"name":"å®‰å“","slug":"å®‰å“","permalink":"https://zzzzsky.github.io/tags/%E5%AE%89%E5%8D%93/"}]},{"title":"2021GFCTFéƒ¨åˆ†RE_WP","slug":"2021GFCTF_WP","date":"2021-11-25T09:05:00.000Z","updated":"2021-11-29T11:41:47.513Z","comments":true,"path":"2021/11/25/2021GFCTF_WP/","link":"","permalink":"https://zzzzsky.github.io/2021/11/25/2021GFCTF_WP/","excerpt":"","text":"2021GFCTF RE_WPwordyå»é™¤èŠ±æŒ‡ä»¤ 123456789addr =0X556AE377FD56end = 0x0556AE377FE40flag = &quot;&quot;for i in range(addr, end, 13): c = get_bytes(i+4, 1)[0] flag+=chr(c) print(flag)# GFCTF&#123;u_are2wordy&#125; BabyReverseIDAæ‰“å¼€ï¼Œå»é™¤æ‰€æœ‰çš„èŠ±æŒ‡ä»¤ ç›´æ¥çœ‹ä¸‹é¢å¯¹flagå¦‚ä½•åŠ å¯†çš„ï¼Œè¿›å…¥sub_412E10, å‘ç°æ˜¯SM4åŠ å¯† è€Œä¼ å…¥çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯keyï¼Œå³byte_4409c0æ˜¯keyï¼Œå›åˆ°mainå‡½æ•°å†å¾€ä¸Šçœ‹ï¼Œå‘ç°å‰é¢æœ‰ä¸€ä¸ªå¯¹byte_4409c0ç±»ä¼¼RC4åŠ å¯†çš„æ“ä½œ, å¯¹ byte_4409C0è¿›è¡Œäº¤å‰å¼•ç”¨ äºæ˜¯ä¸‹æ–­ç‚¹è°ƒè¯•æ¥è·å–keyï¼Œå‘ç°ä¸è¡Œï¼ŒçŒœæµ‹å‰é¢æ˜¯åè°ƒè¯•ï¼Œä»mainå‡½æ•°å¤´éƒ¨ä¸‹æ–­ç‚¹è°ƒè¯• æœ€ç»ˆå®šä½åˆ°è¿™ä¸ªå‡½æ•° é‡‡ç”¨çš„æ˜¯self_mappingæŠ€æœ¯å®ç°åè°ƒè¯•ï¼Œæœ¬è´¨æ˜¯åˆ›å»ºsecionçš„æ—¶å€™è®¾ç½®SEC_NO_CHANGEï¼Œæ˜ å°„åä¸èƒ½æ”¹å˜ Self-Remapping-Code å…³äºè¿™ä¸ªæŠ€æœ¯ï¼Œå¯ä»¥å‚è€ƒä¸‹è¿™ä½å¤§ä½¬çš„ç¬”è®° https://jev0n.com/2021/09/23/Self-Remapping.html æˆ‘ä»¬ç›´æ¥å°†call sub_411CE0 çš„åœ°æ–¹nopæ‰ï¼Œæ‰‹åŠ¨çš„æŠŠbyte_4409c0çš„åœ°æ–¹åŠ 1 12345678a = [ 0x07, 0xB8, 0x0D, 0x24, 0xB1, 0x0C, 0x2D, 0xC7, 0x28, 0x2D, 0xC3, 0x61, 0x66, 0x4F, 0x72, 0x13] addr = 0x04409C0for i in range(16): patch_byte(addr+i, a[i]+1)print(&quot;OK&quot;) è¿è¡Œèµ·æ¥ å¾—åˆ°keyä¸º GF?-&gt;GirlFriend? æå–å¯†æ–‡ 10D 40 3B 87 A5 66 DA 74 92 7F BB E1 B8 CD EB BC 59 45 1B C0 38 99 AA 22 AA 3F 9D 21 07 4E 81 1F SM4åœ¨çº¿è§£å¯† 2e69df5961f20aee0897cf1905156344 , æœ€ç»ˆå¾—åˆ°flagä¸º GFCTF&#123;2e69df5961f20aee0897cf1905156344&#125; re_EasyRE_0x00IDAæ‰“å¼€åˆ†æï¼Œæœ€å…³é”®çš„æ˜¯sub_100016A0å‡½æ•° ç»è¿‡åˆ†æï¼Œå‘ç°sub_10001180æ˜¯è§£å¯†login.keyæ–‡ä»¶ï¼Œç”Ÿæˆçš„æ•°æ®æ”¾åˆ°V13é‡Œé¢ ç„¶åä¸‹é¢è¿™ä¸ªåœ°æ–¹æ˜¯å°†V13å¤„çš„æ•°æ®ä¸ç”Ÿæˆçš„ä¸€äº›æ•°æ®è¿›è¡Œå¯¹æ¯”ï¼ŒçŒœæµ‹æ˜¯æœºå™¨ç çš„éªŒè¯ è¿™æ˜¯V13å¤„çš„æ•°æ® 111 55 66 55 0D 50 51 0C FF 01 80 12 CE A9 08 75 73 65 72 32 33 33 33 æœ€å8ä¸ªå­—ç¬¦æ˜¯user2333 å°†å¯¹æ¯”çš„æ•°æ®ä¹Ÿæå–å‡ºæ¥, ç„¶åç»“åˆé¢˜ç›®ï¼Œç”¨æˆ·åç”¨admin6677ç™»å½•ï¼Œé•¿åº¦æ˜¯9ï¼Œæ•´ç†å¾— 111 55 66 55 98 FA 9B 59 6F F6 14 8F E9 DA 09 61 64 6D 69 6E 36 36 37 37 æˆ‘ä»¬å†™è„šæœ¬ï¼Œæ¯æ¬¡è¿è¡Œåˆ°å¯¹æ¯”æ•°æ®çš„æ—¶å€™å°±æŠŠv13çš„æ•°æ®ç»™ä»–æ›¿æ¢æ‰ 12345data = [0x11, 0x55, 0x66, 0x55, 0x98, 0xFA, 0x9B, 0x59, 0x6F, 0xF6, 0x14, 0x8F, 0xE9, 0xDA, 0x09, 0x61, 0x64, 0x6D, 0x69, 0x6E, 0x36, 0x36, 0x37, 0x37]addr = 0x004CB348 # v13çš„åœ°å€for i in range(len(data)): patch_byte(addr+i, data[i])print(&quot;OK&quot;) ç„¶åç»•è¿‡æœºå™¨ç éªŒè¯ï¼Œå¾€ä¸‹èµ°ï¼Œæ¥åˆ°sub_10001610å¤„ å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªåœ°æ–¹è‚¯å®šæ˜¯ä¸æœåŠ¡å™¨é€šä¿¡äº†ï¼Œæˆ‘ä»¬ç›´æ¥è¿è¡Œï¼Œç›´æ¥WiresharkæŠ“åŒ… æå–æ•°æ® 1234567---&gt; 11 55 66 55 1a 27 00 00 00 00 &lt;--- 11 55 66 55 66 27 00 00 0f 00 f3 46 8a be 81 62 ed 36 d5 df 28 dc 04 8a fd ---&gt; 11 55 66 55 1a 27 01 00 40 00 0e a2 60 19 1f df 39 0d bc 62 48 57 5a 11 87 78 69 11 03 76 4b f9 2c 1f 35 fd ff 4a b8 d8 63 8f b6 b1 f0 cd d3 90 2d 27 05 b7 1e 01 22 74 91 1a a4 53 df 1d f4 69 7d 3e 29 bd d3 30 da 94 a3 03 &lt;--- 11 55 66 55 66 27 01 00 48 00 84 cb 11 ef 71 51 30 0b b3 d8 c1 22 ac c4 ca f1 29 12 cf 79 f5 36 5f 5a 5e a8 f5 fa 62 3c e8 32 69 d6 a1 54 eb 1b 06 06 b0 68 20 5a 62 ea 48 ec 8a 3d 5c 40 d0 a8 03 94 6a 2e b7 f0 e4 33 aa a0 e3 f2 da f8 a9 cf 5d 92 é‡æ–°è°ƒè¯•ï¼Œæ¥ç€åˆšæ‰çš„ä½ç½®å¾€ä¸‹åˆ†æï¼Œçœ‹åˆ°äº†RC4çš„åˆå§‹åŒ–åŠåŠ å¯† çŒœæµ‹æ˜¯åˆšå¼€å§‹ï¼ŒæœåŠ¡å™¨ç«¯è¿”å›RC4çš„keyï¼Œç„¶ååé¢å…¨éƒ¨ä½¿ç”¨RC4åŠ å¯†æ–¹å¼è¿›è¡ŒåŠ å¯† æ ¹æ®sub_10001350è¿™ä¸ªå‡½æ•°å¯ä»¥çŒœæµ‹å‡ºæ•°æ®åŒ…çš„æ ¼å¼, æ‹¿ä¸Šé¢æœåŠ¡å™¨è¿”å›çš„keyä¸¾ä¾‹å­ 1234511 55 66 55 //æ ‡å¿—66 27 //ç‰ˆæœ¬00 00 //å‘½ä»¤0f 00 //åé¢æ•°æ®çš„é•¿åº¦f3 46 8a be 81 62 ed 36 d5 df 28 dc 04 8a fd //æ•°æ®ï¼Œå½“å‘½ä»¤ä¸º0çš„æ—¶å€™ï¼Œæ˜¯RC4çš„keyï¼Œå‘½ä»¤ä¸º1å’Œ2çš„æ—¶å€™ï¼Œæ˜¯RC4åŠ å¯†çš„æ•°æ® å†™è„šæœ¬éªŒè¯RC4åŠ å¯† 1234567891011121314151617181920212223242526272829303132from Crypto.Cipher import ARC4 as rc4cipherimport binasciidef rc4_algorithm(encrypt_or_decrypt, data, key1): if encrypt_or_decrypt == &quot;enc&quot;: key = key1 enc = rc4cipher.new(key) res = enc.encrypt(data) return res elif encrypt_or_decrypt == &quot;dec&quot;: key = key1 enc = rc4cipher.new(key) res = enc.decrypt(data) return reskey = binascii.unhexlify(&quot;f3468abe8162ed36d5df28dc048afd&quot;)data1 = binascii.unhexlify( &quot;0ea260191fdf390dbc6248575a118778691103764bf92c1f35fdff4ab8d8638fb6b1f0cdd3902d2705b71e012274911aa453df1df4697d3e29bdd330da94a303&quot;)m1 = rc4_algorithm(&quot;dec&quot;, data1, key)data2 = binascii.unhexlify( &quot;84cb11ef7151300bb3d8c122acc4caf12912cf79f5365f5a5ea8f5fa623ce83269d6a154eb1b0606b068205a62ea48ec8a3d5c40d0a803946a2eb7f0e433aaa0e3f2daf8a9cf5d92&quot;)m2 = rc4_algorithm(&quot;dec&quot;, data2, key)print(m1)print(m2)# b&#x27;\\x8ayqv,\\x8eYjj\\xdb\\xfa\\x10\\xd6\\xa0=\\xed!w\\xa9/\\xdd\\xa3\\x1a \\x05!+\\xbd\\xd0\\xa7\\xe7\\xd4\\xba\\t%\\xb9N\\xeeYR\\xdc\\xb0Pfq\\xae\\xe9\\xc7\\x1eB\\xa3\\x0eA\\xb3\\x08\\xcf1\\xb3\\x12\\xa5L\\xd4`\\xcc&#x27;# b&#x27;\\x00\\x10\\x00\\x80B\\x00Please update client!\\r\\nClient version=10010, Server version=10086\\x00&#x27; ç»“åˆlogin.keyï¼Œå‘ç°å½“å‘½ä»¤ä¸º1çš„æ—¶å€™ï¼Œå‘æœåŠ¡å™¨å‘é€çš„æ˜¯login.keyçš„æ•°æ®ï¼Œç„¶åæœåŠ¡å™¨è¿”å›ä¿¡æ¯ æ‰€ä»¥ç°åœ¨éœ€è¦æ„é€  çœŸæ­£çš„login.key(11 55 66 55 98 FA 9B 59 6F F6 14 8F E9 DA 09 61 64 6D 69 6E 36 36 37 37) åŠ å¯†åçš„æ•°æ® sub_10001180æ˜¯è§£å¯†å‡½æ•°ï¼Œè¿›å»åˆ†æ,å‘ç°æ˜¯RSAçš„PKCS#1åŠ å¯† æ ¹æ®è¿™ä¸ªç»“æ„æ‰¾åˆ°eå’Œn æå–å‡ºæ¥ 12345e: 65537n: 0xd928b8efe000f72db5bda67a9aa0740defb555b2603736eecd6d01f38ef2fc79åˆ†è§£å¾—åˆ°p, qp = 322922590106035145437937724697895880569q = 304171468404401467258708275665013611777 åˆ©ç”¨rsatool.pyç”Ÿæˆprivate.pem 1python rsatool.py -e 65537 -p 322922590106035145437937724697895880569 -q 304171468404401467258708275665013611777 -o private.pem åˆ©ç”¨åœ¨çº¿è§£å¯†ç½‘ç«™æµ‹è¯• https://the-x.cn/cryptography/Rsa.aspx å‘ç°è§£å¯†æˆåŠŸï¼Œå°†æ„é€ å¥½çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œ å¯¹äºPKCS#1çš„å¡«å……æ–¹å¼å¯ä»¥å‚è€ƒä¸‹é¢2ç¯‡æ–‡ç«  https://www.cloudcared.cn/3155.html https://www.cnblogs.com/feng9exe/p/8075447.html ç„¶åå†™ç¨‹åºä¸æœåŠ¡å™¨äº¤äº’ï¼Œå‘ç°æœåŠ¡å™¨è¿”å›å‘½ä»¤ä¸º2çš„éªŒè¯ç é—®é¢˜ Question(Send result in uint32_t format, 1 second!): 9540808 * 32 + 509 * 859 = ? ç„¶ååˆ©ç”¨evalè®¡ç®—æ•°å€¼ï¼Œæ„é€ ï¼Œè¿”å›ç»™æœåŠ¡å™¨ï¼Œå³å¯å¾—åˆ°flagï¼Œå®Œæ•´çš„expå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465import socketfrom Crypto.Cipher import ARC4 as rc4cipherimport reimport structlogin_key = [0x5D, 0x98, 0xEE, 0x8B, 0x68, 0x86, 0x2F, 0x56, 0xBA, 0xA1, 0x27, 0x2A, 0x68, 0x8B, 0x19, 0x31, 0x37, 0xC1, 0x2B, 0x1A, 0x80, 0x5F, 0xAB, 0x8C, 0xE0, 0xE6, 0x81, 0xDF, 0x05, 0xC6, 0xB1, 0x2F, 0x0E, 0x59, 0xC8, 0x45, 0x8A, 0x7D, 0x83, 0x35, 0x5F, 0x02, 0x05, 0x10, 0x8A, 0x35, 0x6D, 0x0C, 0xE8, 0x3C, 0x9C, 0x15, 0xD7, 0xDA, 0xF0, 0x96, 0x6D, 0x2E, 0x77, 0xEC, 0x78, 0x3B, 0x83, 0xB2]def rc4_algorithm(encrypt_or_decrypt, data, key1): if encrypt_or_decrypt == &quot;enc&quot;: key = key1 enc = rc4cipher.new(key) res = enc.encrypt(data) return res elif encrypt_or_decrypt == &quot;dec&quot;: key = key1 enc = rc4cipher.new(key) res = enc.decrypt(data) return resdef get_data(_cmd, _len, _data, _key): sig = [0x11, 0x55, 0x66, 0x55] # ç­¾å banben = [0x66, 0x27] # ç‰ˆæœ¬ cmd_list = [_cmd, 0x00] # å‘½ä»¤ data_len_list = [_len, 0x00] # æ•°æ®é•¿åº¦ if _len != 0: return bytes(sig + banben + cmd_list + data_len_list) + rc4_algorithm(&#x27;enc&#x27;, bytes(_data), _key) return bytes(sig + banben + cmd_list + data_len_list)def get_captcha(_captcha_str): m = re.search( r&quot;Question\\(Send result in uint32_t format, 1 second!\\): (.*?) = &quot;, _captcha_str) c = eval(m.group(1)) return struct.pack(&quot;I&quot;, c)if __name__ == &#x27;__main__&#x27;: address = (&#x27;119.27.179.145&#x27;, 10086) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect(address) s.send(get_data(0, 0, [], None)) data = s.recv(1024) rc4_key = data[10:] # è·å–RC4å¯†é’¥ s.send(get_data(1, 0x40, login_key, rc4_key)) data = s.recv(1024) captcha_str = rc4_algorithm(&quot;dec&quot;, data[10:], rc4_key).decode() captcha = get_captcha(captcha_str) # è®¡ç®—å¾—åˆ°éªŒè¯ç  print(f&quot;Captcha: &#123;captcha&#125;&quot;) # å‘æœåŠ¡å™¨è¿”å›éªŒè¯ç  send_data = get_data(2, len(captcha), list(captcha), rc4_key) s.send(send_data) data = s.recv(1024) m = rc4_algorithm(&quot;dec&quot;, data[10:], rc4_key) print(m) s.close() # Captcha: b&#x27;\\xc84\\x06\\x03&#x27; # b&#x27;\\x00\\x10\\x00\\x805\\x00flag_0x00 = \\x00GFCTF&#123;e8e9071b7a70770bec1f6415c4ed4c1d&#125;\\x00&#x27; å¾—åˆ°flagä¸º GFCTF&#123;e8e9071b7a70770bec1f6415c4ed4c1d&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://zzzzsky.github.io/categories/CTF/"}],"tags":[{"name":"CTFWP","slug":"CTFWP","permalink":"https://zzzzsky.github.io/tags/CTFWP/"}]},{"title":"2021 L3HCTF éƒ¨åˆ†RE WP","slug":"2021L3HCTF_WP_RE_","date":"2021-11-17T02:00:00.000Z","updated":"2021-11-29T11:41:58.907Z","comments":true,"path":"2021/11/17/2021L3HCTF_WP_RE_/","link":"","permalink":"https://zzzzsky.github.io/2021/11/17/2021L3HCTF_WP_RE_/","excerpt":"","text":"2021 L3HCTF éƒ¨åˆ†RE WPdouble-joyIDAæ‰“å¼€ç¨‹åºï¼Œæ‰¾åˆ°mainå‡½æ•°è¿›è¡Œåˆ†æ æœ€å…³é”®çš„æ˜¯enc_flag å‡½æ•°, ç»è¿‡è°ƒè¯•ï¼Œå‘ç°ä¼ å…¥çš„å‚æ•°æœ‰2å¥—ï¼Œéƒ½æ˜¯å›ºå®šçš„ç»“æ„ä½“ 1234567typedef struct _struc_1&#123; BYTE* pKey; //æŒ‡å‘OPCODE _DWORD* pFlag; //æŒ‡å‘FLAGï¼Œä¸»è¦è¿™ä¸ªFLAGå‰40ä¸ªå­—èŠ‚æ˜¯ç”¨æˆ·è¾“å…¥çš„ï¼Œåé¢ä¸€å¤§éƒ¨åˆ†è¦ç•™ç»™ç¨‹åºç”¨ int i; //æŒ‡å‘OPCODEçš„ç´¢å¼• int stack; //æŒ‡å‘äº†ä¸€äº› â€œæ“ä½œæ•°â€ï¼Œåœ¨OPCODE ä¸­å­˜ç€ï¼Œæ¯”å¦‚OPCODEæ˜¯ \\XEçš„è¯ï¼Œåé¢4ä¸ªå­—èŠ‚å°±æ˜¯ä¸€ä¸ªâ€œæ“ä½œæ•°â€&#125;struc_1; è¿›å…¥ enc_flagå‡½æ•°ï¼ŒF5ï¼Œå‘ç°å¾ˆä¹±ï¼Œç„¶åpatchæ‰ä¸€äº›ç”¨äºå¯¹é½çš„ä»£ç åï¼ŒF5, å‘ç°æ˜¯ä¸ªVM è°ƒè¯•ï¼Œå‘ç°ä¸€å…±æ‰§è¡Œäº†0XCAæ¬¡ enc_flag, å¹¶ä¸”ä¼ å…¥çš„å‚æ•°æ˜¯äº¤æ›¿çš„ è¿˜åŸç¨‹åºä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334#include &lt;windows.h&gt;#include &lt;basetsd.h&gt;#include &lt;stdio.h&gt;typedef unsigned int uint32;#define _DWORD uint32typedef struct _struc_1&#123; BYTE* pKey; //æŒ‡å‘OPCODE _DWORD* pFlag; //æŒ‡å‘FLAGï¼Œä¸»è¦è¿™ä¸ªFLAGå‰40ä¸ªå­—èŠ‚æ˜¯ç”¨æˆ·è¾“å…¥çš„ï¼Œåé¢ä¸€å¤§éƒ¨åˆ†è¦ç•™ç»™ç¨‹åºç”¨ int i; //æŒ‡å‘OPCODEçš„ç´¢å¼• int stack; //æŒ‡å‘äº†ä¸€äº› â€œæ“ä½œæ•°â€ï¼Œåœ¨OPCODE ä¸­å­˜ç€ï¼Œæ¯”å¦‚OPCODEæ˜¯ \\XEçš„è¯ï¼Œåé¢4ä¸ªå­—èŠ‚å°±æ˜¯ä¸€ä¸ªâ€œæ“ä½œæ•°â€&#125;struc_1;BYTE key1[] =&#123; 0x11, 0x15, 0x00, 0x00, 0x00, 0x0E, 0x0A, 0x00, 0x00, 0x00, 0x0E, 0x15, 0xCD, 0x5B, 0x07, 0x08, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x0E, 0xB1, 0x68, 0xDE, 0x3A, 0x08, 0x0E, 0x12, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0A, 0x00, 0x00, 0x00, 0x0C, 0x01, 0x0B, 0x0A, 0x10, 0x44, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x01, 0x01, 0x01, 0x01, 0x02, 0x07, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0F, 0xA8, 0xFF, 0xFF, 0xFF, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x4C, 0x49, 0x00, 0x00, 0x08, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x76, 0x6F, 0x00, 0x00, 0x08, 0x0E, 0x02, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x20, 0x65, 0x00, 0x00, 0x08, 0x0E, 0x03, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x55, 0x43, 0x00, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0A, 0x00, 0x00, 0x00, 0x0C, 0x01, 0x0B, 0x0A, 0x10, 0x56, 0x01, 0x00, 0x00, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x0C, 0x01, 0x0B, 0x0A, 0x10, 0x20, 0x01, 0x00, 0x00, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0x08, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0x08, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x10, 0x00, 0x00, 0x00, 0x02, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x20, 0x00, 0x00, 0x00, 0x0C, 0x03, 0x07, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x00, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x03, 0x00, 0x00, 0x00, 0x05, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x09, 0x00, 0x07, 0x00, 0x08, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0A, 0x00, 0x00, 0x00, 0x09, 0x00, 0x08, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x10, 0x00, 0x00, 0x00, 0x02, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x20, 0x00, 0x00, 0x00, 0x0C, 0x03, 0x07, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x00, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x00, 0x08, 0x00, 0x00, 0x0C, 0x03, 0x0E, 0x03, 0x00, 0x00, 0x00, 0x05, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x09, 0x00, 0x07, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x08, 0x12, 0x01, 0x00, 0x00, 0x00, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0F, 0xCC, 0xFE, 0xFF, 0xFF, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x02, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0F, 0x96, 0xFE, 0xFF, 0xFF, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00&#125;;BYTE key2[] =&#123; 0x11, 0x15, 0x00, 0x00, 0x00, 0x0E, 0x0A, 0x00, 0x00, 0x00, 0x0E, 0xF7, 0xCB, 0x54, 0x01, 0x08, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x0E, 0xAD, 0xDE, 0xED, 0x5E, 0x08, 0x0E, 0x12, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0A, 0x00, 0x00, 0x00, 0x0C, 0x01, 0x0B, 0x0A, 0x10, 0x44, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x01, 0x01, 0x01, 0x01, 0x02, 0x07, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0F, 0xA8, 0xFF, 0xFF, 0xFF, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x54, 0x53, 0x00, 0x00, 0x08, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x4D, 0x4F, 0x00, 0x00, 0x08, 0x0E, 0x02, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x74, 0x20, 0x00, 0x00, 0x08, 0x0E, 0x03, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x61, 0x65, 0x00, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0A, 0x00, 0x00, 0x00, 0x0C, 0x01, 0x0B, 0x0A, 0x10, 0x5B, 0x01, 0x00, 0x00, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x0C, 0x01, 0x0B, 0x0A, 0x10, 0x25, 0x01, 0x00, 0x00, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0x08, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0x08, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0A, 0x00, 0x00, 0x00, 0x09, 0x00, 0x08, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x10, 0x00, 0x00, 0x00, 0x02, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x09, 0x00, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x09, 0x00, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x20, 0x00, 0x00, 0x00, 0x0C, 0x03, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x09, 0x00, 0x07, 0x07, 0x00, 0x08, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x10, 0x00, 0x00, 0x00, 0x02, 0x0E, 0x02, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x09, 0x00, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x0B, 0x00, 0x00, 0x00, 0x09, 0x00, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x20, 0x00, 0x00, 0x00, 0x0C, 0x03, 0x0E, 0x03, 0x00, 0x00, 0x00, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x09, 0x00, 0x07, 0x07, 0x00, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x0C, 0x00, 0x00, 0x00, 0x09, 0x08, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x0D, 0x00, 0x00, 0x00, 0x09, 0x08, 0x12, 0x01, 0x00, 0x00, 0x00, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x0E, 0x14, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x01, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0F, 0xC7, 0xFE, 0xFF, 0xFF, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x0E, 0x13, 0x00, 0x00, 0x00, 0x09, 0x0E, 0x02, 0x00, 0x00, 0x00, 0x00, 0x08, 0x0F, 0x91, 0xFE, 0xFF, 0xFF, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00&#125;;void enc_flag(struc_1* st)&#123; BYTE* pKey = st-&gt;pKey; BYTE opcode = 0; _DWORD* pFlag = st-&gt;pFlag; int data1, data2, tmp, index; while (true) &#123; opcode = pKey[st-&gt;i]; //å–å‡ºå¯¹åº”çš„opcode st-&gt;i++; //æ¯å–å‡ºä¸€ä¸ªopcodeï¼Œ ç´¢å¼•å°±+1 printf(&quot;------&gt;OPCODE :%d\\n&quot;, opcode); switch (opcode) &#123; case 0: st-&gt;stack--; data1 = pFlag[st-&gt;stack]; data2 = pFlag[st-&gt;stack - 1]; pFlag[st-&gt;stack - 1] = data1 + data2; printf(&quot;pFlag[%d] = pFlag[%d]:%#x + pFlag[%d]:%#x;\\n&quot;, st-&gt;stack - 1, st-&gt;stack, data1, st-&gt;stack - 1, data2); continue; case 1: st-&gt;stack--; data1 = pFlag[st-&gt;stack]; data2 = pFlag[st-&gt;stack - 1]; pFlag[st-&gt;stack - 1] = data1 - data2; printf(&quot;pFlag[%d] = pFlag[%d]:%#x - pFlag[%d]:%#x;\\n&quot;, st-&gt;stack - 1, st-&gt;stack, data1, st-&gt;stack - 1, data2); continue; case 2: st-&gt;stack--; data1 = pFlag[st-&gt;stack]; data2 = pFlag[st-&gt;stack - 1]; pFlag[st-&gt;stack - 1] = data1 * data2; printf(&quot;pFlag[%d] = pFlag[%d]:%#x * pFlag[%d]:%#x;\\n&quot;, st-&gt;stack - 1, st-&gt;stack, data1, st-&gt;stack - 1, data2); continue; case 3: st-&gt;stack--; data1 = pFlag[st-&gt;stack]; data2 = pFlag[st-&gt;stack - 1]; pFlag[st-&gt;stack - 1] = data1 / data2; printf(&quot;pFlag[%d] = pFlag[%d]:%#x / pFlag[%d]:%#x;\\n&quot;, st-&gt;stack - 1, st-&gt;stack, data1, st-&gt;stack - 1, data2); continue; case 4: st-&gt;stack--; data1 = pFlag[st-&gt;stack]; data2 = pFlag[st-&gt;stack - 1]; pFlag[st-&gt;stack - 1] = data1 % data2; printf(&quot;pFlag[%d] = pFlag[%d]:%#x %% pFlag[%d]:%#x;\\n&quot;, st-&gt;stack - 1, st-&gt;stack, data1, st-&gt;stack - 1, data2); continue; case 5: st-&gt;stack--; data1 = pFlag[st-&gt;stack]; data2 = pFlag[st-&gt;stack - 1]; pFlag[st-&gt;stack - 1] = data1 &amp; data2; printf(&quot;pFlag[%d] = pFlag[%d]:%#x &amp; pFlag[%d]:%#x;\\n&quot;, st-&gt;stack - 1, st-&gt;stack, data1, st-&gt;stack - 1, data2); continue; case 6: st-&gt;stack--; data1 = pFlag[st-&gt;stack]; data2 = pFlag[st-&gt;stack - 1]; pFlag[st-&gt;stack - 1] = data1 | data2; printf(&quot;pFlag[%d] = pFlag[%d]:%#x | pFlag[%d]:%#x;\\n&quot;, st-&gt;stack - 1, st-&gt;stack, data1, st-&gt;stack - 1, data2); continue; case 7: st-&gt;stack--; data1 = pFlag[st-&gt;stack]; data2 = pFlag[st-&gt;stack - 1]; pFlag[st-&gt;stack - 1] = data1 ^ data2; printf(&quot;pFlag[%d] = pFlag[%d]:%#x ^ pFlag[%d]:%#x;\\n&quot;, st-&gt;stack - 1, st-&gt;stack, data1, st-&gt;stack - 1, data2); continue; case 8: st-&gt;stack--; tmp = pFlag[st-&gt;stack]; index = pFlag[st-&gt;stack - 1]; pFlag[index] = tmp; printf(&quot;pFlag[%d] = %#x;\\n&quot;, index, tmp); st-&gt;stack--; continue; case 9: index = pFlag[st-&gt;stack - 1]; data1 = pFlag[index]; pFlag[st-&gt;stack - 1] = data1; printf(&quot;pFlag[%d] = %#x;\\n&quot;, st-&gt;stack -1, data1); continue; case 10: tmp = pFlag[st-&gt;stack - 1]; if (tmp == 0) &#123; pFlag[st-&gt;stack - 1] = 1; printf(&quot;pFlag[%d] = 1;\\n&quot;, st-&gt;stack - 1); &#125; else &#123; pFlag[st-&gt;stack - 1] = 0; printf(&quot;pFlag[%d] = 0;\\n&quot;, st-&gt;stack - 1); &#125; continue; case 11: tmp = pFlag[st-&gt;stack - 1]; if ((int)tmp &lt; 0) &#123; pFlag[st-&gt;stack - 1] = 1; printf(&quot;pFlag[%d] = 1;\\n&quot;, st-&gt;stack - 1); &#125; else &#123; pFlag[st-&gt;stack - 1] = 0; printf(&quot;pFlag[%d] = 0;\\n&quot;, st-&gt;stack - 1); &#125; continue; case 12: data1 = pFlag[st-&gt;stack - 1]; data2 = pFlag[st-&gt;stack - 2]; pFlag[st-&gt;stack - 1] = data2; pFlag[st-&gt;stack - 2] = data1; printf(&quot;exchange pFlag[%d]:%#x, pFlag[%d]:%#x\\n&quot;, st-&gt;stack - 1, data2, st-&gt;stack - 2, data1); continue; case 13: st-&gt;stack--; continue; case 14: tmp = *(_DWORD*)&amp;pKey[st-&gt;i]; st-&gt;i += 4; pFlag[st-&gt;stack++] = tmp; printf(&quot;pFlag[%d] = %#x\\n&quot;, st-&gt;stack-1, tmp); continue; case 15: tmp = *(_DWORD*)&amp;pKey[st-&gt;i]; index = st-&gt;i + 4 + tmp; st-&gt;i = index; continue; case 16: tmp = st-&gt;i + 4; st-&gt;stack--; if (pFlag[st-&gt;stack]) tmp += *(_DWORD*)&amp;pKey[st-&gt;i]; st-&gt;i = tmp; continue; case 17: tmp = *(_DWORD*)&amp;pKey[st-&gt;i]; st-&gt;stack += tmp; st-&gt;i += 4; continue; case 18: st-&gt;i += 4; return; default: st-&gt;i++; &#125; &#125;&#125;char flag1[4000] = &#123; 0 &#125;; //å‰40ä¸ªå­—èŠ‚ä½¿ç”¨æˆ·è¾“å…¥çš„flagï¼Œ40å¾€åæ˜¯ä¸ºäº†åŠ å¯†flagç”¨åˆ°çš„æ•°æ®char flag2[4000] = &#123; 0 &#125;; //å‰40ä¸ªå­—èŠ‚ä½¿ç”¨æˆ·è¾“å…¥çš„flagï¼Œ40å¾€åæ˜¯ä¸ºäº†åŠ å¯†flagç”¨åˆ°çš„æ•°æ®char compare_date[1000] = &#123; 0xE8, 0xFA, 0xE0, 0xAE, 0x01, 0x41, 0x3E, 0xFC, 0x92, 0xAD, 0x7C, 0x16, 0xBE, 0x6C, 0xEA, 0x51, 0x00, 0x01, 0x2A, 0x24, 0x1B, 0x1A, 0x51, 0x01, 0x94, 0x66, 0x4D, 0x51, 0xEB, 0xBF, 0x5F, 0x2F, 0x98, 0x63, 0xD3, 0x46, 0xF0, 0xE3, 0xEE, 0x79, 0&#125;;int main()&#123; struc_1 v12 = &#123; 0 &#125;; struc_1 v13 = &#123; 0 &#125;; memcpy(flag1, &quot;111111111111222211111111111111111111111\\0&quot;, 40); memcpy(flag2, &quot;111111111111222211111111111111111111111\\0&quot;, 40); v12.pFlag = (_DWORD *)flag1; v12.pKey = key1; v12.i = 0; v12.stack = 0; v13.pFlag = (_DWORD*)flag2; v13.pKey = key2; v13.i = 0; v13.stack = 0; for (int i = 0; i &lt; 0XCA; i+=2) &#123; enc_flag(&amp;v12); memcpy(flag2, flag1, 40); enc_flag(&amp;v13); memcpy(flag1, flag2, 40); printf(&quot;----------------------------------------------------------------------------&quot;); &#125; return 0; &#125; è°ƒè¯•å‘ç°ï¼Œflagæ˜¯åˆ†ç»„è¿›è¡ŒåŠ å¯†çš„,æ¯8ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œå…±5ç»„ ç¬¬ä¸€ç»„ L3HCTF&#123;*, åªå·®1ä¸ªå­—ç¬¦, æš´åŠ›ç ´è§£ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667char compare_date[] = &#123; 0xE8, 0xFA, 0xE0, 0xAE, 0x01, 0x41, 0x3E, 0xFC, 0x92, 0xAD, 0x7C, 0x16, 0xBE, 0x6C, 0xEA, 0x51, 0x00, 0x01, 0x2A, 0x24, 0x1B, 0x1A, 0x51, 0x01, 0x94, 0x66, 0x4D, 0x51, 0xEB, 0xBF, 0x5F, 0x2F, 0x98, 0x63, 0xD3, 0x46, 0xF0, 0xE3, 0xEE, 0x79&#125;;int main()&#123; struc_1 v12 = &#123; 0 &#125;; struc_1 v13 = &#123; 0 &#125;; memcpy(flag1, &quot;111111111111111111111111111111111111111\\0&quot;, 40); memcpy(flag2, &quot;111111111111111111111111111111111111111\\0&quot;, 40); v12.pFlag = (_DWORD*)flag1; v12.pKey = key1; v12.i = 0; v12.kk = 0; v13.pFlag = (_DWORD*)flag2; v13.pKey = key2; v13.i = 0; v13.kk = 0; memcpy(flag1, &quot;L3HCTF&#123;1&quot;, 8); memcpy(flag2, &quot;L3HCTF&#123;1&quot;, 8); for (int j = 32; j &lt; 127; j++) &#123; v12.pFlag = (_DWORD*)flag1; v12.pKey = key1; v12.i = 0; v12.kk = 0; v13.pFlag = (_DWORD*)flag2; v13.pKey = key2; v13.i = 0; v13.kk = 0; memcpy(flag1, &quot;L3HCTF&#123;&quot;, 8); memcpy(flag2, &quot;L3HCTF&#123;&quot;, 8); flag1[7] = j; flag2[7] = j; for (int i = 0; i &lt; 0XCA; i += 2) &#123; enc_flag(&amp;v12); memcpy(flag2, flag1, 40); enc_flag(&amp;v13); memcpy(flag1, flag2, 40); &#125; if (memcmp(flag1, compare_date, 8) == 0) &#123; printf(&quot;%c\\n&quot;, j); getchar(); &#125; &#125; return 0;&#125;//D å‘ç°ç¬¬ä¸€ç»„æ˜¯L3HCTF&#123;D ç„¶åä¸‹é¢å¼€å§‹è¿˜åŸVMï¼Œåªéœ€è¿˜åŸå‡ºåŠ å¯†æ¯ä¸€ç»„çš„ç¬¬ä¸€ä¸ªå¾ªç¯å°±OK è¾“å…¥flag ä¸º L3HCTF&#123;D1111222211111111111111111111111 1234ç¬¬äºŒç»„ä¸ºInput: 31 31 31 31 32 32 32 32encåOutput: ec 9d 57 67 94 6a 7e a5 é€šè¿‡æ‰“å°çš„æ—¥å¿—ï¼Œè¿½è¸ªInputï¼Œæ¥åˆ†æå¦‚ä½•å¾—åˆ°çš„Output åŠ å¯†flagçš„ç¬¬äºŒç»„çš„ç¬¬ä¸€ä¸ªå¾ªç¯çš„æ—¥å¿— 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564è¾“å…¥ï¼š31 31 31 31 32 32 32 32è¾“å‡ºï¼šec 9d 57 67 94 6a 7e a5======ä»¥ä¸‹æ˜¯æ‰“å°çš„æ—¥å¿—OPCODE :14pFlag[21] = 0x14------&gt;OPCODE :14pFlag[22] = 0x14------&gt;OPCODE :9pFlag[22] = 0x13;------&gt;OPCODE :14pFlag[23] = 0x1------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x1 + pFlag[22]:0x13;------&gt;OPCODE :8pFlag[20] = 0x14;------&gt;OPCODE :15------&gt;OPCODE :14pFlag[21] = 0x14------&gt;OPCODE :9pFlag[21] = 0x14;------&gt;OPCODE :14pFlag[22] = 0x14------&gt;OPCODE :12exchange pFlag[22]:0x14, pFlag[21]:0x14------&gt;OPCODE :1pFlag[21] = pFlag[22]:0x14 - pFlag[21]:0x14;------&gt;OPCODE :11pFlag[21] = 0;------&gt;OPCODE :10pFlag[21] = 1;------&gt;OPCODE :16------&gt;OPCODE :14pFlag[21] = 0x13------&gt;OPCODE :14pFlag[22] = 0x13------&gt;OPCODE :9pFlag[22] = 0;------&gt;OPCODE :14pFlag[23] = 0x2------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x2 + pFlag[22]:0;------&gt;OPCODE :8pFlag[19] = 0x2;------&gt;OPCODE :15------&gt;OPCODE :14pFlag[21] = 0x13------&gt;OPCODE :9pFlag[21] = 0x2;------&gt;OPCODE :14pFlag[22] = 0xa------&gt;OPCODE :12exchange pFlag[22]:0x2, pFlag[21]:0xa------&gt;OPCODE :1pFlag[21] = pFlag[22]:0x2 - pFlag[21]:0xa;------&gt;OPCODE :11pFlag[21] = 1;------&gt;OPCODE :10pFlag[21] = 0;------&gt;OPCODE :16------&gt;OPCODE :14pFlag[21] = 0x14------&gt;OPCODE :14pFlag[22] = 0------&gt;OPCODE :8pFlag[20] = 0;------&gt;OPCODE :14pFlag[21] = 0x14------&gt;OPCODE :9pFlag[21] = 0;------&gt;OPCODE :14pFlag[22] = 0x14------&gt;OPCODE :12exchange pFlag[22]:0, pFlag[21]:0x14------&gt;OPCODE :1pFlag[21] = pFlag[22]:0 - pFlag[21]:0x14;------&gt;OPCODE :11pFlag[21] = 1;------&gt;OPCODE :10pFlag[21] = 0;------&gt;OPCODE :16------&gt;OPCODE :14pFlag[21] = 0xc------&gt;OPCODE :14pFlag[22] = 0x13------&gt;OPCODE :9pFlag[22] = 0x2;------&gt;OPCODE :14pFlag[23] = 0------&gt;OPCODE :0pFlag[22] = pFlag[23]:0 + pFlag[22]:0x2;------&gt;OPCODE :9pFlag[22] = 0x31313131;------&gt;OPCODE :8pFlag[12] = 0x31313131;------&gt;OPCODE :14pFlag[21] = 0xd------&gt;OPCODE :14pFlag[22] = 0x13------&gt;OPCODE :9pFlag[22] = 0x2;------&gt;OPCODE :14pFlag[23] = 0x1------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x1 + pFlag[22]:0x2;------&gt;OPCODE :14pFlag[23] = 0------&gt;OPCODE :0pFlag[22] = pFlag[23]:0 + pFlag[22]:0x3;------&gt;OPCODE :9pFlag[22] = 0x32323232;------&gt;OPCODE :8pFlag[13] = 0x32323232;------&gt;OPCODE :14pFlag[21] = 0xc------&gt;OPCODE :14pFlag[22] = 0xc------&gt;OPCODE :9pFlag[22] = 0x31313131;------&gt;OPCODE :14pFlag[23] = 0xd------&gt;OPCODE :9pFlag[23] = 0x32323232;------&gt;OPCODE :14pFlag[24] = 0x10------&gt;OPCODE :2pFlag[23] = pFlag[24]:0x10 * pFlag[23]:0x32323232; ====------&gt;OPCODE :14pFlag[24] = 0xd------&gt;OPCODE :9pFlag[24] = 0x32323232;------&gt;OPCODE :14pFlag[25] = 0x20------&gt;OPCODE :12exchange pFlag[25]:0x32323232, pFlag[24]:0x20------&gt;OPCODE :3pFlag[24] = pFlag[25]:0x32323232 / pFlag[24]:0x20; ====------&gt;OPCODE :7pFlag[23] = pFlag[24]:0x1919191 ^ pFlag[23]:0x23232320;------&gt;OPCODE :14pFlag[24] = 0xd------&gt;OPCODE :9pFlag[24] = 0x32323232; ====------&gt;OPCODE :0pFlag[23] = pFlag[24]:0x32323232 + pFlag[23]:0x22b2b2b1; ====------&gt;OPCODE :14pFlag[24] = 0xb------&gt;OPCODE :9pFlag[24] = 0xce0a6e55;------&gt;OPCODE :14pFlag[25] = 0xb------&gt;OPCODE :9pFlag[25] = 0xce0a6e55;------&gt;OPCODE :14pFlag[26] = 0x3------&gt;OPCODE :5pFlag[25] = pFlag[26]:0x3 &amp; pFlag[25]:0xce0a6e55;------&gt;OPCODE :14pFlag[26] = 0xe------&gt;OPCODE :0pFlag[25] = pFlag[26]:0xe + pFlag[25]:0x1;------&gt;OPCODE :9pFlag[25] = 0x6f76;------&gt;OPCODE :0pFlag[24] = pFlag[25]:0x6f76 + pFlag[24]:0xce0a6e55;------&gt;OPCODE :7pFlag[23] = pFlag[24]:0xce0addcb ^ pFlag[23]:0x54e4e4e3;------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x9aee3928 + pFlag[22]:0x31313131; ===------&gt;OPCODE :8pFlag[12] = 0xcc1f6a59;------&gt;OPCODE :14pFlag[21] = 0xb------&gt;OPCODE :14pFlag[22] = 0xb------&gt;OPCODE :9pFlag[22] = 0xce0a6e55; === ä¸Šä¸€è½®å¾ªç¯å‰©ä¸‹çš„------&gt;OPCODE :14pFlag[23] = 0xa------&gt;OPCODE :9pFlag[23] = 0x75bcd15;------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x75bcd15 + pFlag[22]:0xce0a6e55;------&gt;OPCODE :8pFlag[11] = 0xd5663b6a;====------&gt;OPCODE :14pFlag[21] = 0xd------&gt;OPCODE :14pFlag[22] = 0xd------&gt;OPCODE :9pFlag[22] = 0x32323232;------&gt;OPCODE :14pFlag[23] = 0xc------&gt;OPCODE :9pFlag[23] = 0xcc1f6a59;------&gt;OPCODE :14pFlag[24] = 0x10------&gt;OPCODE :2pFlag[23] = pFlag[24]:0x10 * pFlag[23]:0xcc1f6a59; ===------&gt;OPCODE :14pFlag[24] = 0xc------&gt;OPCODE :9pFlag[24] = 0xcc1f6a59;------&gt;OPCODE :14pFlag[25] = 0x20------&gt;OPCODE :12exchange pFlag[25]:0xcc1f6a59, pFlag[24]:0x20------&gt;OPCODE :3pFlag[24] = pFlag[25]:0xcc1f6a59 / pFlag[24]:0x20;------&gt;OPCODE :7pFlag[23] = pFlag[24]:0xfe60fb53 ^ pFlag[23]:0xc1f6a590;------&gt;OPCODE :14pFlag[24] = 0xc------&gt;OPCODE :9pFlag[24] = 0xcc1f6a59;------&gt;OPCODE :0pFlag[23] = pFlag[24]:0xcc1f6a59 + pFlag[23]:0x3f965ec3;------&gt;OPCODE :14pFlag[24] = 0xb------&gt;OPCODE :9pFlag[24] = 0xd5663b6a;------&gt;OPCODE :14pFlag[25] = 0xb------&gt;OPCODE :9pFlag[25] = 0xd5663b6a;------&gt;OPCODE :14pFlag[26] = 0x800------&gt;OPCODE :12exchange pFlag[26]:0xd5663b6a, pFlag[25]:0x800------&gt;OPCODE :3pFlag[25] = pFlag[26]:0xd5663b6a / pFlag[25]:0x800;------&gt;OPCODE :14pFlag[26] = 0x3------&gt;OPCODE :5pFlag[25] = pFlag[26]:0x3 &amp; pFlag[25]:0xfffaacc8; ====------&gt;OPCODE :14pFlag[26] = 0xe------&gt;OPCODE :0pFlag[25] = pFlag[26]:0xe + pFlag[25]:0;------&gt;OPCODE :9pFlag[25] = 0x494c;------&gt;OPCODE :0pFlag[24] = pFlag[25]:0x494c + pFlag[24]:0xd5663b6a;===------&gt;OPCODE :7pFlag[23] = pFlag[24]:0xd56684b6 ^ pFlag[23]:0xbb5c91c; ===------&gt;OPCODE :0pFlag[22] = pFlag[23]:0xded34daa + pFlag[22]:0x32323232;------&gt;OPCODE :8pFlag[13] = 0x11057fdc; === ------&gt;OPCODE :14pFlag[21] = 0x13------&gt;OPCODE :9pFlag[21] = 0x2;------&gt;OPCODE :14pFlag[22] = 0------&gt;OPCODE :0pFlag[21] = pFlag[22]:0 + pFlag[21]:0x2;------&gt;OPCODE :14pFlag[22] = 0xc------&gt;OPCODE :9pFlag[22] = 0xcc1f6a59;------&gt;OPCODE :8pFlag[2] = 0xcc1f6a59;------&gt;OPCODE :14pFlag[21] = 0x13------&gt;OPCODE :9pFlag[21] = 0x2;------&gt;OPCODE :14pFlag[22] = 0x1------&gt;OPCODE :0pFlag[21] = pFlag[22]:0x1 + pFlag[21]:0x2;------&gt;OPCODE :14pFlag[22] = 0------&gt;OPCODE :0pFlag[21] = pFlag[22]:0 + pFlag[21]:0x3;------&gt;OPCODE :14pFlag[22] = 0xd------&gt;OPCODE :9pFlag[22] = 0x11057fdc;------&gt;OPCODE :8pFlag[3] = 0x11057fdc;------&gt;OPCODE :18 =============================================v13å‡†å¤‡å¼€å§‹------&gt;OPCODE :14pFlag[21] = 0x14------&gt;OPCODE :14pFlag[22] = 0x14------&gt;OPCODE :9pFlag[22] = 0x13;------&gt;OPCODE :14pFlag[23] = 0x1------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x1 + pFlag[22]:0x13;------&gt;OPCODE :8pFlag[20] = 0x14;------&gt;OPCODE :15------&gt;OPCODE :14pFlag[21] = 0x14------&gt;OPCODE :9pFlag[21] = 0x14;------&gt;OPCODE :14pFlag[22] = 0x14------&gt;OPCODE :12exchange pFlag[22]:0x14, pFlag[21]:0x14------&gt;OPCODE :1pFlag[21] = pFlag[22]:0x14 - pFlag[21]:0x14;------&gt;OPCODE :11pFlag[21] = 0;------&gt;OPCODE :10pFlag[21] = 1;------&gt;OPCODE :16------&gt;OPCODE :14pFlag[21] = 0x13------&gt;OPCODE :14pFlag[22] = 0x13------&gt;OPCODE :9pFlag[22] = 0;------&gt;OPCODE :14pFlag[23] = 0x2------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x2 + pFlag[22]:0;------&gt;OPCODE :8pFlag[19] = 0x2;------&gt;OPCODE :15------&gt;OPCODE :14pFlag[21] = 0x13------&gt;OPCODE :9pFlag[21] = 0x2;------&gt;OPCODE :14pFlag[22] = 0xa------&gt;OPCODE :12exchange pFlag[22]:0x2, pFlag[21]:0xa------&gt;OPCODE :1pFlag[21] = pFlag[22]:0x2 - pFlag[21]:0xa;------&gt;OPCODE :11pFlag[21] = 1;------&gt;OPCODE :10pFlag[21] = 0;------&gt;OPCODE :16------&gt;OPCODE :14pFlag[21] = 0x14------&gt;OPCODE :14pFlag[22] = 0------&gt;OPCODE :8pFlag[20] = 0;------&gt;OPCODE :14pFlag[21] = 0x14------&gt;OPCODE :9pFlag[21] = 0;------&gt;OPCODE :14pFlag[22] = 0x14------&gt;OPCODE :12exchange pFlag[22]:0, pFlag[21]:0x14------&gt;OPCODE :1pFlag[21] = pFlag[22]:0 - pFlag[21]:0x14;------&gt;OPCODE :11pFlag[21] = 1;------&gt;OPCODE :10pFlag[21] = 0;------&gt;OPCODE :16------&gt;OPCODE :14pFlag[21] = 0xc------&gt;OPCODE :14pFlag[22] = 0x13------&gt;OPCODE :9pFlag[22] = 0x2;------&gt;OPCODE :14pFlag[23] = 0------&gt;OPCODE :0pFlag[22] = pFlag[23]:0 + pFlag[22]:0x2;------&gt;OPCODE :9pFlag[22] = 0xcc1f6a59;------&gt;OPCODE :8pFlag[12] = 0xcc1f6a59;------&gt;OPCODE :14pFlag[21] = 0xd------&gt;OPCODE :14pFlag[22] = 0x13------&gt;OPCODE :9pFlag[22] = 0x2;------&gt;OPCODE :14pFlag[23] = 0x1------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x1 + pFlag[22]:0x2;------&gt;OPCODE :14pFlag[23] = 0------&gt;OPCODE :0pFlag[22] = pFlag[23]:0 + pFlag[22]:0x3;------&gt;OPCODE :9pFlag[22] = 0x11057fdc;------&gt;OPCODE :8pFlag[13] = 0x11057fdc;------&gt;OPCODE :14pFlag[21] = 0xb------&gt;OPCODE :14pFlag[22] = 0xb------&gt;OPCODE :9pFlag[22] = 0x798dcdf9;------&gt;OPCODE :14pFlag[23] = 0xa------&gt;OPCODE :9pFlag[23] = 0x154cbf7; = =====ç³»ç»Ÿä¸­çš„ç«‹å³æ•°------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x154cbf7 + pFlag[22]:0x798dcdf9; == è¿™2ä¸ªæ•°æ˜¯å›ºå®šçš„------&gt;OPCODE :8pFlag[11] = 0x7ae299f0; =========------&gt;OPCODE :14pFlag[21] = 0xc------&gt;OPCODE :14pFlag[22] = 0xc------&gt;OPCODE :9pFlag[22] = 0xcc1f6a59;------&gt;OPCODE :14pFlag[23] = 0xd------&gt;OPCODE :9pFlag[23] = 0x11057fdc;------&gt;OPCODE :14pFlag[24] = 0x10------&gt;OPCODE :2pFlag[23] = pFlag[24]:0x10 * pFlag[23]:0x11057fdc;========------&gt;OPCODE :14pFlag[24] = 0------&gt;OPCODE :14pFlag[25] = 0xe------&gt;OPCODE :0pFlag[24] = pFlag[25]:0xe + pFlag[24]:0;------&gt;OPCODE :9pFlag[24] = 0x5354;------&gt;OPCODE :0pFlag[23] = pFlag[24]:0x5354 + pFlag[23]:0x1057fdc0; =======------&gt;OPCODE :14pFlag[24] = 0xd------&gt;OPCODE :9pFlag[24] = 0x11057fdc;------&gt;OPCODE :14pFlag[25] = 0xb------&gt;OPCODE :9pFlag[25] = 0x7ae299f0;------&gt;OPCODE :0pFlag[24] = pFlag[25]:0x7ae299f0 + pFlag[24]:0x11057fdc;------&gt;OPCODE :14pFlag[25] = 0xd------&gt;OPCODE :9pFlag[25] = 0x11057fdc;------&gt;OPCODE :14pFlag[26] = 0x20------&gt;OPCODE :12exchange pFlag[26]:0x11057fdc, pFlag[25]:0x20------&gt;OPCODE :3pFlag[25] = pFlag[26]:0x11057fdc / pFlag[25]:0x20; ### 0x882bfe------&gt;OPCODE :14pFlag[26] = 0x1------&gt;OPCODE :14pFlag[27] = 0xe------&gt;OPCODE :0pFlag[26] = pFlag[27]:0xe + pFlag[26]:0x1;------&gt;OPCODE :9pFlag[26] = 0x4f4d;------&gt;OPCODE :0pFlag[25] = pFlag[26]:0x4f4d + pFlag[25]:0x882bfe;------&gt;OPCODE :7pFlag[24] = pFlag[25]:0x887b4b ^ pFlag[24]:0x8be819cc; =====------&gt;OPCODE :7pFlag[23] = pFlag[24]:0x8b606287 ^ pFlag[23]:0x10585114;==------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x9b383393 + pFlag[22]:0xcc1f6a59;=====------&gt;OPCODE :8pFlag[12] = 0x67579dec; ######------&gt;OPCODE :14pFlag[21] = 0xd------&gt;OPCODE :14pFlag[22] = 0xd------&gt;OPCODE :9pFlag[22] = 0x11057fdc;------&gt;OPCODE :14pFlag[23] = 0xc------&gt;OPCODE :9pFlag[23] = 0x67579dec;------&gt;OPCODE :14pFlag[24] = 0x10------&gt;OPCODE :2pFlag[23] = pFlag[24]:0x10 * pFlag[23]:0x67579dec;------&gt;OPCODE :14pFlag[24] = 0x2------&gt;OPCODE :14pFlag[25] = 0xe------&gt;OPCODE :0pFlag[24] = pFlag[25]:0xe + pFlag[24]:0x2;------&gt;OPCODE :9pFlag[24] = 0x2074;------&gt;OPCODE :0pFlag[23] = pFlag[24]:0x2074 + pFlag[23]:0x7579dec0; === 49------&gt;OPCODE :14pFlag[24] = 0xc------&gt;OPCODE :9pFlag[24] = 0x67579dec;------&gt;OPCODE :14pFlag[25] = 0xb------&gt;OPCODE :9pFlag[25] = 0x7ae299f0;------&gt;OPCODE :0pFlag[24] = pFlag[25]:0x7ae299f0 + pFlag[24]:0x67579dec; =====------&gt;OPCODE :14pFlag[25] = 0xc------&gt;OPCODE :9pFlag[25] = 0x67579dec;------&gt;OPCODE :14pFlag[26] = 0x20------&gt;OPCODE :12exchange pFlag[26]:0x67579dec, pFlag[25]:0x20------&gt;OPCODE :3pFlag[25] = pFlag[26]:0x67579dec / pFlag[25]:0x20;===&#x27;0x33abcef&#x27;------&gt;OPCODE :14pFlag[26] = 0x3------&gt;OPCODE :14pFlag[27] = 0xe------&gt;OPCODE :0pFlag[26] = pFlag[27]:0xe + pFlag[26]:0x3;------&gt;OPCODE :9pFlag[26] = 0x6561;------&gt;OPCODE :0pFlag[25] = pFlag[26]:0x6561 + pFlag[25]:0x33abcef;------&gt;OPCODE :7pFlag[24] = pFlag[25]:0x33b2250 ^ pFlag[24]:0xe23a37dc;------&gt;OPCODE :7pFlag[23] = pFlag[24]:0xe101158c ^ pFlag[23]:0x7579ff34;------&gt;OPCODE :0pFlag[22] = pFlag[23]:0x9478eab8 + pFlag[22]:0x11057fdc; # &#x27;0xa57e6a94&#x27;------&gt;OPCODE :8pFlag[13] = 0xa57e6a94;------&gt;OPCODE :14pFlag[21] = 0x13------&gt;OPCODE :9pFlag[21] = 0x2;------&gt;OPCODE :14pFlag[22] = 0------&gt;OPCODE :0pFlag[21] = pFlag[22]:0 + pFlag[21]:0x2;------&gt;OPCODE :14pFlag[22] = 0xc------&gt;OPCODE :9pFlag[22] = 0x67579dec;------&gt;OPCODE :8pFlag[2] = 0x67579dec;------&gt;OPCODE :14pFlag[21] = 0x13------&gt;OPCODE :9pFlag[21] = 0x2;------&gt;OPCODE :14pFlag[22] = 0x1------&gt;OPCODE :0pFlag[21] = pFlag[22]:0x1 + pFlag[21]:0x2;------&gt;OPCODE :14pFlag[22] = 0------&gt;OPCODE :0pFlag[21] = pFlag[22]:0 + pFlag[21]:0x3;------&gt;OPCODE :14pFlag[22] = 0xd------&gt;OPCODE :9pFlag[22] = 0xa57e6a94;------&gt;OPCODE :8pFlag[3] = 0xa57e6a94;------&gt;OPCODE :18---------------------------------------------------------------------------- åˆ†æç®—æ³• 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758A = FLAG[0:4]B = FLAG[4:8]pFlag[23] = B * 0x10pFlag[24] = B / 0X20 pFlag[23] = pFlag[23] ^ pFlag[24]pFlag[23] = B + pFlag[23] pFlag[23] = (0xCE0A6E55 + 0X6F76) ^ pFlag[23] pFlag[22] = pFlag[23] + A TMP1 = pFlag[22] # 173è¡Œ 0xcc1f6a59 ***V12å¯¼å‡º # v0pFlag[22] = 0xCE0A6E55 # (è¿‡ä¼šå›æ¥è¡¥å‘ï¼Œè¿™ä¸ªæ˜¯ä¸Šä¸€è½®å¾ªç¯å‰©ä¸‹çš„) è¿™ä¸ªä¸FLAGæ— å…³ï¼Œæ˜¯å›ºå®šçš„pFlag[22] = 0x75bcd15(ç«‹å³æ•°) + 0xce0a6e55TMP2 = pFlag[22] # 187è¡Œ 0xd5663b6a #TMP2 = sum1pFlag[23] = TMP1pFlag[23] = TMP1 * 0X10 # 201pFlag[24] = TMP1 / 0x20 # 213pFlag[23] = pFlag[23] ^ pFlag[24]pFlag[23] = TMP1 + pFlag[23] pFlag[26] = TMP2pFlag[25] = pFlag[26] / 0x800 #233è¡ŒpFlag[24] = TMP2 + 0x494c ###245pFlag[23] = pFlag[24] ^ pFlag[23]pFlag[22] = pFlag[23] + B TMP3 = pFlag[22] ### 251è¡Œ 0x11057fdc ***V12å¯¼å‡º #v1pFlag[22] = 0x154cbf7(ç«‹å³æ•°) + 0x798dcdf9; #è¿™2ä¸ªæ•°æ˜¯å›ºå®šçš„ #åœ¨ç¬¬ä¸€è½®çš„æ—¶å€™æ˜¯è¿™ä¸ªï¼Œå…¶ä»–çš„è¿˜æ²¡æµ‹è¯•TMP4 = pFlag[22] ###407è¡Œ 0x7ae299f0pFlag[23] = TMP3 * 0X10pFlag[23] = pFlag[23] + 0X5354 # 421 pFlag[24] = TMP4 + TMP3 #441 pFlag[25] = TMP3 / 0x20 #451 ### 0x882bfepFlag[25] = 0x4f4d + pFlag[25] pFlag[24] = pFlag[25] ^ pFlag[24]pFlag[23] = pFlag[24] ^ pFlag[23] #465 ## 0x9b383393pFlag[22] = pFlag[23] + TMP1TMP5 = pFlag[22] #### 469 0x67579decpFlag[23] = TMP5 * 0X10pFlag[23] = pFlag[23] + 0x2074 ## 0x7579ff34pFlag[24] = TMP4 + TMP5 ####503è¡ŒpFlag[25] = TMP5 / 0x20pFlag[25] = pFlag[25] + 0x6561pFlag[24] = pFlag[25] ^ pFlag[24]pFlag[23] = pFlag[24] ^ pFlag[23]pFlag[22] = pFlag[23] + TMP3 # 529è¡Œ 0xa57e6a94TMP6 = pFlag[22] # 0xa57e6a94 é€šè¿‡ * 0x10 ã€/0x20ã€ /0x800ã€ &amp;3ç­‰ç‰¹å¾ï¼ŒçŒœæµ‹æ˜¯xteaï¼Œ teaç®—æ³• ä¸€è¾¹çŒœä¸€è¾¹è¿˜åŸç®—æ³•,ç”¨Cè¯­è¨€å†™å‡º1è½®çš„å¾ªç¯åŠ å¯†ç®—æ³• 1234567891011121314151617181920int tea_key[4] = &#123; 0X5354, 0x4f4d, 0x2074, 0x6561 &#125;;int xtea_key[4] = &#123; 0x494c, 0X6F76 , 0x6520, 0x4355 &#125;;void encrypt(int* v, int&amp; sum_xtea, int&amp; sum_tea)&#123; int v0 = v[0], v1 = v[1]; v0 += (((v1 &lt;&lt; 4) ^ (v1 / 0x20)) + v1) ^ (sum_xtea + xtea_key[sum_xtea &amp; 3]); sum_xtea += 0x75bcd15; v1 += (((v0 &lt;&lt; 4) ^ (v0 / 0x20)) + v0) ^ (sum_xtea + xtea_key[(sum_xtea / 0x800) &amp; 3]); sum_tea += 0x154cbf7; v0 += ((v1 &lt;&lt; 4) + tea_key[0]) ^ (v1 + sum_tea) ^ ((v1 / 0x20) + tea_key[1]); v1 += ((v0 &lt;&lt; 4) + tea_key[2]) ^ (v0 + sum_tea) ^ ((v0 / 0x20) + tea_key[3]); v[0] = v0; v[1] = v1;&#125; sum_tea å’Œ sum_xteaï¼Œå¯¹äºæ¯ä¸€ç»„æ¥è¯´ï¼Œåˆå§‹å€¼æ˜¯ä¸åŒçš„ï¼Œæ¯”å¦‚ç¬¬äºŒç»„è¿™é‡Œæ˜¯0x798dcdf9 å’Œ 0xce0a6e55 æœ€åé€šè¿‡æ‰“å°ä¸‰ï¼Œå››ï¼Œäº”ç»„ç¬¬ä¸€ä¸ªå¾ªç¯çš„æ—¥å¿—ï¼Œæ¥ä¸ç¬¬äºŒç»„çš„æ—¥å¿—åšå¯¹æ¯”ï¼Œæ‰¾åˆ°äº†æ‰€æœ‰ç»„çš„åˆå§‹çš„sum_tea å’Œ sum_xtea 123456int sum[4][2] = &#123; 0xCE0A6E55, 0x798dcdf9, 0x613673f9, 0x942dbd45, 0xf462799d, 0xaecdac91, 0x878e7f41, 0xc96d9bdd&#125;; æœ€ç»ˆå†™è„šæœ¬è§£å¯† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283#include &lt;windows.h&gt;#include &lt;stdio.h&gt;int sum[4][2] = &#123; 0xCE0A6E55, 0x798dcdf9, 0x613673f9, 0x942dbd45, 0xf462799d, 0xaecdac91, 0x878e7f41, 0xc96d9bdd&#125;;int tea_key[4] = &#123; 0X5354, 0x4f4d, 0x2074, 0x6561 &#125;;int xtea_key[4] = &#123; 0x494c, 0X6F76 , 0x6520, 0x4355 &#125;;void encrypt(int* v, int&amp; sum_xtea, int&amp; sum_tea)&#123; int v0 = v[0], v1 = v[1]; v0 += (((v1 &lt;&lt; 4) ^ (v1 / 0x20)) + v1) ^ (sum_xtea + xtea_key[sum_xtea &amp; 3]); sum_xtea += 0x75bcd15; v1 += (((v0 &lt;&lt; 4) ^ (v0 / 0x20)) + v0) ^ (sum_xtea + xtea_key[(sum_xtea / 0x800) &amp; 3]); sum_tea += 0x154cbf7; v0 += ((v1 &lt;&lt; 4) + tea_key[0]) ^ (v1 + sum_tea) ^ ((v1 / 0x20) + tea_key[1]); v1 += ((v0 &lt;&lt; 4) + tea_key[2]) ^ (v0 + sum_tea) ^ ((v0 / 0x20) + tea_key[3]); v[0] = v0; v[1] = v1;&#125;void decrypt(int* v, int&amp; sum_xtea, int&amp; sum_tea)&#123; int v0 = v[0], v1 = v[1]; v1 -= ((v0 &lt;&lt; 4) + tea_key[2]) ^ (v0 + sum_tea) ^ ((v0 / 0x20) + tea_key[3]); v0 -= ((v1 &lt;&lt; 4) + tea_key[0]) ^ (v1 + sum_tea) ^ ((v1 / 0x20) + tea_key[1]); sum_tea -= 0x154cbf7;; v1 -= (((v0 &lt;&lt; 4) ^ (v0 / 0x20)) + v0) ^ (sum_xtea + xtea_key[(sum_xtea / 0x800) &amp; 3]); sum_xtea -= 0x75bcd15; v0 -= (((v1 &lt;&lt; 4) ^ (v1 / 0x20)) + v1) ^ (sum_xtea + xtea_key[sum_xtea &amp; 3]); v[0] = v0; v[1] = v1;&#125;char compare_date[100] = //è¿™é‡Œæ˜¯ä»ç¨‹åºä¸­æå–çš„åŠ å¯†åçš„flagçš„å€¼&#123; 0xE8, 0xFA, 0xE0, 0xAE, 0x01, 0x41, 0x3E, 0xFC, 0x92, 0xAD, 0x7C, 0x16, 0xBE, 0x6C, 0xEA, 0x51, 0x00, 0x01, 0x2A, 0x24, 0x1B, 0x1A, 0x51, 0x01, 0x94, 0x66, 0x4D, 0x51, 0xEB, 0xBF, 0x5F, 0x2F, 0x98, 0x63, 0xD3, 0x46, 0xF0, 0xE3, 0xEE, 0x79&#125;;int main()&#123; int v[2] = &#123; 0 &#125;; int* encFlag = (int*)compare_date; //flagçš„å‰8ä¸ªå­—ç¬¦çˆ†ç ´å¾—åˆ°çš„ L3HCTF&#123;D for (int j = 0; j &lt; 4; j++) //å32ä¸ªå­—ç¬¦ï¼Œåˆ†4ç»„ &#123; for (int i = 0; i &lt; 20; i++) encrypt(v, sum[j][0], sum[j][1]); //æå‡sum_xtea å’Œ sum_tea for (int i = 0; i &lt; 20; i++) decrypt(&amp;encFlag[j * 2 + 2], sum[j][0], sum[j][1]); &#125; char* flag = (char*)&amp;encFlag[2]; printf(&quot;flag is L3HCTF&#123;D%s \\n&quot;, flag); return 0;&#125;// L3HCTF&#123;D0uBle_vM_W1th_dOubIe_TEA&#125; LoadIDAæ‰“å¼€ç¨‹åºåˆ†æ è¿›å…¥LOAD_PEå‡½æ•°ï¼Œå°±æ˜¯åˆ›å»ºäº†ä¸ªå‚€å„¡è¿›ç¨‹ åœ¨ResumeThreadè¿™é‡Œä¸‹æ–­ç‚¹ï¼Œdumpï¼Œç„¶åforemoståˆ†ç¦» æ³¨æ„åœ¨foremoståˆ†ç¦»çš„æ—¶å€™è¦æŠŠdumpä¸‹æ¥çš„ç¨‹åºçš„MZå¤´æŠ¹å»ï¼Œè¿™æ ·æ‰èƒ½åˆ†ç¦»è§£å¯†åçš„PEæ–‡ä»¶æ¥ IDAæ‰“å¼€åˆ†æ è·å–flagåï¼Œå¯¹flagä¸­çš„å­—ç¬¦åœ¨ 0x30-0x39æˆ– a-f èŒƒå›´åšäº†ä¸ªå°å¤„ç† 12340x30 - 0x39 ---&gt; 0x00 - 0x09a - f ---&gt; 0xA ---0xF# ç„¶åå‡è®¾è¾“å…¥çš„æ˜¯123f --&gt; 0x12, 0x3f å­˜åœ¨äº†0x434380çš„ä½ç½® æ³¨æ„è¿™é‡Œå…¨æ˜¯å¯¹åº”çš„åå…­è¿›åˆ¶ï¼ŒçŒœæµ‹è¾“å…¥çš„flagçš„èŒƒå›´å°±æ˜¯[0-9a-f] æœ€ç»ˆ434380å¤„çš„æ•°æ®æ˜¯13ä¸ªã€‚ä¸‹é¢åˆåˆ†ä¸º9 + 4 ä¸ªï¼Œæ­£å¥½æ˜¯3å’Œ2çš„å¹³æ–¹ï¼Œå¹¶ä¸”ä¸‹é¢éªŒè¯çš„æ—¶å€™ä¹Ÿæ˜¯åˆ†ä¸º9 + 4è¿›è¡ŒéªŒè¯çš„ çŒœæµ‹æ˜¯3 * 3 + 2 * 2çš„æŸä¸ªçŸ©é˜µè¿ç®—, åœ¨ä¸Šè¿°å›¾89è¡Œä½ç½®ä¸‹æ–­ç‚¹ï¼Œä¿®æ”¹srcå¤„çš„æ•°æ®ä¸º100010001, 12341 0 00 1 00 0 1æ­£å¥½æ˜¯å•ä½çŸ©é˜µ ç„¶åè¿è¡Œï¼ŒåŠ å¯†åå‘ç°Srcå¤„çš„æ•°æ®æ²¡å˜ï¼Œä½†æ˜¯v29å¤„çš„æ•°æ®å…¨ä¹±äº†ï¼ŒçŒœæµ‹æ˜¯é€†çŸ©é˜µ æå–å‡ºåŠ å¯†åSrc å’Œ v29å¤„çš„æ•°æ® 12345678Src: 1 0 -90 -1 -6-1 -2 -4 v29:7 330 13 å†™è„šæœ¬æ±‚é€†çŸ©é˜µï¼Œå¹¶è½¬æ¢ä¸ºflag 12345678910111213141516171819import numpyif __name__ == &quot;__main__&quot;: a = numpy.array([[1, 0, -9], [0, -1, -6], [-1, -2, -4]]) b = numpy.array([[7, 3], [30, 13]]) a_inv = numpy.linalg.inv(a) b_inv = numpy.linalg.inv(b) a_list = [list(i) for i in a_inv] b_list = [list(i) for i in b_inv] flag_list = a_list[0] + a_list[1] + a_list[2] + b_list[0] + b_list[1] flag_list = [int(i) &amp; 0xff for i in flag_list] flag = bytes(flag_list).hex() print(flag) # f812f706f306ff02ff0dfde207 æ‹¼æ¥åè¿›è¡ŒéªŒè¯ï¼ŒLoad.exeåœ¨ ResumeThreadé‚£é‡Œä¸‹æ–­ç‚¹ï¼Œè¾“å…¥flagï¼Œç¨‹åºæ–­ä¸‹ï¼Œåœ¨è¿è¡Œdumpæå–å‡ºæ¥çš„exeï¼ŒéªŒè¯æˆåŠŸ æœ€ç»ˆflagä¸º : flag&#123;f812f706f306ff02ff0dfde207&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://zzzzsky.github.io/categories/CTF/"}],"tags":[{"name":"CTFWP","slug":"CTFWP","permalink":"https://zzzzsky.github.io/tags/CTFWP/"},{"name":"vm","slug":"vm","permalink":"https://zzzzsky.github.io/tags/vm/"}]},{"title":"2021å¼ºç½‘æ‹Ÿæ€_babyre","slug":"2021å¼ºç½‘æ‹Ÿæ€_babyre","date":"2021-11-11T16:00:00.000Z","updated":"2021-11-29T11:42:10.176Z","comments":true,"path":"2021/11/12/2021å¼ºç½‘æ‹Ÿæ€_babyre/","link":"","permalink":"https://zzzzsky.github.io/2021/11/12/2021%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81_babyre/","excerpt":"","text":"2021å¼ºç½‘æ‹Ÿæ€rebabyreIDAåŠ¨æ€è°ƒè¯•ï¼Œè¿›å…¥å…³é”®å‡½æ•° åˆ†æå‡½æ•°ï¼Œæå–æ•°æ®ï¼Œè¿˜åŸç®—æ³• 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142#include &lt;stdio.h&gt;typedef unsigned char BYTE;typedef unsigned long DWORD;char _flag[] = &quot;1234567890123456&quot;;DWORD cmp_data[8] = &#123;0xE82BA79E, 0x83EA91DE, 0x241BCCFE, 0x2836973B, 0x5F86C92D, 0x0C8094E88, 0x0FEC81BB0, 0x0D5277623&#125;;DWORD key[60] = &#123;0xc3bb95b, 0x578c9d63, 0x7faca21c, 0x29522e93, 0xb268681, 0xda705e01, 0xa7732a53, 0x72e0c013, 0x4b4fcf3b, 0xe46963a6, 0x3eeea9d2, 0xefb38fbb, 0xd156d880, 0x7d037452, 0xd593ea40, 0xd5223126, 0xaf26ac9d, 0xda87ca74, 0xd15d2669, 0x6cadaad, 0xac55acd2, 0xa8909e12, 0xb1db66, 0xcc4c1870, 0x75a166e9, 0xbdaec1d, 0xd797fcc4, 0x9cd3659b, 0x4c532c0, 0xa8214574, 0xccfdc316, 0x6019b4a2, 0x7e7b8af4, 0xdc4d10d9, 0x4b44995f, 0x2ca5c858, 0xace477b4, 0x64dc8662, 0xace477b4, 0xbbc35df5, 0xa2369a2d, 0x97098986, 0x67e15107, 0xfd0b6e21, 0xc838f1d6, 0xc838f1d6, 0x17272a41, 0x38f9ff4a, 0x353f13ab, 0xf0e8d881, 0x9aea3f26, 0x5f3df40c, 0x0, 0xdf1fdb97, 0x2fded50b, 0x49b04218, 0xf3000000, 0xc3fa1e0f, 0xf3000000, 0x841f&#125;;DWORD dword_405420[256] = &#123;0xa7f45150, 0x65417e53, 0xa4171ac3, 0x5e273a96, 0x6bab3bcb, 0x459d1ff1, 0x58faacab, 0x3e34b93, 0xfa302055, 0x6d76adf6, 0x76cc8891, 0x4c02f525, 0xd7e54ffc, 0xcb2ac5d7, 0x44352680, 0xa362b58f, 0x5ab1de49, 0x1bba2567, 0xeea4598, 0xc0fe5de1, 0x752fc302, 0xf04c8112, 0x97468da3, 0xf9d36bc6, 0x5f8f03e7, 0x9c921595, 0x7a6dbfeb, 0x595295da, 0x83bed42d, 0x217458d3, 0x69e04929, 0xc8c98e44, 0x89c2756a, 0x798ef478, 0x3e58996b, 0x71b927dd, 0x4fe1beb6, 0xad88f017, 0xac20c966, 0x3ace7db4, 0x4adf6318, 0x311ae582, 0x33519760, 0x7f536245, 0x7764b1e0, 0xae6bbb84, 0xa081fe1c, 0x2b08f994, 0x68487058, 0xfd458f19, 0x6cde9487, 0xf87b52b7, 0xd373ab23, 0x24b72e2, 0x8f1fe357, 0xab55662a, 0x28ebb207, 0xc2b52f03, 0x7bc5869a, 0x837d3a5, 0x872830f2, 0xa5bf23b2, 0x6a0302ba, 0x8216ed5c, 0x1ccf8a2b, 0xb479a792, 0xf207f3f0, 0xe2694ea1, 0xf4da65cd, 0xbe0506d5, 0x6234d11f, 0xfea6c48a, 0x532e349d, 0x55f3a2a0, 0xe18a0532, 0xebf6a475, 0xec830b39, 0xef6040aa, 0x9f715e06, 0x106ebd51, 0x8a213ef9, 0x6dd963d, 0x53eddae, 0xbde64d46, 0x8d5491b5, 0x5dc47105, 0xd406046f, 0x155060ff, 0xfb981924, 0xe9bdd697, 0x434089cc, 0x9ed96777, 0x42e8b0bd, 0x8b890788, 0x5b19e738, 0xeec879db, 0xa7ca147, 0xf427ce9, 0x1e84f8c9, 0x0, 0x86800983, 0xed2b3248, 0x70111eac, 0x725a6c4e, 0xff0efdfb, 0x38850f56, 0xd5ae3d1e, 0x392d3627, 0xd90f0a64, 0xa65c6821, 0x545b9bd1, 0x2e36243a, 0x670a0cb1, 0xe757930f, 0x96eeb4d2, 0x919b1b9e, 0xc5c0804f, 0x20dc61a2, 0x4b775a69, 0x1a121c16, 0xba93e20a, 0x2aa0c0e5, 0xe0223c43, 0x171b121d, 0xd090e0b, 0xc78bf2ad, 0xa8b62db9, 0xa91e14c8, 0x19f15785, 0x775af4c, 0xdd99eebb, 0x607fa3fd, 0x2601f79f, 0xf5725cbc, 0x3b6644c5, 0x7efb5b34, 0x29438b76, 0xc623cbdc, 0xfcedb668, 0xf1e4b863, 0xdc31d7ca, 0x85634210, 0x22971340, 0x11c68420, 0x244a857d, 0x3dbbd2f8, 0x32f9ae11, 0xa129c76d, 0x2f9e1d4b, 0x30b2dcf3, 0x52860dec, 0xe3c177d0, 0x16b32b6c, 0xb970a999, 0x489411fa, 0x64e94722, 0x8cfca8c4, 0x3ff0a01a, 0x2c7d56d8, 0x903322ef, 0x4e4987c7, 0xd138d9c1, 0xa2ca8cfe, 0xbd49836, 0x81f5a6cf, 0xde7aa528, 0x8eb7da26, 0xbfad3fa4, 0x9d3a2ce4, 0x9278500d, 0xcc5f6a9b, 0x467e5462, 0x138df6c2, 0xb8d890e8, 0xf7392e5e, 0xafc382f5, 0x805d9fbe, 0x93d0697c, 0x2dd56fa9, 0x1225cfb3, 0x99acc83b, 0x7d1810a7, 0x639ce86e, 0xbb3bdb7b, 0x7826cd09, 0x18596ef4, 0xb79aec01, 0x9a4f83a8, 0x6e95e665, 0xe6ffaa7e, 0xcfbc2108, 0xe815efe6, 0x9be7bad9, 0x366f4ace, 0x99fead4, 0x7cb029d6, 0xb2a431af, 0x233f2a31, 0x94a5c630, 0x66a235c0, 0xbc4e7437, 0xca82fca6, 0xd090e0b0, 0xd8a73315, 0x9804f14a, 0xdaec41f7, 0x50cd7f0e, 0xf691172f, 0xd64d768d, 0xb0ef434d, 0x4daacc54, 0x496e4df, 0xb5d19ee3, 0x886a4c1b, 0x1f2cc1b8, 0x5165467f, 0xea5e9d04, 0x358c015d, 0x7487fa73, 0x410bfb2e, 0x1d67b35a, 0xd2db9252, 0x5610e933, 0x47d66d13, 0x61d79a8c, 0xca1377a, 0x14f8598e, 0x3c13eb89, 0x27a9ceee, 0xc961b735, 0xe51ce1ed, 0xb1477a3c, 0xdfd29c59, 0x73f2553f, 0xce141879, 0x37c773bf, 0xcdf753ea, 0xaafd5f5b, 0x6f3ddf14, 0xdb447886, 0xf3afca81, 0xc468b93e, 0x3424382c, 0x40a3c25f, 0xc31d1672, 0x25e2bc0c, 0x493c288b, 0x950dff41, 0x1a83971, 0xb30c08de, 0xe4b4d89c, 0xc1566490, 0x84cb7b61, 0xb632d570, 0x5c6c4874, 0x57b8d042&#125;;DWORD dword_405820[256] = &#123;0xf45150a7, 0x417e5365, 0x171ac3a4, 0x273a965e, 0xab3bcb6b, 0x9d1ff145, 0xfaacab58, 0xe34b9303, 0x302055fa, 0x76adf66d, 0xcc889176, 0x2f5254c, 0xe54ffcd7, 0x2ac5d7cb, 0x35268044, 0x62b58fa3, 0xb1de495a, 0xba25671b, 0xea45980e, 0xfe5de1c0, 0x2fc30275, 0x4c8112f0, 0x468da397, 0xd36bc6f9, 0x8f03e75f, 0x9215959c, 0x6dbfeb7a, 0x5295da59, 0xbed42d83, 0x7458d321, 0xe0492969, 0xc98e44c8, 0xc2756a89, 0x8ef47879, 0x58996b3e, 0xb927dd71, 0xe1beb64f, 0x88f017ad, 0x20c966ac, 0xce7db43a, 0xdf63184a, 0x1ae58231, 0x51976033, 0x5362457f, 0x64b1e077, 0x6bbb84ae, 0x81fe1ca0, 0x8f9942b, 0x48705868, 0x458f19fd, 0xde94876c, 0x7b52b7f8, 0x73ab23d3, 0x4b72e202, 0x1fe3578f, 0x55662aab, 0xebb20728, 0xb52f03c2, 0xc5869a7b, 0x37d3a508, 0x2830f287, 0xbf23b2a5, 0x302ba6a, 0x16ed5c82, 0xcf8a2b1c, 0x79a792b4, 0x7f3f0f2, 0x694ea1e2, 0xda65cdf4, 0x506d5be, 0x34d11f62, 0xa6c48afe, 0x2e349d53, 0xf3a2a055, 0x8a0532e1, 0xf6a475eb, 0x830b39ec, 0x6040aaef, 0x715e069f, 0x6ebd5110, 0x213ef98a, 0xdd963d06, 0x3eddae05, 0xe64d46bd, 0x5491b58d, 0xc471055d, 0x6046fd4, 0x5060ff15, 0x981924fb, 0xbdd697e9, 0x4089cc43, 0xd967779e, 0xe8b0bd42, 0x8907888b, 0x19e7385b, 0xc879dbee, 0x7ca1470a, 0x427ce90f, 0x84f8c91e, 0x0, 0x80098386, 0x2b3248ed, 0x111eac70, 0x5a6c4e72, 0xefdfbff, 0x850f5638, 0xae3d1ed5, 0x2d362739, 0xf0a64d9, 0x5c6821a6, 0x5b9bd154, 0x36243a2e, 0xa0cb167, 0x57930fe7, 0xeeb4d296, 0x9b1b9e91, 0xc0804fc5, 0xdc61a220, 0x775a694b, 0x121c161a, 0x93e20aba, 0xa0c0e52a, 0x223c43e0, 0x1b121d17, 0x90e0b0d, 0x8bf2adc7, 0xb62db9a8, 0x1e14c8a9, 0xf1578519, 0x75af4c07, 0x99eebbdd, 0x7fa3fd60, 0x1f79f26, 0x725cbcf5, 0x6644c53b, 0xfb5b347e, 0x438b7629, 0x23cbdcc6, 0xedb668fc, 0xe4b863f1, 0x31d7cadc, 0x63421085, 0x97134022, 0xc6842011, 0x4a857d24, 0xbbd2f83d, 0xf9ae1132, 0x29c76da1, 0x9e1d4b2f, 0xb2dcf330, 0x860dec52, 0xc177d0e3, 0xb32b6c16, 0x70a999b9, 0x9411fa48, 0xe9472264, 0xfca8c48c, 0xf0a01a3f, 0x7d56d82c, 0x3322ef90, 0x4987c74e, 0x38d9c1d1, 0xca8cfea2, 0xd498360b, 0xf5a6cf81, 0x7aa528de, 0xb7da268e, 0xad3fa4bf, 0x3a2ce49d, 0x78500d92, 0x5f6a9bcc, 0x7e546246, 0x8df6c213, 0xd890e8b8, 0x392e5ef7, 0xc382f5af, 0x5d9fbe80, 0xd0697c93, 0xd56fa92d, 0x25cfb312, 0xacc83b99, 0x1810a77d, 0x9ce86e63, 0x3bdb7bbb, 0x26cd0978, 0x596ef418, 0x9aec01b7, 0x4f83a89a, 0x95e6656e, 0xffaa7ee6, 0xbc2108cf, 0x15efe6e8, 0xe7bad99b, 0x6f4ace36, 0x9fead409, 0xb029d67c, 0xa431afb2, 0x3f2a3123, 0xa5c63094, 0xa235c066, 0x4e7437bc, 0x82fca6ca, 0x90e0b0d0, 0xa73315d8, 0x4f14a98, 0xec41f7da, 0xcd7f0e50, 0x91172ff6, 0x4d768dd6, 0xef434db0, 0xaacc544d, 0x96e4df04, 0xd19ee3b5, 0x6a4c1b88, 0x2cc1b81f, 0x65467f51, 0x5e9d04ea, 0x8c015d35, 0x87fa7374, 0xbfb2e41, 0x67b35a1d, 0xdb9252d2, 0x10e93356, 0xd66d1347, 0xd79a8c61, 0xa1377a0c, 0xf8598e14, 0x13eb893c, 0xa9ceee27, 0x61b735c9, 0x1ce1ede5, 0x477a3cb1, 0xd29c59df, 0xf2553f73, 0x141879ce, 0xc773bf37, 0xf753eacd, 0xfd5f5baa, 0x3ddf146f, 0x447886db, 0xafca81f3, 0x68b93ec4, 0x24382c34, 0xa3c25f40, 0x1d1672c3, 0xe2bc0c25, 0x3c288b49, 0xdff4195, 0xa8397101, 0xc08deb3, 0xb4d89ce4, 0x566490c1, 0xcb7b6184, 0x32d570b6, 0x6c48745c, 0xb8d04257&#125;;DWORD dword_405C20[256] = &#123;0x5150a7f4, 0x7e536541, 0x1ac3a417, 0x3a965e27, 0x3bcb6bab, 0x1ff1459d, 0xacab58fa, 0x4b9303e3, 0x2055fa30, 0xadf66d76, 0x889176cc, 0xf5254c02, 0x4ffcd7e5, 0xc5d7cb2a, 0x26804435, 0xb58fa362, 0xde495ab1, 0x25671bba, 0x45980eea, 0x5de1c0fe, 0xc302752f, 0x8112f04c, 0x8da39746, 0x6bc6f9d3, 0x3e75f8f, 0x15959c92, 0xbfeb7a6d, 0x95da5952, 0xd42d83be, 0x58d32174, 0x492969e0, 0x8e44c8c9, 0x756a89c2, 0xf478798e, 0x996b3e58, 0x27dd71b9, 0xbeb64fe1, 0xf017ad88, 0xc966ac20, 0x7db43ace, 0x63184adf, 0xe582311a, 0x97603351, 0x62457f53, 0xb1e07764, 0xbb84ae6b, 0xfe1ca081, 0xf9942b08, 0x70586848, 0x8f19fd45, 0x94876cde, 0x52b7f87b, 0xab23d373, 0x72e2024b, 0xe3578f1f, 0x662aab55, 0xb20728eb, 0x2f03c2b5, 0x869a7bc5, 0xd3a50837, 0x30f28728, 0x23b2a5bf, 0x2ba6a03, 0xed5c8216, 0x8a2b1ccf, 0xa792b479, 0xf3f0f207, 0x4ea1e269, 0x65cdf4da, 0x6d5be05, 0xd11f6234, 0xc48afea6, 0x349d532e, 0xa2a055f3, 0x532e18a, 0xa475ebf6, 0xb39ec83, 0x40aaef60, 0x5e069f71, 0xbd51106e, 0x3ef98a21, 0x963d06dd, 0xddae053e, 0x4d46bde6, 0x91b58d54, 0x71055dc4, 0x46fd406, 0x60ff1550, 0x1924fb98, 0xd697e9bd, 0x89cc4340, 0x67779ed9, 0xb0bd42e8, 0x7888b89, 0xe7385b19, 0x79dbeec8, 0xa1470a7c, 0x7ce90f42, 0xf8c91e84, 0x0, 0x9838680, 0x3248ed2b, 0x1eac7011, 0x6c4e725a, 0xfdfbff0e, 0xf563885, 0x3d1ed5ae, 0x3627392d, 0xa64d90f, 0x6821a65c, 0x9bd1545b, 0x243a2e36, 0xcb1670a, 0x930fe757, 0xb4d296ee, 0x1b9e919b, 0x804fc5c0, 0x61a220dc, 0x5a694b77, 0x1c161a12, 0xe20aba93, 0xc0e52aa0, 0x3c43e022, 0x121d171b, 0xe0b0d09, 0xf2adc78b, 0x2db9a8b6, 0x14c8a91e, 0x578519f1, 0xaf4c0775, 0xeebbdd99, 0xa3fd607f, 0xf79f2601, 0x5cbcf572, 0x44c53b66, 0x5b347efb, 0x8b762943, 0xcbdcc623, 0xb668fced, 0xb863f1e4, 0xd7cadc31, 0x42108563, 0x13402297, 0x842011c6, 0x857d244a, 0xd2f83dbb, 0xae1132f9, 0xc76da129, 0x1d4b2f9e, 0xdcf330b2, 0xdec5286, 0x77d0e3c1, 0x2b6c16b3, 0xa999b970, 0x11fa4894, 0x472264e9, 0xa8c48cfc, 0xa01a3ff0, 0x56d82c7d, 0x22ef9033, 0x87c74e49, 0xd9c1d138, 0x8cfea2ca, 0x98360bd4, 0xa6cf81f5, 0xa528de7a, 0xda268eb7, 0x3fa4bfad, 0x2ce49d3a, 0x500d9278, 0x6a9bcc5f, 0x5462467e, 0xf6c2138d, 0x90e8b8d8, 0x2e5ef739, 0x82f5afc3, 0x9fbe805d, 0x697c93d0, 0x6fa92dd5, 0xcfb31225, 0xc83b99ac, 0x10a77d18, 0xe86e639c, 0xdb7bbb3b, 0xcd097826, 0x6ef41859, 0xec01b79a, 0x83a89a4f, 0xe6656e95, 0xaa7ee6ff, 0x2108cfbc, 0xefe6e815, 0xbad99be7, 0x4ace366f, 0xead4099f, 0x29d67cb0, 0x31afb2a4, 0x2a31233f, 0xc63094a5, 0x35c066a2, 0x7437bc4e, 0xfca6ca82, 0xe0b0d090, 0x3315d8a7, 0xf14a9804, 0x41f7daec, 0x7f0e50cd, 0x172ff691, 0x768dd64d, 0x434db0ef, 0xcc544daa, 0xe4df0496, 0x9ee3b5d1, 0x4c1b886a, 0xc1b81f2c, 0x467f5165, 0x9d04ea5e, 0x15d358c, 0xfa737487, 0xfb2e410b, 0xb35a1d67, 0x9252d2db, 0xe9335610, 0x6d1347d6, 0x9a8c61d7, 0x377a0ca1, 0x598e14f8, 0xeb893c13, 0xceee27a9, 0xb735c961, 0xe1ede51c, 0x7a3cb147, 0x9c59dfd2, 0x553f73f2, 0x1879ce14, 0x73bf37c7, 0x53eacdf7, 0x5f5baafd, 0xdf146f3d, 0x7886db44, 0xca81f3af, 0xb93ec468, 0x382c3424, 0xc25f40a3, 0x1672c31d, 0xbc0c25e2, 0x288b493c, 0xff41950d, 0x397101a8, 0x8deb30c, 0xd89ce4b4, 0x6490c156, 0x7b6184cb, 0xd570b632, 0x48745c6c, 0xd04257b8&#125;;DWORD dword_405020[256] = &#123;0x50a7f451, 0x5365417e, 0xc3a4171a, 0x965e273a, 0xcb6bab3b, 0xf1459d1f, 0xab58faac, 0x9303e34b, 0x55fa3020, 0xf66d76ad, 0x9176cc88, 0x254c02f5, 0xfcd7e54f, 0xd7cb2ac5, 0x80443526, 0x8fa362b5, 0x495ab1de, 0x671bba25, 0x980eea45, 0xe1c0fe5d, 0x2752fc3, 0x12f04c81, 0xa397468d, 0xc6f9d36b, 0xe75f8f03, 0x959c9215, 0xeb7a6dbf, 0xda595295, 0x2d83bed4, 0xd3217458, 0x2969e049, 0x44c8c98e, 0x6a89c275, 0x78798ef4, 0x6b3e5899, 0xdd71b927, 0xb64fe1be, 0x17ad88f0, 0x66ac20c9, 0xb43ace7d, 0x184adf63, 0x82311ae5, 0x60335197, 0x457f5362, 0xe07764b1, 0x84ae6bbb, 0x1ca081fe, 0x942b08f9, 0x58684870, 0x19fd458f, 0x876cde94, 0xb7f87b52, 0x23d373ab, 0xe2024b72, 0x578f1fe3, 0x2aab5566, 0x728ebb2, 0x3c2b52f, 0x9a7bc586, 0xa50837d3, 0xf2872830, 0xb2a5bf23, 0xba6a0302, 0x5c8216ed, 0x2b1ccf8a, 0x92b479a7, 0xf0f207f3, 0xa1e2694e, 0xcdf4da65, 0xd5be0506, 0x1f6234d1, 0x8afea6c4, 0x9d532e34, 0xa055f3a2, 0x32e18a05, 0x75ebf6a4, 0x39ec830b, 0xaaef6040, 0x69f715e, 0x51106ebd, 0xf98a213e, 0x3d06dd96, 0xae053edd, 0x46bde64d, 0xb58d5491, 0x55dc471, 0x6fd40604, 0xff155060, 0x24fb9819, 0x97e9bdd6, 0xcc434089, 0x779ed967, 0xbd42e8b0, 0x888b8907, 0x385b19e7, 0xdbeec879, 0x470a7ca1, 0xe90f427c, 0xc91e84f8, 0x0, 0x83868009, 0x48ed2b32, 0xac70111e, 0x4e725a6c, 0xfbff0efd, 0x5638850f, 0x1ed5ae3d, 0x27392d36, 0x64d90f0a, 0x21a65c68, 0xd1545b9b, 0x3a2e3624, 0xb1670a0c, 0xfe75793, 0xd296eeb4, 0x9e919b1b, 0x4fc5c080, 0xa220dc61, 0x694b775a, 0x161a121c, 0xaba93e2, 0xe52aa0c0, 0x43e0223c, 0x1d171b12, 0xb0d090e, 0xadc78bf2, 0xb9a8b62d, 0xc8a91e14, 0x8519f157, 0x4c0775af, 0xbbdd99ee, 0xfd607fa3, 0x9f2601f7, 0xbcf5725c, 0xc53b6644, 0x347efb5b, 0x7629438b, 0xdcc623cb, 0x68fcedb6, 0x63f1e4b8, 0xcadc31d7, 0x10856342, 0x40229713, 0x2011c684, 0x7d244a85, 0xf83dbbd2, 0x1132f9ae, 0x6da129c7, 0x4b2f9e1d, 0xf330b2dc, 0xec52860d, 0xd0e3c177, 0x6c16b32b, 0x99b970a9, 0xfa489411, 0x2264e947, 0xc48cfca8, 0x1a3ff0a0, 0xd82c7d56, 0xef903322, 0xc74e4987, 0xc1d138d9, 0xfea2ca8c, 0x360bd498, 0xcf81f5a6, 0x28de7aa5, 0x268eb7da, 0xa4bfad3f, 0xe49d3a2c, 0xd927850, 0x9bcc5f6a, 0x62467e54, 0xc2138df6, 0xe8b8d890, 0x5ef7392e, 0xf5afc382, 0xbe805d9f, 0x7c93d069, 0xa92dd56f, 0xb31225cf, 0x3b99acc8, 0xa77d1810, 0x6e639ce8, 0x7bbb3bdb, 0x97826cd, 0xf418596e, 0x1b79aec, 0xa89a4f83, 0x656e95e6, 0x7ee6ffaa, 0x8cfbc21, 0xe6e815ef, 0xd99be7ba, 0xce366f4a, 0xd4099fea, 0xd67cb029, 0xafb2a431, 0x31233f2a, 0x3094a5c6, 0xc066a235, 0x37bc4e74, 0xa6ca82fc, 0xb0d090e0, 0x15d8a733, 0x4a9804f1, 0xf7daec41, 0xe50cd7f, 0x2ff69117, 0x8dd64d76, 0x4db0ef43, 0x544daacc, 0xdf0496e4, 0xe3b5d19e, 0x1b886a4c, 0xb81f2cc1, 0x7f516546, 0x4ea5e9d, 0x5d358c01, 0x737487fa, 0x2e410bfb, 0x5a1d67b3, 0x52d2db92, 0x335610e9, 0x1347d66d, 0x8c61d79a, 0x7a0ca137, 0x8e14f859, 0x893c13eb, 0xee27a9ce, 0x35c961b7, 0xede51ce1, 0x3cb1477a, 0x59dfd29c, 0x3f73f255, 0x79ce1418, 0xbf37c773, 0xeacdf753, 0x5baafd5f, 0x146f3ddf, 0x86db4478, 0x81f3afca, 0x3ec468b9, 0x2c342438, 0x5f40a3c2, 0x72c31d16, 0xc25e2bc, 0x8b493c28, 0x41950dff, 0x7101a839, 0xdeb30c08, 0x9ce4b4d8, 0x90c15664, 0x6184cb7b, 0x70b632d5, 0x745c6c48, 0x4257b8d0&#125;;BYTE RijnDael_AES_LONG_inv_406120[256] = &#123;0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7, 0xFB, 0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43, 0x44, 0xC4, 0xDE, 0xE9, 0xCB, 0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E, 0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1, 0x25, 0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C, 0xCC, 0x5D, 0x65, 0xB6, 0x92, 0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84, 0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45, 0x06, 0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD, 0x03, 0x01, 0x13, 0x8A, 0x6B, 0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73, 0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF, 0x6E, 0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B, 0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4, 0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC, 0x5F, 0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A, 0x9F, 0x93, 0xC9, 0x9C, 0xEF, 0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C, 0x7D&#125;;BYTE BYTE1(DWORD _data)&#123; return (_data &gt;&gt; 8) &amp; 0XFF;&#125;BYTE BYTE2(DWORD _data)&#123; return (_data &gt;&gt; 16) &amp; 0XFF;&#125;BYTE HIBYTE(DWORD _data)&#123; return (_data &gt;&gt; 24) &amp; 0XFF;&#125;BYTE BYTE0(DWORD _data)&#123; return _data &amp; 0XFF;&#125;DWORD _enc_flag[4] = &#123;0&#125;;int main()&#123; DWORD *flag = (DWORD *)_flag; int key_index = 0; DWORD v9 = 0, v8 = 0, v7 = 0, i = 0; DWORD v11 = 0, v13 = 0, v15 = 0, v17 = 0; DWORD v12 = 0, v14 = 0, v16 = 0, v18 = 0; v9 = flag[3] ^ key[key_index]; key_index += 1; v8 = flag[2] ^ key[key_index]; key_index += 1; v7 = flag[1] ^ key[key_index]; key_index += 1; i = flag[0] ^ key[key_index]; key_index += 1; for (int j = 0; j &lt; 13; j++) &#123; v11 = dword_405420[BYTE1(v9)] ^ dword_405820[BYTE2(v8)] ^ dword_405C20[HIBYTE(v7)] ^ dword_405020[BYTE0(i)]; v13 = dword_405420[BYTE1(i)] ^ dword_405820[BYTE2(v9)] ^ dword_405C20[HIBYTE(v8)] ^ dword_405020[BYTE0(v7)]; v15 = dword_405420[BYTE1(v7)] ^ dword_405820[BYTE2(i)] ^ dword_405C20[HIBYTE(v9)] ^ dword_405020[BYTE0(v8)]; v17 = dword_405420[BYTE1(v8)] ^ dword_405820[BYTE2(v7)] ^ dword_405C20[HIBYTE(i)] ^ dword_405020[BYTE0(v9)]; //æœ€åä¸€è½®æ—¶ V11, V13, V15, V17çš„å€¼åº”è¯¥å¦‚ä¸‹ // v11 = 0xf048c314; // v13 = 0xb4db6016; // v15 = 0x8eee5336; // v17 = 0x948726e2; v9 = v17 ^ key[key_index]; key_index += 1; v8 = v15 ^ key[key_index]; key_index += 1; v7 = v13 ^ key[key_index]; key_index += 1; i = v11 ^ key[key_index]; key_index += 1; &#125; //è¿è¡Œåˆ°è¿™é‡Œï¼Œv9, v8, v7, içš„æ•°æ®åº”è¯¥å¦‚ä¸‹ // v9 = 0x948726e2; // v8 = 0x51f188a1; // v7 = 0x9b05b51d; // i = 0xb9f8810c; v12 = (RijnDael_AES_LONG_inv_406120[BYTE1(v9)] &lt;&lt; 8) | (RijnDael_AES_LONG_inv_406120[BYTE2(v8)] &lt;&lt; 16) | (RijnDael_AES_LONG_inv_406120[HIBYTE(v7)] &lt;&lt; 24) | RijnDael_AES_LONG_inv_406120[BYTE0(i)]; v14 = (RijnDael_AES_LONG_inv_406120[BYTE1(i)] &lt;&lt; 8) | (RijnDael_AES_LONG_inv_406120[BYTE2(v9)] &lt;&lt; 16) | (RijnDael_AES_LONG_inv_406120[HIBYTE(v8)] &lt;&lt; 24) | RijnDael_AES_LONG_inv_406120[BYTE0(v7)]; v16 = (RijnDael_AES_LONG_inv_406120[BYTE1(v7)] &lt;&lt; 8) | (RijnDael_AES_LONG_inv_406120[BYTE2(i)] &lt;&lt; 16) | (RijnDael_AES_LONG_inv_406120[HIBYTE(v9)] &lt;&lt; 24) | RijnDael_AES_LONG_inv_406120[BYTE0(v8)]; v18 = (RijnDael_AES_LONG_inv_406120[BYTE1(v8)] &lt;&lt; 8) | (RijnDael_AES_LONG_inv_406120[BYTE2(v7)] &lt;&lt; 16) | (RijnDael_AES_LONG_inv_406120[HIBYTE(i)] &lt;&lt; 24) | RijnDael_AES_LONG_inv_406120[BYTE0(v9)]; //è¿è¡Œåˆ°è¿™é‡Œï¼Œv12, v14, v16, v18çš„æ•°æ®åº”è¯¥å¦‚ä¸‹ // 0xe82b2381 v12 // 0x70ea91de v14 // 0xe7e1d2f1 v16 // 0xdb36973b v18 _enc_flag[3] = v18 ^ key[key_index]; key_index += 1; _enc_flag[2] = v16 ^ key[key_index]; key_index += 1; _enc_flag[1] = v14 ^ key[key_index]; key_index += 1; _enc_flag[0] = v12 ^ key[key_index]; for (int i = 0; i &lt; 4; i++) &#123; printf(&quot;%#X, &quot;, _enc_flag[i]); &#125; return 0;&#125; å†™è§£å¯†è„šæœ¬ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207#include &lt;stdio.h&gt;#include &lt;windows.h&gt;size_t count = 0;DWORD key[60] = &#123; 0xc3bb95b, 0x578c9d63, 0x7faca21c, 0x29522e93, 0xb268681, 0xda705e01, 0xa7732a53, 0x72e0c013, 0x4b4fcf3b, 0xe46963a6, 0x3eeea9d2, 0xefb38fbb, 0xd156d880, 0x7d037452, 0xd593ea40, 0xd5223126, 0xaf26ac9d, 0xda87ca74, 0xd15d2669, 0x6cadaad, 0xac55acd2, 0xa8909e12, 0xb1db66, 0xcc4c1870, 0x75a166e9, 0xbdaec1d, 0xd797fcc4, 0x9cd3659b, 0x4c532c0, 0xa8214574, 0xccfdc316, 0x6019b4a2, 0x7e7b8af4, 0xdc4d10d9, 0x4b44995f, 0x2ca5c858, 0xace477b4, 0x64dc8662, 0xace477b4, 0xbbc35df5, 0xa2369a2d, 0x97098986, 0x67e15107, 0xfd0b6e21, 0xc838f1d6, 0xc838f1d6, 0x17272a41, 0x38f9ff4a, 0x353f13ab, 0xf0e8d881, 0x9aea3f26, 0x5f3df40c, 0x0, 0xdf1fdb97, 0x2fded50b, 0x49b04218, 0xf3000000, 0xc3fa1e0f, 0xf3000000, 0x841f &#125;;DWORD dword_405420[256] = &#123; 0xa7f45150, 0x65417e53, 0xa4171ac3, 0x5e273a96, 0x6bab3bcb, 0x459d1ff1, 0x58faacab, 0x3e34b93, 0xfa302055, 0x6d76adf6, 0x76cc8891, 0x4c02f525, 0xd7e54ffc, 0xcb2ac5d7, 0x44352680, 0xa362b58f, 0x5ab1de49, 0x1bba2567, 0xeea4598, 0xc0fe5de1, 0x752fc302, 0xf04c8112, 0x97468da3, 0xf9d36bc6, 0x5f8f03e7, 0x9c921595, 0x7a6dbfeb, 0x595295da, 0x83bed42d, 0x217458d3, 0x69e04929, 0xc8c98e44, 0x89c2756a, 0x798ef478, 0x3e58996b, 0x71b927dd, 0x4fe1beb6, 0xad88f017, 0xac20c966, 0x3ace7db4, 0x4adf6318, 0x311ae582, 0x33519760, 0x7f536245, 0x7764b1e0, 0xae6bbb84, 0xa081fe1c, 0x2b08f994, 0x68487058, 0xfd458f19, 0x6cde9487, 0xf87b52b7, 0xd373ab23, 0x24b72e2, 0x8f1fe357, 0xab55662a, 0x28ebb207, 0xc2b52f03, 0x7bc5869a, 0x837d3a5, 0x872830f2, 0xa5bf23b2, 0x6a0302ba, 0x8216ed5c, 0x1ccf8a2b, 0xb479a792, 0xf207f3f0, 0xe2694ea1, 0xf4da65cd, 0xbe0506d5, 0x6234d11f, 0xfea6c48a, 0x532e349d, 0x55f3a2a0, 0xe18a0532, 0xebf6a475, 0xec830b39, 0xef6040aa, 0x9f715e06, 0x106ebd51, 0x8a213ef9, 0x6dd963d, 0x53eddae, 0xbde64d46, 0x8d5491b5, 0x5dc47105, 0xd406046f, 0x155060ff, 0xfb981924, 0xe9bdd697, 0x434089cc, 0x9ed96777, 0x42e8b0bd, 0x8b890788, 0x5b19e738, 0xeec879db, 0xa7ca147, 0xf427ce9, 0x1e84f8c9, 0x0, 0x86800983, 0xed2b3248, 0x70111eac, 0x725a6c4e, 0xff0efdfb, 0x38850f56, 0xd5ae3d1e, 0x392d3627, 0xd90f0a64, 0xa65c6821, 0x545b9bd1, 0x2e36243a, 0x670a0cb1, 0xe757930f, 0x96eeb4d2, 0x919b1b9e, 0xc5c0804f, 0x20dc61a2, 0x4b775a69, 0x1a121c16, 0xba93e20a, 0x2aa0c0e5, 0xe0223c43, 0x171b121d, 0xd090e0b, 0xc78bf2ad, 0xa8b62db9, 0xa91e14c8, 0x19f15785, 0x775af4c, 0xdd99eebb, 0x607fa3fd, 0x2601f79f, 0xf5725cbc, 0x3b6644c5, 0x7efb5b34, 0x29438b76, 0xc623cbdc, 0xfcedb668, 0xf1e4b863, 0xdc31d7ca, 0x85634210, 0x22971340, 0x11c68420, 0x244a857d, 0x3dbbd2f8, 0x32f9ae11, 0xa129c76d, 0x2f9e1d4b, 0x30b2dcf3, 0x52860dec, 0xe3c177d0, 0x16b32b6c, 0xb970a999, 0x489411fa, 0x64e94722, 0x8cfca8c4, 0x3ff0a01a, 0x2c7d56d8, 0x903322ef, 0x4e4987c7, 0xd138d9c1, 0xa2ca8cfe, 0xbd49836, 0x81f5a6cf, 0xde7aa528, 0x8eb7da26, 0xbfad3fa4, 0x9d3a2ce4, 0x9278500d, 0xcc5f6a9b, 0x467e5462, 0x138df6c2, 0xb8d890e8, 0xf7392e5e, 0xafc382f5, 0x805d9fbe, 0x93d0697c, 0x2dd56fa9, 0x1225cfb3, 0x99acc83b, 0x7d1810a7, 0x639ce86e, 0xbb3bdb7b, 0x7826cd09, 0x18596ef4, 0xb79aec01, 0x9a4f83a8, 0x6e95e665, 0xe6ffaa7e, 0xcfbc2108, 0xe815efe6, 0x9be7bad9, 0x366f4ace, 0x99fead4, 0x7cb029d6, 0xb2a431af, 0x233f2a31, 0x94a5c630, 0x66a235c0, 0xbc4e7437, 0xca82fca6, 0xd090e0b0, 0xd8a73315, 0x9804f14a, 0xdaec41f7, 0x50cd7f0e, 0xf691172f, 0xd64d768d, 0xb0ef434d, 0x4daacc54, 0x496e4df, 0xb5d19ee3, 0x886a4c1b, 0x1f2cc1b8, 0x5165467f, 0xea5e9d04, 0x358c015d, 0x7487fa73, 0x410bfb2e, 0x1d67b35a, 0xd2db9252, 0x5610e933, 0x47d66d13, 0x61d79a8c, 0xca1377a, 0x14f8598e, 0x3c13eb89, 0x27a9ceee, 0xc961b735, 0xe51ce1ed, 0xb1477a3c, 0xdfd29c59, 0x73f2553f, 0xce141879, 0x37c773bf, 0xcdf753ea, 0xaafd5f5b, 0x6f3ddf14, 0xdb447886, 0xf3afca81, 0xc468b93e, 0x3424382c, 0x40a3c25f, 0xc31d1672, 0x25e2bc0c, 0x493c288b, 0x950dff41, 0x1a83971, 0xb30c08de, 0xe4b4d89c, 0xc1566490, 0x84cb7b61, 0xb632d570, 0x5c6c4874, 0x57b8d042 &#125;;DWORD dword_405820[256] = &#123; 0xf45150a7, 0x417e5365, 0x171ac3a4, 0x273a965e, 0xab3bcb6b, 0x9d1ff145, 0xfaacab58, 0xe34b9303, 0x302055fa, 0x76adf66d, 0xcc889176, 0x2f5254c, 0xe54ffcd7, 0x2ac5d7cb, 0x35268044, 0x62b58fa3, 0xb1de495a, 0xba25671b, 0xea45980e, 0xfe5de1c0, 0x2fc30275, 0x4c8112f0, 0x468da397, 0xd36bc6f9, 0x8f03e75f, 0x9215959c, 0x6dbfeb7a, 0x5295da59, 0xbed42d83, 0x7458d321, 0xe0492969, 0xc98e44c8, 0xc2756a89, 0x8ef47879, 0x58996b3e, 0xb927dd71, 0xe1beb64f, 0x88f017ad, 0x20c966ac, 0xce7db43a, 0xdf63184a, 0x1ae58231, 0x51976033, 0x5362457f, 0x64b1e077, 0x6bbb84ae, 0x81fe1ca0, 0x8f9942b, 0x48705868, 0x458f19fd, 0xde94876c, 0x7b52b7f8, 0x73ab23d3, 0x4b72e202, 0x1fe3578f, 0x55662aab, 0xebb20728, 0xb52f03c2, 0xc5869a7b, 0x37d3a508, 0x2830f287, 0xbf23b2a5, 0x302ba6a, 0x16ed5c82, 0xcf8a2b1c, 0x79a792b4, 0x7f3f0f2, 0x694ea1e2, 0xda65cdf4, 0x506d5be, 0x34d11f62, 0xa6c48afe, 0x2e349d53, 0xf3a2a055, 0x8a0532e1, 0xf6a475eb, 0x830b39ec, 0x6040aaef, 0x715e069f, 0x6ebd5110, 0x213ef98a, 0xdd963d06, 0x3eddae05, 0xe64d46bd, 0x5491b58d, 0xc471055d, 0x6046fd4, 0x5060ff15, 0x981924fb, 0xbdd697e9, 0x4089cc43, 0xd967779e, 0xe8b0bd42, 0x8907888b, 0x19e7385b, 0xc879dbee, 0x7ca1470a, 0x427ce90f, 0x84f8c91e, 0x0, 0x80098386, 0x2b3248ed, 0x111eac70, 0x5a6c4e72, 0xefdfbff, 0x850f5638, 0xae3d1ed5, 0x2d362739, 0xf0a64d9, 0x5c6821a6, 0x5b9bd154, 0x36243a2e, 0xa0cb167, 0x57930fe7, 0xeeb4d296, 0x9b1b9e91, 0xc0804fc5, 0xdc61a220, 0x775a694b, 0x121c161a, 0x93e20aba, 0xa0c0e52a, 0x223c43e0, 0x1b121d17, 0x90e0b0d, 0x8bf2adc7, 0xb62db9a8, 0x1e14c8a9, 0xf1578519, 0x75af4c07, 0x99eebbdd, 0x7fa3fd60, 0x1f79f26, 0x725cbcf5, 0x6644c53b, 0xfb5b347e, 0x438b7629, 0x23cbdcc6, 0xedb668fc, 0xe4b863f1, 0x31d7cadc, 0x63421085, 0x97134022, 0xc6842011, 0x4a857d24, 0xbbd2f83d, 0xf9ae1132, 0x29c76da1, 0x9e1d4b2f, 0xb2dcf330, 0x860dec52, 0xc177d0e3, 0xb32b6c16, 0x70a999b9, 0x9411fa48, 0xe9472264, 0xfca8c48c, 0xf0a01a3f, 0x7d56d82c, 0x3322ef90, 0x4987c74e, 0x38d9c1d1, 0xca8cfea2, 0xd498360b, 0xf5a6cf81, 0x7aa528de, 0xb7da268e, 0xad3fa4bf, 0x3a2ce49d, 0x78500d92, 0x5f6a9bcc, 0x7e546246, 0x8df6c213, 0xd890e8b8, 0x392e5ef7, 0xc382f5af, 0x5d9fbe80, 0xd0697c93, 0xd56fa92d, 0x25cfb312, 0xacc83b99, 0x1810a77d, 0x9ce86e63, 0x3bdb7bbb, 0x26cd0978, 0x596ef418, 0x9aec01b7, 0x4f83a89a, 0x95e6656e, 0xffaa7ee6, 0xbc2108cf, 0x15efe6e8, 0xe7bad99b, 0x6f4ace36, 0x9fead409, 0xb029d67c, 0xa431afb2, 0x3f2a3123, 0xa5c63094, 0xa235c066, 0x4e7437bc, 0x82fca6ca, 0x90e0b0d0, 0xa73315d8, 0x4f14a98, 0xec41f7da, 0xcd7f0e50, 0x91172ff6, 0x4d768dd6, 0xef434db0, 0xaacc544d, 0x96e4df04, 0xd19ee3b5, 0x6a4c1b88, 0x2cc1b81f, 0x65467f51, 0x5e9d04ea, 0x8c015d35, 0x87fa7374, 0xbfb2e41, 0x67b35a1d, 0xdb9252d2, 0x10e93356, 0xd66d1347, 0xd79a8c61, 0xa1377a0c, 0xf8598e14, 0x13eb893c, 0xa9ceee27, 0x61b735c9, 0x1ce1ede5, 0x477a3cb1, 0xd29c59df, 0xf2553f73, 0x141879ce, 0xc773bf37, 0xf753eacd, 0xfd5f5baa, 0x3ddf146f, 0x447886db, 0xafca81f3, 0x68b93ec4, 0x24382c34, 0xa3c25f40, 0x1d1672c3, 0xe2bc0c25, 0x3c288b49, 0xdff4195, 0xa8397101, 0xc08deb3, 0xb4d89ce4, 0x566490c1, 0xcb7b6184, 0x32d570b6, 0x6c48745c, 0xb8d04257 &#125;;DWORD dword_405C20[256] = &#123; 0x5150a7f4, 0x7e536541, 0x1ac3a417, 0x3a965e27, 0x3bcb6bab, 0x1ff1459d, 0xacab58fa, 0x4b9303e3, 0x2055fa30, 0xadf66d76, 0x889176cc, 0xf5254c02, 0x4ffcd7e5, 0xc5d7cb2a, 0x26804435, 0xb58fa362, 0xde495ab1, 0x25671bba, 0x45980eea, 0x5de1c0fe, 0xc302752f, 0x8112f04c, 0x8da39746, 0x6bc6f9d3, 0x3e75f8f, 0x15959c92, 0xbfeb7a6d, 0x95da5952, 0xd42d83be, 0x58d32174, 0x492969e0, 0x8e44c8c9, 0x756a89c2, 0xf478798e, 0x996b3e58, 0x27dd71b9, 0xbeb64fe1, 0xf017ad88, 0xc966ac20, 0x7db43ace, 0x63184adf, 0xe582311a, 0x97603351, 0x62457f53, 0xb1e07764, 0xbb84ae6b, 0xfe1ca081, 0xf9942b08, 0x70586848, 0x8f19fd45, 0x94876cde, 0x52b7f87b, 0xab23d373, 0x72e2024b, 0xe3578f1f, 0x662aab55, 0xb20728eb, 0x2f03c2b5, 0x869a7bc5, 0xd3a50837, 0x30f28728, 0x23b2a5bf, 0x2ba6a03, 0xed5c8216, 0x8a2b1ccf, 0xa792b479, 0xf3f0f207, 0x4ea1e269, 0x65cdf4da, 0x6d5be05, 0xd11f6234, 0xc48afea6, 0x349d532e, 0xa2a055f3, 0x532e18a, 0xa475ebf6, 0xb39ec83, 0x40aaef60, 0x5e069f71, 0xbd51106e, 0x3ef98a21, 0x963d06dd, 0xddae053e, 0x4d46bde6, 0x91b58d54, 0x71055dc4, 0x46fd406, 0x60ff1550, 0x1924fb98, 0xd697e9bd, 0x89cc4340, 0x67779ed9, 0xb0bd42e8, 0x7888b89, 0xe7385b19, 0x79dbeec8, 0xa1470a7c, 0x7ce90f42, 0xf8c91e84, 0x0, 0x9838680, 0x3248ed2b, 0x1eac7011, 0x6c4e725a, 0xfdfbff0e, 0xf563885, 0x3d1ed5ae, 0x3627392d, 0xa64d90f, 0x6821a65c, 0x9bd1545b, 0x243a2e36, 0xcb1670a, 0x930fe757, 0xb4d296ee, 0x1b9e919b, 0x804fc5c0, 0x61a220dc, 0x5a694b77, 0x1c161a12, 0xe20aba93, 0xc0e52aa0, 0x3c43e022, 0x121d171b, 0xe0b0d09, 0xf2adc78b, 0x2db9a8b6, 0x14c8a91e, 0x578519f1, 0xaf4c0775, 0xeebbdd99, 0xa3fd607f, 0xf79f2601, 0x5cbcf572, 0x44c53b66, 0x5b347efb, 0x8b762943, 0xcbdcc623, 0xb668fced, 0xb863f1e4, 0xd7cadc31, 0x42108563, 0x13402297, 0x842011c6, 0x857d244a, 0xd2f83dbb, 0xae1132f9, 0xc76da129, 0x1d4b2f9e, 0xdcf330b2, 0xdec5286, 0x77d0e3c1, 0x2b6c16b3, 0xa999b970, 0x11fa4894, 0x472264e9, 0xa8c48cfc, 0xa01a3ff0, 0x56d82c7d, 0x22ef9033, 0x87c74e49, 0xd9c1d138, 0x8cfea2ca, 0x98360bd4, 0xa6cf81f5, 0xa528de7a, 0xda268eb7, 0x3fa4bfad, 0x2ce49d3a, 0x500d9278, 0x6a9bcc5f, 0x5462467e, 0xf6c2138d, 0x90e8b8d8, 0x2e5ef739, 0x82f5afc3, 0x9fbe805d, 0x697c93d0, 0x6fa92dd5, 0xcfb31225, 0xc83b99ac, 0x10a77d18, 0xe86e639c, 0xdb7bbb3b, 0xcd097826, 0x6ef41859, 0xec01b79a, 0x83a89a4f, 0xe6656e95, 0xaa7ee6ff, 0x2108cfbc, 0xefe6e815, 0xbad99be7, 0x4ace366f, 0xead4099f, 0x29d67cb0, 0x31afb2a4, 0x2a31233f, 0xc63094a5, 0x35c066a2, 0x7437bc4e, 0xfca6ca82, 0xe0b0d090, 0x3315d8a7, 0xf14a9804, 0x41f7daec, 0x7f0e50cd, 0x172ff691, 0x768dd64d, 0x434db0ef, 0xcc544daa, 0xe4df0496, 0x9ee3b5d1, 0x4c1b886a, 0xc1b81f2c, 0x467f5165, 0x9d04ea5e, 0x15d358c, 0xfa737487, 0xfb2e410b, 0xb35a1d67, 0x9252d2db, 0xe9335610, 0x6d1347d6, 0x9a8c61d7, 0x377a0ca1, 0x598e14f8, 0xeb893c13, 0xceee27a9, 0xb735c961, 0xe1ede51c, 0x7a3cb147, 0x9c59dfd2, 0x553f73f2, 0x1879ce14, 0x73bf37c7, 0x53eacdf7, 0x5f5baafd, 0xdf146f3d, 0x7886db44, 0xca81f3af, 0xb93ec468, 0x382c3424, 0xc25f40a3, 0x1672c31d, 0xbc0c25e2, 0x288b493c, 0xff41950d, 0x397101a8, 0x8deb30c, 0xd89ce4b4, 0x6490c156, 0x7b6184cb, 0xd570b632, 0x48745c6c, 0xd04257b8 &#125;;DWORD dword_405020[256] = &#123; 0x50a7f451, 0x5365417e, 0xc3a4171a, 0x965e273a, 0xcb6bab3b, 0xf1459d1f, 0xab58faac, 0x9303e34b, 0x55fa3020, 0xf66d76ad, 0x9176cc88, 0x254c02f5, 0xfcd7e54f, 0xd7cb2ac5, 0x80443526, 0x8fa362b5, 0x495ab1de, 0x671bba25, 0x980eea45, 0xe1c0fe5d, 0x2752fc3, 0x12f04c81, 0xa397468d, 0xc6f9d36b, 0xe75f8f03, 0x959c9215, 0xeb7a6dbf, 0xda595295, 0x2d83bed4, 0xd3217458, 0x2969e049, 0x44c8c98e, 0x6a89c275, 0x78798ef4, 0x6b3e5899, 0xdd71b927, 0xb64fe1be, 0x17ad88f0, 0x66ac20c9, 0xb43ace7d, 0x184adf63, 0x82311ae5, 0x60335197, 0x457f5362, 0xe07764b1, 0x84ae6bbb, 0x1ca081fe, 0x942b08f9, 0x58684870, 0x19fd458f, 0x876cde94, 0xb7f87b52, 0x23d373ab, 0xe2024b72, 0x578f1fe3, 0x2aab5566, 0x728ebb2, 0x3c2b52f, 0x9a7bc586, 0xa50837d3, 0xf2872830, 0xb2a5bf23, 0xba6a0302, 0x5c8216ed, 0x2b1ccf8a, 0x92b479a7, 0xf0f207f3, 0xa1e2694e, 0xcdf4da65, 0xd5be0506, 0x1f6234d1, 0x8afea6c4, 0x9d532e34, 0xa055f3a2, 0x32e18a05, 0x75ebf6a4, 0x39ec830b, 0xaaef6040, 0x69f715e, 0x51106ebd, 0xf98a213e, 0x3d06dd96, 0xae053edd, 0x46bde64d, 0xb58d5491, 0x55dc471, 0x6fd40604, 0xff155060, 0x24fb9819, 0x97e9bdd6, 0xcc434089, 0x779ed967, 0xbd42e8b0, 0x888b8907, 0x385b19e7, 0xdbeec879, 0x470a7ca1, 0xe90f427c, 0xc91e84f8, 0x0, 0x83868009, 0x48ed2b32, 0xac70111e, 0x4e725a6c, 0xfbff0efd, 0x5638850f, 0x1ed5ae3d, 0x27392d36, 0x64d90f0a, 0x21a65c68, 0xd1545b9b, 0x3a2e3624, 0xb1670a0c, 0xfe75793, 0xd296eeb4, 0x9e919b1b, 0x4fc5c080, 0xa220dc61, 0x694b775a, 0x161a121c, 0xaba93e2, 0xe52aa0c0, 0x43e0223c, 0x1d171b12, 0xb0d090e, 0xadc78bf2, 0xb9a8b62d, 0xc8a91e14, 0x8519f157, 0x4c0775af, 0xbbdd99ee, 0xfd607fa3, 0x9f2601f7, 0xbcf5725c, 0xc53b6644, 0x347efb5b, 0x7629438b, 0xdcc623cb, 0x68fcedb6, 0x63f1e4b8, 0xcadc31d7, 0x10856342, 0x40229713, 0x2011c684, 0x7d244a85, 0xf83dbbd2, 0x1132f9ae, 0x6da129c7, 0x4b2f9e1d, 0xf330b2dc, 0xec52860d, 0xd0e3c177, 0x6c16b32b, 0x99b970a9, 0xfa489411, 0x2264e947, 0xc48cfca8, 0x1a3ff0a0, 0xd82c7d56, 0xef903322, 0xc74e4987, 0xc1d138d9, 0xfea2ca8c, 0x360bd498, 0xcf81f5a6, 0x28de7aa5, 0x268eb7da, 0xa4bfad3f, 0xe49d3a2c, 0xd927850, 0x9bcc5f6a, 0x62467e54, 0xc2138df6, 0xe8b8d890, 0x5ef7392e, 0xf5afc382, 0xbe805d9f, 0x7c93d069, 0xa92dd56f, 0xb31225cf, 0x3b99acc8, 0xa77d1810, 0x6e639ce8, 0x7bbb3bdb, 0x97826cd, 0xf418596e, 0x1b79aec, 0xa89a4f83, 0x656e95e6, 0x7ee6ffaa, 0x8cfbc21, 0xe6e815ef, 0xd99be7ba, 0xce366f4a, 0xd4099fea, 0xd67cb029, 0xafb2a431, 0x31233f2a, 0x3094a5c6, 0xc066a235, 0x37bc4e74, 0xa6ca82fc, 0xb0d090e0, 0x15d8a733, 0x4a9804f1, 0xf7daec41, 0xe50cd7f, 0x2ff69117, 0x8dd64d76, 0x4db0ef43, 0x544daacc, 0xdf0496e4, 0xe3b5d19e, 0x1b886a4c, 0xb81f2cc1, 0x7f516546, 0x4ea5e9d, 0x5d358c01, 0x737487fa, 0x2e410bfb, 0x5a1d67b3, 0x52d2db92, 0x335610e9, 0x1347d66d, 0x8c61d79a, 0x7a0ca137, 0x8e14f859, 0x893c13eb, 0xee27a9ce, 0x35c961b7, 0xede51ce1, 0x3cb1477a, 0x59dfd29c, 0x3f73f255, 0x79ce1418, 0xbf37c773, 0xeacdf753, 0x5baafd5f, 0x146f3ddf, 0x86db4478, 0x81f3afca, 0x3ec468b9, 0x2c342438, 0x5f40a3c2, 0x72c31d16, 0xc25e2bc, 0x8b493c28, 0x41950dff, 0x7101a839, 0xdeb30c08, 0x9ce4b4d8, 0x90c15664, 0x6184cb7b, 0x70b632d5, 0x745c6c48, 0x4257b8d0 &#125;;BYTE RijnDael_AES_LONG_inv_406120[256] = &#123; 0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7, 0xFB, 0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43, 0x44, 0xC4, 0xDE, 0xE9, 0xCB, 0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E, 0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1, 0x25, 0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C, 0xCC, 0x5D, 0x65, 0xB6, 0x92, 0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84, 0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45, 0x06, 0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD, 0x03, 0x01, 0x13, 0x8A, 0x6B, 0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73, 0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF, 0x6E, 0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B, 0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4, 0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC, 0x5F, 0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A, 0x9F, 0x93, 0xC9, 0x9C, 0xEF, 0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C, 0x7D &#125;;BYTE BYTE1(DWORD _data)&#123; return (_data &gt;&gt; 8) &amp; 0XFF;&#125;BYTE BYTE2(DWORD _data)&#123; return (_data &gt;&gt; 16) &amp; 0XFF;&#125;BYTE BYTE3(DWORD _data)&#123; return (_data &gt;&gt; 24) &amp; 0XFF;&#125;BYTE BYTE0(DWORD _data)&#123; return _data &amp; 0XFF;&#125;// void brute(DWORD target /*, unsigned char *a1, unsigned char *a2, unsigned char *a3, unsigned char *a4*/)// &#123;// for (unsigned char i1 = 0; i1 &lt; 256; i1++)// &#123;// for (unsigned char i2 = 0; i2 &lt; 256; i2++)// &#123;// for (unsigned char i3 = 0; i3 &lt; 256; i3++)// &#123;// for (unsigned char i4 = 0; i4 &lt; 256; i4++)// &#123;// if ((dword_405020[i1] ^ dword_405420[i2] ^ dword_405820[i3] ^ dword_405C20[i4]) == target)// &#123;// printf(&quot;brute found for %#x: %d %d %d %d\\n&quot;, target, i1, i2, i3, i4);// // *a1 = i1;// // *a2 = i2;// // *a3 = i3;// // *a4 = i4;// return;// &#125;// &#125;// &#125;// &#125;// &#125;// &#125;void brute(DWORD target, unsigned char* a1, unsigned char* a2, unsigned char* a3, unsigned char* a4)&#123; for (size_t i1 = 0; i1 &lt; 256; i1++) &#123; for (size_t i2 = 0; i2 &lt; 256; i2++) &#123; for (size_t i3 = 0; i3 &lt; 256; i3++) &#123; for (size_t i4 = 0; i4 &lt; 256; i4++) &#123; if ((dword_405420[i1] ^ dword_405820[i2] ^ dword_405C20[i3] ^ dword_405020[i4]) == target) &#123; printf(&quot;%d - brute found for %x:%d %d %d %d\\n&quot;, count++, target, i1, i2, i3, i4); *a1 = i1; *a2 = i2; *a3 = i3; *a4 = i4; &#125; &#125; &#125; &#125; &#125;&#125;unsigned char findIndex1(BYTE data)&#123; BYTE* array = RijnDael_AES_LONG_inv_406120; for (unsigned char i = 0; i &lt; 256; i++) &#123; if (array[i] == data) return i; &#125; return -1;&#125;void decrypt(DWORD* miwen, DWORD* flag)&#123; int key_index = 59; DWORD v12, v14, v16, v18; DWORD v11, v13, v15, v17; unsigned char _v9[4] = &#123; 0 &#125;; unsigned char _v8[4] = &#123; 0 &#125;; unsigned char _v7[4] = &#123; 0 &#125;; unsigned char _i[4] = &#123; 0 &#125;; DWORD v9, v8, v7, i; v12 = miwen[0] ^ key[key_index--]; v14 = miwen[1] ^ key[key_index--]; v16 = miwen[2] ^ key[key_index--]; v18 = miwen[3] ^ key[key_index--]; // å¾—åˆ°v9, v8, v7, i; _i[0] = findIndex1(BYTE0(v12)); _v9[1] = findIndex1(BYTE1(v12)); _v8[2] = findIndex1(BYTE2(v12)); _v7[3] = findIndex1(BYTE3(v12)); _v7[0] = findIndex1(BYTE0(v14)); _i[1] = findIndex1(BYTE1(v14)); _v9[2] = findIndex1(BYTE2(v14)); _v8[3] = findIndex1(BYTE3(v14)); _v8[0] = findIndex1(BYTE0(v16)); _v7[1] = findIndex1(BYTE1(v16)); _i[2] = findIndex1(BYTE2(v16)); _v9[3] = findIndex1(BYTE3(v16)); _v9[0] = findIndex1(BYTE0(v18)); _v8[1] = findIndex1(BYTE1(v18)); _v7[2] = findIndex1(BYTE2(v18)); _i[3] = findIndex1(BYTE3(v18)); v9 = *(DWORD*)_v9; v8 = *(DWORD*)_v8; v7 = *(DWORD*)_v7; i = *(DWORD*)_i; // v9 = 0x948726e2; // v8 = 0x51f188a1; // v7 = 0x9b05b51d; // i = 0xb9f8810c; for (int j = 0; j &lt; 13; j++) &#123; v11 = i ^ key[key_index--]; v13 = v7 ^ key[key_index--]; v15 = v8 ^ key[key_index--]; v17 = v9 ^ key[key_index--]; brute(v11, &amp;_v9[1], &amp;_v8[2], &amp;_v7[3], &amp;_i[0]); brute(v13, &amp;_i[1], &amp;_v9[2], &amp;_v8[3], &amp;_v7[0]); brute(v15, &amp;_v7[1], &amp;_i[2], &amp;_v9[3], &amp;_v8[0]); brute(v17, &amp;_v8[1], &amp;_v7[2], &amp;_i[3], &amp;_v9[0]); v9 = *(DWORD*)_v9; v8 = *(DWORD*)_v8; v7 = *(DWORD*)_v7; i = *(DWORD*)_i; &#125; flag[0] = i ^ key[key_index--]; flag[1] = v7 ^ key[key_index--]; flag[2] = v8 ^ key[key_index--]; flag[3] = v9 ^ key[key_index--];&#125;int main()&#123; printf(&quot;Start...\\n&quot;); DWORD cmp_data[8] = &#123; 0xE82BA79E, 0x83EA91DE, 0x241BCCFE, 0x2836973B, 0x5F86C92D, 0x0C8094E88, 0x0FEC81BB0, 0x0D5277623 &#125;; //DWORD cmp_data[8] = &#123;0X21266A63, 0XE7FC84AC, 0XEEDD698D, 0XE64535D6, 0X21266A63, 0XE7FC84AC, 0XEEDD698D, 0XE64535D6&#125;; //æ‹¿1234567890123456åšæµ‹è¯• DWORD flag[8] = &#123; 0 &#125;; decrypt(cmp_data, flag); decrypt(&amp;cmp_data[4], &amp;flag[4]); printf(&quot;flag: %s\\n\\n&quot;, (char*)flag); char* tmp = (char*)flag; for (int i = 0; i &lt; 32; i++) &#123; printf(&quot;%X, &quot;, tmp[i]); &#125; return 0;&#125; æœ€ç»ˆè·‘å‡ºæ¥çš„æ•°æ®ä¸º ç¨ä½œå¤„ç† 123456789101112#include &lt;stdio.h&gt;int main()&#123; unsigned int a[] = &#123;0XFFFFFFF2, 0XFFFFFF88, 0X35, 0X49, 0XFFFFFFF8, 0X5C, 0X2A, 0X4, 0XFFFFFFA8, 0X4E, 0XFFFFFF86, 0XFFFFFF9E, 0XFFFFFFBE, 0XFFFFFFF9, 0X2A, 0XE, 0XFFFFFFC6, 0X4, 0XFFFFFF94, 0X56, 0X14, 0XFFFFFF89, 0X4C, 0X4C, 0X2E, 0XFFFFFF9C, 0X17, 0XFFFFFFC4, 0XFFFFFFC2, 0XFFFFFFA7, 0XFFFFFF82, 0X1F&#125;; for (int i = 0; i &lt; 32; i++) &#123; printf(&quot;%X &quot;, a[i] &amp; 0xff); &#125; return 0;&#125;//F2 88 35 49 F8 5C 2A 4 A8 4E 86 9E BE F9 2A E C6 4 94 56 14 89 4C 4C 2E 9C 17 C4 C2 A7 82 1F æ‰¾åˆ°æºç¨‹åºï¼Œè°ƒè¯•èµ·æ¥ï¼Œä¿®æ”¹flagï¼Œè¿›è¡ŒéªŒè¯ ä¿®æ”¹ä¸º è¿è¡Œ å‘ç°ç¨‹åºè¾“å‡ºsuccess æ‰€ä»¥æœ€ç»ˆçš„flagåº”è¯¥æ˜¯ 1flag = b&#x27;flag&#123;\\xF2\\x88\\x35\\x49\\xF8\\x5C\\x2A\\x4\\xA8\\x4E\\x86\\x9E\\xBE\\xF9\\x2A\\xE\\xC6\\x4\\x94\\x56\\x14\\x89\\x4C\\x4C\\x2E\\x9C\\x17\\xC4\\xC2\\xA7\\x82\\x1F&#125;&#x27;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://zzzzsky.github.io/categories/CTF/"}],"tags":[{"name":"CTFWP","slug":"CTFWP","permalink":"https://zzzzsky.github.io/tags/CTFWP/"}]},{"title":"é™‡åŸæˆ˜\"ç–«\"2021ç½‘ç»œå®‰å…¨å¤§èµ›_RE_WP","slug":"é™‡åŸæˆ˜ç–«2021_RE_WP","date":"2021-11-11T02:00:00.000Z","updated":"2021-11-29T11:44:57.427Z","comments":true,"path":"2021/11/11/é™‡åŸæˆ˜ç–«2021_RE_WP/","link":"","permalink":"https://zzzzsky.github.io/2021/11/11/%E9%99%87%E5%8E%9F%E6%88%98%E7%96%AB2021_RE_WP/","excerpt":"","text":"é™‡åŸæˆ˜â€ç–«â€2021ç½‘ç»œå®‰å…¨å¤§èµ›_RE_WPEasyReæ–¹æ³•ä¸€IDAæ‰“å¼€åˆ†æ å‘ç°sub_4111406è¿™ä¸ªå‡½æ•°æ˜¯å¯¹è¾“å…¥çš„flagè¿›è¡ŒåŠ å¯†ï¼Œç„¶åå°†åŠ å¯†åçš„æ•°æ®å­˜æ”¾åˆ°0X41A14Cä¸­ æ¥åˆ°sub_4111406å‡½æ•°ï¼Œå¹¶ä¸èƒ½F5, ç›´æ¥åŠ¨æ€è°ƒè¯•ä¸€ç›´è·Ÿ ã€ å‘ç°ç¨‹åºåœ¨ä¸æ–­çš„ç”Ÿæˆä¸€äº›æ•°æ®ï¼Œé•¿åº¦æ˜¯32 å¤šæ¬¡è°ƒè¯•ï¼Œä¸åŒè¾“å…¥ï¼Œè¿™é‡Œè·å–çš„æ•°æ®æ˜¯ä¸€æ ·çš„ åˆ†æï¼Œè¿˜åŸç®—æ³• 12345678910111213141516171819202122232425262728293031323334#include &lt;stdio.h&gt;#include &lt;windows.h&gt;DWORD * enc(char* flag, char* key)&#123; DWORD* pdw_flag = (DWORD*)flag; DWORD* pdw_key = (DWORD*)key; for (int i = 0; i &lt; 8; i++) &#123; pdw_flag[i] ^= pdw_key[(7 * i + 2) % 8]; &#125; for (int i = 0; i &lt; 8; i++) &#123; pdw_flag[i] ^= pdw_flag[i] &lt;&lt; 7; pdw_flag[i] ^= pdw_key[(7 * i + 3) % 8]; pdw_flag[i] ^= pdw_flag[(5 * i + 3) % 8]; pdw_flag[i] ^= pdw_flag[i] &lt;&lt; 13; pdw_flag[i] ^= pdw_key[(7 * i + 5) % 8]; pdw_flag[i] ^= pdw_flag[i] &lt;&lt; 17; &#125; return pdw_flag;&#125;int main()&#123; char flag[33] = &quot;12345678901234567890123456789012&quot;; char key[32] = &#123; 12, 21, 30, 39, 32, 41, 50, 59, 68, 77, 86, 95, 88, 97, 106, 115, 124, 133, 142, 151, 144, 153, 162, 171, 180, 189, 198, 207, 200, 209, 218, 227&#125;; enc(flag, key); return 0; //åœ¨è¿™é‡Œä¸‹æ–­ç‚¹è§‚å¯ŸåŠ å¯†åçš„æ•°æ®æ˜¯å¦ä¸IDAè°ƒè¯•æ—¶ç”Ÿæˆçš„ä¸€æ ·&#125; åœ¨æœ«å°¾ä¸‹æ–­ç‚¹è°ƒè¯• IDAè°ƒè¯•è¿è¡Œä¸‹æ–­ç‚¹è§‚å¯ŸåŠ å¯†åçš„æ•°æ® å‘ç°æ˜¯ä¸€æ ·çš„ï¼Œè¿˜åŸåŠ å¯†ç®—æ³•æˆåŠŸï¼Œç°åœ¨å¼€å§‹å†™è§£å¯†è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#include &lt;stdio.h&gt;#include &lt;windows.h&gt;VOID dec_shift_xor(DWORD* mingwen, int shiftlen) &#123; //pdw_flag[i] ^= pdw_flag[i] &lt;&lt; 13 ç±»ä¼¼è¿™ç§åŠ å¯†æ–¹å¼ï¼ŒçŸ¥é“åŠ å¯†åçš„ï¼Œè§£å¯†å¾—åˆ°åŸæ¥çš„æ•°æ® //mingwenæŒ‡å‘æ˜æ–‡ //shiftlenæŒ‡å‘ç§»ä½çš„çš„ä½æ•° DWORD data = *mingwen; DWORD mask = 1; for (int i = 0; i &lt; shiftlen - 1; i++) &#123; // æ„é€ mask mask = (mask &lt;&lt; 1) + 1; &#125; DWORD zuidi2wei = data &amp; mask; int count = 32 / shiftlen; count = 32 % shiftlen == 0 ? count : count + 1; for (int i = 0; i &lt; count; i++) &#123; zuidi2wei &lt;&lt;= shiftlen; mask &lt;&lt;= shiftlen; data ^= zuidi2wei; zuidi2wei = data &amp; mask; &#125; *mingwen = data;&#125;DWORD* dec(char* enc_flag, char* key)&#123; DWORD* pdw_flag = (DWORD*)enc_flag; DWORD* pdw_key = (DWORD*)key; for (int i = 7; i &gt;=0; i--) &#123; dec_shift_xor(&amp;pdw_flag[i], 17); pdw_flag[i] ^= pdw_key[(7 * i + 5) % 8]; dec_shift_xor(&amp;pdw_flag[i], 13); pdw_flag[i] ^= pdw_flag[(5 * i + 3) % 8]; pdw_flag[i] ^= pdw_key[(7 * i + 3) % 8]; dec_shift_xor(&amp;pdw_flag[i], 7); &#125; for (int i = 0; i &lt; 8; i++) &#123; pdw_flag[i] ^= pdw_key[(7 * i + 2) % 8]; &#125; return pdw_flag;&#125;int main()&#123; char key[32] = &#123; 12, 21, 30, 39, 32, 41, 50, 59, 68, 77, 86, 95, 88, 97, 106, 115, 124, 133, 142, 151, 144, 153, 162, 171, 180, 189, 198, 207, 200, 209, 218, 227&#125;; char enc_flag[33] = &#123; 0x15, 0x86, 0x0F, 0xF9, 0x3D, 0x7C, 0x82, 0xC8, 0x63, 0x32, 0xD7, 0x1B, 0x54, 0x74, 0x0C, 0xA9, 0x05, 0x4E, 0x3F, 0x7D, 0x19, 0xBC, 0xE4, 0x53, 0x7F, 0x39, 0x5B, 0xA8, 0x5E, 0xA4, 0xB2, 0xD4,0&#125;; //æå–çš„0X41A058å¤„çš„æ•°æ® dec(enc_flag, key); printf(&quot;%s&quot;, enc_flag); return 0;&#125; å¾—åˆ° fc5e038d38a57032085441e7fe7010b0ï¼ŒåŠ ä¸Š flag{} å¾—åˆ° flag&#123;fc5e038d38a57032085441e7fe7010b0&#125; æ–¹æ³•äºŒå»èŠ±æŒ‡ä»¤ 123456789101112131415161718192021222324252627282930313233from ida_bytes import get_bytes, patch_bytesimport readdr = 0x415B53end = 0x0415B79buf = get_bytes(addr, end - addr)buf_str = &quot;&quot;.join([chr(i) for i in list(buf)])pattern = r&quot;\\xE8\\x01\\x00\\x00\\x00.\\x33\\xDB\\x33\\xC0\\x33\\xC9\\x59\\x83\\xC0([\\s\\S])\\xBB([\\s\\S])\\x00\\x00\\x00\\xF7\\xE3\\x83\\xC1\\x20\\x83\\xC0([\\s\\S])\\x33\\xC3\\x51(\\x88\\x45[\\s\\S])\\xC3.&quot;def handler(s): eax = ord(s.group(1)[0]) ebx = ord(s.group(2)[0]) tmp = ord(s.group(3)[0]) c = s.group(4) eax = eax * ebx eax += tmp eax ^= ebx patch_ = &quot;\\xB8&quot; + chr(eax) + &quot;\\x00\\x00\\x00&quot; return patch_ + &#x27;\\x90&#x27;*(0x25-5-5) + c + &quot;\\x90&quot; * 2buf = re.sub(pattern, handler, buf_str, flags=re.I)buf_bytes = bytes([ord(i) for i in buf])patch_bytes(addr, buf_bytes)print(&quot;OK&quot;) Z3æ¨¡å—è§£å†³ 12345678910111213141516171819202122232425262728293031323334from z3 import *if __name__ == &quot;__main__&quot;: enc = [0xF90F8615, 0xC8827C3D, 0x1BD73263, 0x0A90C7454, 0x7D3F4E05, 0x53E4BC19, 0xA85B397F, 0xD4B2A45E] v5 = [0] * 8 flag = [BitVec(f&quot;flag_&#123;i&#125;&quot;, 32) for i in range(8)] s = Solver() v4 = [0x271E150C, 0x3B322920, 0x5F564D44, 0x736A6158, 0x978E857C, 0xABA29990, 0xCFC6BDB4, 0xE3DAD1C8] for i in range(8): v5[i] = flag[i] ^ v4[(7 * i + 2) % 8] for j in range(8): v5[j] ^= v5[j] &lt;&lt; 7 v5[j] ^= v4[(7 * j + 3) % 8] v5[j] ^= v5[(5 * j + 3) % 8] v5[j] ^= v5[j] &lt;&lt; 13 v5[j] ^= v4[(7 * j + 5) % 8] v5[j] ^= v5[j] &lt;&lt; 17 for i in range(8): s.add(v5[i] == enc[i]) assert s.check() == sat m = s.model() flag = [int.to_bytes(m[i].as_long(), 4, byteorder=&quot;little&quot;).decode() for i in flag] print(&quot;&quot;.join(flag)) EasyRe_Revengeæ­¤é¢˜ä¸EasyRe_Revengeä¸€æ ·ï¼Œåªæ˜¯æŠŠå¯†æ–‡æ¢äº†ï¼Œæ›¿æ¢ä¸Šå›¾ä¸­çš„enc_flagå³å¯ 1char enc_flag[33] = &#123; 66, 176, 232, 238, 108, 238, 208, 87, 50, 75, 245, 243, 214, 183, 240, 211, 137, 195, 97, 10, 64, 186, 199, 56, 44, 158, 61, 12, 132, 146, 74, 214,0 &#125;; åæ¥å‘ç°ï¼ŒåŸæ¥EasyReé‚£é“é¢˜ç›®ï¼Œflagç›´æ¥å­˜åœ¨å­—ç¬¦ä¸²ä¸­äº†ï¼Œæ‰€ä»¥æŠŠå¯†æ–‡æ¢äº†ï¼Œæ‰æœ‰äº†è¿™ä¸ªEasyRe_Revenge findmeIDAæ‰“å¼€åˆ†æ æ¥åˆ° 403844 è¿™ä¸ªä½ç½® å¾ˆæ˜¾ç„¶è¿™ä¸ªä½ç½®ä¸å¯èƒ½æ˜¯strcmpï¼Œè§‚å¯Ÿå‘ç°404840é‚£ä¸ªåœ°å€å¤„è¿˜å­˜äº†ä¸ªå‡½æ•°çš„åœ°å€ sub_401866ï¼Œä¼°è®¡ç¨‹åºæœ‰åœ°æ–¹æŠŠ403844è¿™ä¸ªåœ°æ–¹çš„åœ°å€ç»™æ›¿æ¢æ‰äº† æ¥åˆ°401866ä½ç½® åˆ†æ401767å‡½æ•°ï¼Œå‘ç°æ˜¯æ˜æ˜¾çš„RC4åŠ å¯† éšä¾¿è¾“å…¥ä¸€ä¸ªå‡çš„flagï¼Œ12345678901234567890123456ï¼Œ ç„¶åæ–­ä¸‹ï¼Œçœ‹åŠ å¯†åçš„æ•°æ® å†™è„šæœ¬å¾—åˆ°å¯†é’¥æµ 12345678fake_flag = &quot;12345678901234567890123456&quot;enc_fake_flag = [ 0xD5, 0x25, 0xE2, 0xB6, 0xF1, 0x99, 0x4B, 0xD4, 0xB5, 0x1B, 0x81, 0xD0, 0x47, 0x8F, 0xEF, 0x35, 0x05, 0x46, 0x48, 0xEB, 0x8C, 0x21, 0x6C, 0xB8, 0x05, 0x8D]key = [ord(fake_flag[i]) ^ enc_fake_flag[i] for i in range(26)]print(key)# [228, 23, 209, 130, 196, 175, 124, 236, 140, 43, 176, 226, 116, 187, 218, 3, 50, 126, 113, 219, 189, 19, 95, 140, 48, 187] ç„¶åæå–å‡ºdword_403040è§£å¯†å³å¯ 12345enc = [0xFFFFFFB7, 0x52, 0x0FFFFFF85, 0x0FFFFFFC1, 0x0FFFFFF90, 0x0FFFFFFE9, 0x7, 0xFFFFFFB8, 0x0FFFFFFE4, 0x1A, 0x0FFFFFFC3, 0x0FFFFFFBD, 0x1D, 0x0FFFFFF8E, 0x0FFFFFF85, 0x46, 0x0, 0x21, 0x44, 0x0FFFFFFAF, 0x0FFFFFFEF, 0x70, 0x32, 0x0FFFFFFB5, 0x11, 0x0FFFFFFC6]key = [228, 23, 209, 130, 196, 175, 124, 236, 140, 43, 176, 226, 116, 187, 218, 3, 50, 126, 113, 219, 189, 19, 95, 140, 48, 187]flag = [chr((enc[i] &amp; 0XFF) ^ key[i]) for i in range(26)]print(&quot;&quot;.join(flag))# SETCTF&#123;Th1s_i5_E2_5tRcm9!&#125; poweræ‹¿åˆ°é¢˜ç›®ï¼Œé™„ä»¶æ˜¯ARMæ±‡ç¼–æºæ–‡ä»¶ ç›´æ¥ç”¨arm-none-eabi-as.exe powerç¼–è¯‘ä¸‹ç”Ÿæˆa.out IDAæ‰“å¼€ å‘ç°æ˜¯AESåŠ å¯†ï¼Œè¿™é‡Œå†™çš„æ˜¯CBCæ¨¡å¼ï¼Œä½†å…¶å®æ˜¯ECBæ¨¡å¼ï¼Œå†™è„šæœ¬è§£å¯†å³å¯ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647from Crypto.Cipher import AESimport base64import binasciiclass Aescrypt(): def __init__(self, key, model, iv): self.key = self.add_16(key) self.model = model self.iv = iv def add_16(self, par): if type(par) == str: par = par.encode() while len(par) % 16 != 0: par += b&#x27;\\x00&#x27; return par def aesencrypt(self, text): text = self.add_16(text) if self.model == AES.MODE_CBC: self.aes = AES.new(self.key, self.model, self.iv) elif self.model == AES.MODE_ECB: self.aes = AES.new(self.key, self.model) self.encrypt_text = self.aes.encrypt(text) return self.encrypt_text def aesdecrypt(self, text): if self.model == AES.MODE_CBC: self.aes = AES.new(self.key, self.model, self.iv) elif self.model == AES.MODE_ECB: self.aes = AES.new(self.key, self.model) self.decrypt_text = self.aes.decrypt(text) self.decrypt_text = self.decrypt_text.strip(b&quot;\\x00&quot;) return self.decrypt_textif __name__ == &#x27;__main__&#x27;: passwd = b&quot;this_is_a_key!!!&quot; enc_flag_str = &quot;1030a9254d44937bed312da03d2db9adbec5762c2eca7b5853e489d2a140427b&quot; enc_flag = binascii.unhexlify(enc_flag_str) aescryptor = Aescrypt(passwd, AES.MODE_ECB, None) # ECB text = aescryptor.aesdecrypt(enc_flag) print(&quot;æ˜æ–‡:&quot;, text) # æ˜æ–‡: b&#x27;flag&#123;y0u_found_the_aes_12113112&#125;&#x27; Eat_somethingæ ¸å¿ƒä»£ç åœ¨Eat_something.wasmä¸­ æ‰¾åˆ°å·¥å…·å°†wasmè½¬ä¸º.oæ–‡ä»¶ https://www.52pojie.cn/thread-1438499-1-1.html ç”¨IDAæ‰“å¼€ï¼Œæ‰¾åˆ°w2c_checkrightå‡½æ•°ï¼Œè¿™æ˜¯éªŒè¯flagçš„åœ°æ–¹ æ ¸å¿ƒç®—æ³•å°±æ˜¯è¿™ä¸€å¥ v13 != (i32_load(w2c_memory, v16 + 12LL) ^ (2 * v10)) ç¿»è¯‘ä¸‹å°±æ˜¯enc[i] != i ^ (flag[i] * 2) å°†encæå–å‡ºæ¥ï¼Œå†™è„šæœ¬å³å¯ 123456789101112enc = [0x86, 0x8B, 0xAA, 0x85, 0xAC, 0x89, 0xF0, 0xAF, 0xD8, 0x69, 0xD6, 0xDD, 0xB2, 0xBF, 0x6E, 0xE5, 0xAE, 0x99, 0xCC, 0xD5, 0xBC, 0x8B, 0xF2, 0x7D, 0x7A, 0xE3, 0x59, 0x6F, 0x75, 0x20, 0x61, 0x72, 0x65, 0x20, 0x72, 0x69, 0x67, 0x68, 0x74, 0x21, 0x00, 0x59, 0x6F, 0x75, 0x20, 0x61, 0x72, 0x65, 0x20, 0x77, 0x72, 0x6F, 0x6E, 0x67, 0x21, 0x00] flag = []for i in range(26): flag .append(chr((i ^ enc[i]) // 2))print(&quot;&quot;.join(flag))# CETCTF&#123;Th0nk_Y0u_DocTOr51&#125; æœ€åå°†CETCTF æ”¹ä¸º SETCTFå³ä¸ºflag","categories":[{"name":"CTF","slug":"CTF","permalink":"https://zzzzsky.github.io/categories/CTF/"}],"tags":[{"name":"CTFWP","slug":"CTFWP","permalink":"https://zzzzsky.github.io/tags/CTFWP/"}]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"https://zzzzsky.github.io/categories/CTF/"},{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://zzzzsky.github.io/categories/%E5%B7%A5%E5%85%B7/"},{"name":"å®‰å“","slug":"å®‰å“","permalink":"https://zzzzsky.github.io/categories/%E5%AE%89%E5%8D%93/"},{"name":"python","slug":"python","permalink":"https://zzzzsky.github.io/categories/python/"}],"tags":[{"name":"vm","slug":"vm","permalink":"https://zzzzsky.github.io/tags/vm/"},{"name":"å›¾","slug":"å›¾","permalink":"https://zzzzsky.github.io/tags/%E5%9B%BE/"},{"name":"æœ€çŸ­è·¯å¾„","slug":"æœ€çŸ­è·¯å¾„","permalink":"https://zzzzsky.github.io/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/"},{"name":"IDAPython","slug":"IDAPython","permalink":"https://zzzzsky.github.io/tags/IDAPython/"},{"name":"IDA","slug":"IDA","permalink":"https://zzzzsky.github.io/tags/IDA/"},{"name":"debug","slug":"debug","permalink":"https://zzzzsky.github.io/tags/debug/"},{"name":"struct","slug":"struct","permalink":"https://zzzzsky.github.io/tags/struct/"},{"name":"CTFWP","slug":"CTFWP","permalink":"https://zzzzsky.github.io/tags/CTFWP/"},{"name":"z3","slug":"z3","permalink":"https://zzzzsky.github.io/tags/z3/"},{"name":"ollvm","slug":"ollvm","permalink":"https://zzzzsky.github.io/tags/ollvm/"},{"name":"çœŸæœºè°ƒè¯•","slug":"çœŸæœºè°ƒè¯•","permalink":"https://zzzzsky.github.io/tags/%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95/"},{"name":"å®‰å“","slug":"å®‰å“","permalink":"https://zzzzsky.github.io/tags/%E5%AE%89%E5%8D%93/"}]}